{"config":{"lang":["ja"],"separator":"[\\s\\-\uff0c\u3002]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"About","text":""},{"location":"#_1","title":"\u7b80\u4ecb","text":"<p>\u8fd9\u662f\u6211\u7684Wiki\u9875\u9762\uff0c\u4e3b\u8981\u7528\u6765\u8bb0\u5f55\u4e00\u4e9b\u7b14\u8bb0\u548c\u5b58\u6863\u3002</p> <p>\u90e8\u5206\u7b14\u8bb0\u8f83\u4e3a\u51cc\u4e71\uff0c\u56e0\u6b64\u672a\u5c06\u5168\u90e8\u7b14\u8bb0\u8fdb\u884c\u5c55\u793a\uff0c\u53ef\u4ee5\u4ecegithub\u67e5\u770b\u5b8c\u6574\u5185\u5bb9\u3002</p>"},{"location":"#_2","title":"\u8054\u7cfb\u65b9\u5f0f","text":"<p>ieiao@outlook.com</p>"},{"location":"blog-archive/","title":"Blog Archive","text":"<p>Note</p> <p>\u4fdd\u5b58\u770b\u5230\u8fc7\u7684\u4e00\u4e9b\u6709\u8da3\u7684\u535a\u5ba2/\u9879\u76ee\u539f\u6587\u94fe\u63a5\u53ca\u76f8\u5173\u5b58\u6863\uff0c\u4ec5\u4f5c\u5907\u4efd\u7528\u9014\u3002</p> <ul> <li>SimpleNFC \u4f7f\u7528\u5206\u7acb\u539f\u4ef6\u642d\u5efa\u8c03\u5236\u89e3\u8c03\u7535\u8def\u5b9e\u73b0\u4e86NFC\u6807\u7b7e\u7684\u6a21\u62df</li> <li>breaking secure boot \u5c55\u793a\u4e86\u4e00\u4e9b\u5b89\u5168\u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u6f0f\u6d1e\u6d4b\u8bd5\u53ca\u5229\u7528\u65b9\u6cd5</li> </ul>"},{"location":"blog-archive/SimpleNFC/","title":"SimpleNFC","text":"<p>SimpleNFC\u4f7f\u7528\u5206\u7acb\u539f\u4ef6\u642d\u5efa\u8c03\u5236\u89e3\u8c03\u7535\u8def\u5b9e\u73b0\u4e86NFC\u6807\u7b7e\u7684\u6a21\u62df\uff0c\u8fd9\u91cc\u5bf9\u535a\u5ba2\u5185\u5bb9\u8fdb\u884c\u4e86\u5b58\u6863\u3002</p> <p>\u539f\u6587\u5730\u5740</p> <p>PDF\u7248\u672c</p> <p>\u4ee3\u7801\u5b58\u6863</p> <p>\u76f8\u5173\u9605\u8bfb\u4e2dNiall Quirke\u7684\u8bba\u6587</p>"},{"location":"blog-archive/breaking-secure-boot-on-google-nest-hub/","title":"Breaking Secure Boot on Google Nest Hub (2nd Gen) to run Ubuntu","text":"<p>\u5c55\u793a\u4e86\u4e00\u4e9b\u5b89\u5168\u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u6f0f\u6d1e\u6d4b\u8bd5\u53ca\u5229\u7528\u65b9\u6cd5\u3002</p> <p>\u539f\u6587\u5730\u5740</p> <p>\u7f51\u9875\u7248\u672c</p>"},{"location":"code/languages/c/","title":"C/C++","text":""},{"location":"code/languages/c/#1-cc","title":"1. C/C++\u7684\u76f8\u4e92\u8c03\u7528","text":""},{"location":"code/languages/c/#11-ccg","title":"1.1 C++\u8c03\u7528C\uff08\u4f7f\u7528g++\u8fdb\u884c\u7f16\u8bd1\u65f6\u5019\u7684\u5904\u7406\uff09","text":"<p>\u5f53\u7edf\u4e00\u4f7f\u7528g++\u8fdb\u884c\u7f16\u8bd1\u7684\u65f6\u5019\uff0c\u5bf9\u4e8e.c\u6587\u4ef6\u6240\u5bf9\u5e94\u7684.h\u6587\u4ef6\u91cc\u9762\u7684\u51fd\u6570\u58f0\u660e\uff0c\u5e94\u8be5\u4f7f\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u5feb\u8fdb\u884c\u5305\u88f9\u4ee5\u8868\u660e\u8be5\u51fd\u6570\u4e3aC\u8bed\u8a00\u51fd\u6570\u3002</p> <pre><code>#if defined(__cplusplus)\nextern \"C\" {\n#endif\n/* \u51fd\u6570\u58f0\u660e */\n#if defined(__cplusplus)\n}\n#endif\n</code></pre>"},{"location":"code/languages/c/#12-cc","title":"1.2 C\u8c03\u7528C++","text":"<p>C\u65e0\u6cd5\u76f4\u63a5\u8c03\u7528C++\u51fd\u6570\uff0c\u5fc5\u987b\u6dfb\u52a0\u4e00\u5c42wrapper\uff0c\u5728\u8be5wrapper\u4e2d\u5bf9\u6211\u4eec\u9700\u8981\u7684\u529f\u80fd\u8fdb\u884c\u7b80\u5355\u5c01\u88c5\uff0c\u6700\u540e\u518d\u4ee5C\u7684\u5f62\u5f0f\u8fdb\u884c\u58f0\u660e\uff0c\u5373\u53ef\u5b9e\u73b0C\u8c03\u7528C++\u3002</p> <pre><code>/* apds9960_wrapper.h */\n#ifndef APP_APDS9960_WRAPPER_H_\n#define APP_APDS9960_WRAPPER_H_\n\n#include &lt;stdio.h&gt;\n\n#if defined(__cplusplus)\nextern \"C\" {\n#endif\n\nbool apds9960_init(void);\nvoid apds9960_startGesture(void);\nuint8_t apds9960_read(void);\n\n#if defined(__cplusplus)\n}\n#endif\n\n#endif /* APP_APDS9960_WRAPPER_H_ */\n</code></pre> <pre><code>/* apds9960_wrapper.cpp */\n#include \"apds9960_wrapper.h\"\n#include \"Adafruit_APDS9960.h\"\n\nAdafruit_APDS9960 apds;\n\nbool apds9960_init(void)\n{\nreturn apds.begin();\n}\n\nvoid apds9960_startGesture(void)\n{\napds.enableProximity(true);\napds.enableGesture(true);\n}\n\nuint8_t apds9960_read(void)\n{\nreturn apds.readGesture();\n}\n</code></pre>"},{"location":"code/languages/markdown/","title":"Markdown","text":"<ul> <li>Markdown\u9875\u5185\u8df3\u8f6c</li> </ul> <pre><code>&lt;a id=\"jump\"&gt;&lt;/a&gt;\n[\u8df3\u8f6c](#jump)\n</code></pre>"},{"location":"code/snippets/CMakeLists/","title":"CMakeLists","text":""},{"location":"code/snippets/CMakeLists/#_1","title":"\u6a21\u677f","text":"<pre><code># CMake template file\n# Use this file with\n# mkdir build\n# cd build\n# cmake .. &amp;&amp; make ..\n# make -C build\n\ncmake_minimum_required(VERSION 3.15.3)\n\n# Optional: print out extra messages to see what is going on. Comment it to have less verbose messages\nset(CMAKE_VERBOSE_MAKEFILE ON)\n\n# Path to toolchain file. This one has to be before 'project()' below\nSET(CROSS_COMPILE \"/path-to-toolchain/bin/arm-none-eabi-\")\nSET(CMAKE_C_COMPILER ${CROSS_COMPILE}gcc)\nSET(CMAKE_CXX_COMPILER ${CROSS_COMPILE}g++)\n\n# Setup project, output and linker file\nproject(make_template)\nset(EXECUTABLE ${PROJECT_NAME}.elf)\nset(LINKER_FILE ${CMAKE_SOURCE_DIR}/link.ld)\n\nenable_language(C ASM)\nset(CMAKE_C_STANDARD 99)\nset(CMAKE_C_STANDARD_REQUIRED ON)\nset(CMAKE_C_EXTENSIONS OFF)\nset(CMAKE_EXPORT_COMPILE_COMMANDS ON)\n\n# List of source files\nset(SRC_FILES\nmain.c\n)\n\n# Build the executable based on the source files\nadd_executable(${EXECUTABLE} ${SRC_FILES})\n\n# List of compiler defines, prefix with -D compiler option\ntarget_compile_definitions(${EXECUTABLE} PRIVATE\n-DDEBUG\n)\n\n# List of includ directories\ntarget_include_directories(${EXECUTABLE} PRIVATE\n. driver\n)\n\n# Compiler options\ntarget_compile_options(${EXECUTABLE} PRIVATE\n-fdata-sections\n-ffunction-sections\n\n-Wall\n-O2\n)\n\n# Linker options\ntarget_link_options(${EXECUTABLE} PRIVATE\n-T${LINKER_FILE}\n-lm\n-Wl,-Map=${PROJECT_NAME}.map,--cref\n-Wl,--gc-sections\n-Xlinker -print-memory-usage -Xlinker\n)\n\n# Linker libraries\n#target_link_libraries(${EXECUTABLE} PRIVATE\n#    m\n#    )\n\n# Optional: Print executable size as part of the post build process\nadd_custom_command(TARGET ${EXECUTABLE}\nPOST_BUILD\nCOMMAND ${CMAKE_SIZE_UTIL} ${EXECUTABLE_OUTPUT_PATH}/${EXECUTABLE})\n\n# Optional: Create hex, bin and S-Record files after the build\nadd_custom_command(TARGET ${EXECUTABLE}\nPOST_BUILD\nCOMMAND ${CMAKE_OBJCOPY} -O srec --srec-len=64 \"${EXECUTABLE_OUTPUT_PATH}/${EXECUTABLE}\" \"${EXECUTABLE_OUTPUT_PATH}/${PROJECT_NAME}.s19\"\nCOMMAND ${CMAKE_OBJCOPY} -O ihex \"${EXECUTABLE_OUTPUT_PATH}/${EXECUTABLE}\" \"${EXECUTABLE_OUTPUT_PATH}/${PROJECT_NAME}.hex\"\nCOMMAND ${CMAKE_OBJCOPY} -O binary \"${EXECUTABLE_OUTPUT_PATH}/${EXECUTABLE}\" \"${EXECUTABLE_OUTPUT_PATH}/${PROJECT_NAME}.bin\" )\n\n# Optional: flash device\nadd_custom_target(flash\nCOMMAND openocd/pyocd commands\nDEPENDS ${EXECUTABLE}\n)\n</code></pre>"},{"location":"code/snippets/binary_search/","title":"\u4e8c\u5206\u67e5\u627e","text":"<pre><code>int binarySearch(int[] nums, int target) {\nint left = 0;\nint right = nums.length - 1;\n\nwhile(left &lt;= right) {\nint mid = left + (right - left) / 2;\nif(nums[mid] == target)\nreturn mid;\nelse if (nums[mid] &lt; target)\nleft = mid + 1;\nelse if (nums[mid] &gt; target)\nright = mid - 1;\n}\nreturn -1;\n}\n</code></pre>"},{"location":"code/snippets/utf8c/","title":"UTF-8\u8f6cUnicode","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic const char head_mask[] = {0xff, 0x7f, 0x1f, 0x0f, 0x07, 0x03, 0x01};\nstatic const char shift_tab[] = {0, 6, 12, 18, 24, 30};\n\nint32_t utf8_cov_unicode(const char *stream)\n{\nchar head = *stream;\nchar unicode_buf[4] = {0};\nint32_t *unicode = (int32_t *)unicode_buf;\nint length = 0;\n\nif (!(head&amp;0x80))\nlength = 1;\nelse {\nwhile(head&amp;0x80) {\nlength++;\nhead &lt;&lt;= 1;\n}\n}\n\nif (length == 1)\nunicode_buf[0] = head;\nelse {\nstream += (length - 1);\nswitch(length) {\ncase 6:\n*unicode |= (int32_t)((*stream--)&amp;0x3f);\ncase 5:\n*unicode |= (int32_t)((*stream--)&amp;0x3f) &lt;&lt; shift_tab[length-5];\ncase 4:\n*unicode |= (int32_t)((*stream--)&amp;0x3f) &lt;&lt; shift_tab[length-4];\ncase 3:\n*unicode |= (int32_t)((*stream--)&amp;0x3f) &lt;&lt; shift_tab[length-3];\ncase 2:\n*unicode |= (int32_t)((*stream--)&amp;0x3f) &lt;&lt; shift_tab[length-2];\n*unicode |= (int32_t)(*stream&amp;head_mask[length-1]) &lt;&lt; shift_tab[length-1];\nbreak;\ndefault:\n*unicode = -1;\n}\n}\n\nreturn *unicode;\n}\n\nint main(int argc, char *argv[])\n{\nprintf(\"%x\\n\", utf8_cov_unicode(argv[1]));\nreturn 0;\n}\n</code></pre>"},{"location":"embedded-dev/hardware/","title":"\u786c\u4ef6\u76f8\u5173","text":"<p>\u8bb0\u5f55\u4e86\u4e00\u4e9b\u7f51\u4e0a\u770b\u5230\u7684\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u786c\u4ef6\u76f8\u5173\u5185\u5bb9</p>"},{"location":"embedded-dev/hardware/#dc-dc","title":"DC-DC","text":"<ul> <li>TI/TPS61220 5.5uA\u9759\u6001\u7535\u6d41 \u4ef7\u683c\u6bd4\u8f83\u8d35\uff0c\u96f6\u552e10RMB</li> <li>\u5357\u4eac\u5fae\u76df/ME2188 7uA\u9759\u6001\u7535\u6d41 \u96f6\u552e0.5RMB\u5de6\u53f3</li> <li>MP2359 \u5185\u7f6e\u529f\u7387MOSFET\u7684\u5355\u7247\u964d\u538b\u5f00\u5173\u8f6c\u6362\u5668\u3002\u5728\u5bbd\u8f93\u5165\u8303\u56f4\u5185\uff0c\u53ef\u63d0\u4f9b 1.2A \u7684\u5cf0\u503c\u8f93\u51fa\u7535\u6d41</li> <li>TPS63060 2.5V \u81f3 12V \u8f93\u5165\u7535\u538b\u3001\u6548\u7387\u4e3a 93% \u7684 2.25A \u5f00\u5173\u9650\u6d41\u964d\u538b/\u5347\u538b\u8f6c\u6362\u5668</li> </ul>"},{"location":"embedded-dev/hardware/#ldo","title":"LDO","text":"<ul> <li>XC6206</li> <li>ME6216</li> <li>ME6210A33</li> </ul>"},{"location":"embedded-dev/hardware/#dac","title":"DAC","text":"<ul> <li>PT8211 \u5ec9\u4ef716bit\u97f3\u9891DAC</li> </ul>"},{"location":"embedded-dev/hardware/#pa","title":"PA","text":"<ul> <li>8002 \u5355\u901a\u9053\u6865\u5f0f\u8fde\u63a5\u97f3\u9891\u529f\u7387\u653e\u5927\u5668</li> </ul>"},{"location":"embedded-dev/hardware/#phy","title":"PHY","text":"<ul> <li>LAN8720 10/100 Base-T/TX Ethernet Transceiver with RMII Interface</li> </ul>"},{"location":"embedded-dev/hardware/#_2","title":"\u9502\u7535\u6c60\u5145\u7535","text":"<p>TC4056A</p>"},{"location":"embedded-dev/openwrt/","title":"OpenWrt","text":""},{"location":"embedded-dev/openwrt/#1","title":"1. \u514b\u9686","text":"<p>OpenWrt git\u4ed3\u5e93\u5730\u5740<code>git://git.openwrt.org/openwrt/openwrt.git</code></p> <p>\u53ef\u4ee5\u4f7f\u7528\u955c\u50cf\u7ad9\u70b9\u52a0\u5feb\u514b\u9686\uff0c\u4f8b\u5982<code>https://gitee.com/harvey520</code></p>"},{"location":"embedded-dev/openwrt/#2","title":"2. \u914d\u7f6e\u53ca\u7f16\u8bd1","text":""},{"location":"embedded-dev/openwrt/#21","title":"2.1 \u5feb\u901f\u6784\u5efa","text":"<pre><code># \u66f4\u65b0\u8f6f\u4ef6\u5305\uff0c\u56fd\u5185\u7f51\u7edc\u73af\u5883\u4e0b\u8f7d\u53ef\u80fd\u4f1a\u6bd4\u8f83\u6162\uff0c\u53ef\u4ee5\u4f7f\u7528\u955c\u50cf\u7ad9\u70b9\u4e0b\u8f7d\uff0c\u5982\u4e0b\n# \u4fee\u6539 openwrt \u6e90\u7801\u76ee\u5f55\u7684 feeds.conf.default \u6587\u4ef6\u4e2d\u7684\u955c\u50cf\u6e90\n# \u5c06 https://git.openwrt.org/feed/packages.git \u6539\u4e3a https://gitee.com/harvey520/packages.git\n# \u5c06 https://git.openwrt.org/project/luci.git \u6539\u4e3a https://gitee.com/harvey520/luci.git\n# \u5c06 https://git.openwrt.org/feed/routing.git \u6539\u4e3a https://gitee.com/harvey520/routing.git\n# \u5c06 https://git.openwrt.org/feed/telephony.git \u6539\u4e3a https://gitee.com/harvey520/telephony.git\n./scripts/feeds update -a\n./scripts/feeds install -a\n\n# This opens the OpenWrt configuration menu for setting target and options.\n# \u914d\u7f6e\u76ee\u6807\u677f\u5361\nmake menuconfig\n</code></pre>"},{"location":"embedded-dev/openwrt/#22","title":"2.2 \u5176\u4ed6\u9009\u9879","text":"<pre><code># \u6253\u5f00kernel\u914d\u7f6e\u754c\u9762\nmake kernel_menuconfig\n</code></pre>"},{"location":"embedded-dev/openwrt/#3","title":"3. \u5b9a\u5236","text":""},{"location":"embedded-dev/openwrt/#31","title":"3.1 \u6dfb\u52a0\u81ea\u5b9a\u4e49\u6587\u4ef6","text":"<p>You can include custom files in your image by placing them in /files, e.g. if you want to have my_config included in your image in the directory /etc/config/ \u21d2 /files/etc/config/my_config. If the files directory doesn't exist on your buildsystem, then create it."},{"location":"embedded-dev/openwrt/#32-dts","title":"3.2 \u4fee\u6539dts","text":"<p>\u8bbe\u5907\u6811\u8def\u5f84\u662f<code>target/linux/xxx/dts</code>\uff0c\u4f8b\u5982rt5350f\u7684\u8bbe\u5907\u6811\u662f<code>target/linux/ramips/dts/rt5350.dtsi</code>\u53ca\u76f8\u5173\u677f\u5361\u6587\u4ef6\u3002</p>"},{"location":"embedded-dev/openwrt/#33","title":"3.3 \u5185\u6838\u6e90\u7801","text":"<p>\u5185\u6838\u6e90\u7801\u8def\u5f84\u5e94\u8be5\u662f<code>build_dir/target-xxx/linux-xxx/linux-x.x.xx</code>\uff0c\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\u662f<code>target/linux/target-name/xxx/config</code>\uff0c\u4f8b\u5982rt5350f\u7684\u914d\u7f6e\u6587\u4ef6\u662f<code>target/linux/ramips/rt305x/config-4.14</code>\u3002</p>"},{"location":"embedded-dev/openwrt/#34-udhcpc","title":"3.4 udhcpc","text":"<p>/usr/share/udhcpc/default.script /etc/udhcpc.user</p> <pre><code>root@OpenWrt:/tmp/run# udhcpc --help\nBusyBox v1.31.1 () multi-call binary.\n\nUsage: udhcpc [-fbqRB] [-t N] [-T SEC] [-A SEC/-n]\n[-i IFACE] [-s PROG] [-p PIDFILE]\n[-oC] [-r IP] [-V VENDOR] [-F NAME] [-x OPT:VAL]... [-O OPT]...\n\n        -i IFACE        Interface to use (default eth0)\n-s PROG         Run PROG at DHCP events (default /usr/share/udhcpc/default.script)\n-p FILE         Create pidfile\n        -B              Request broadcast replies\n        -t N            Send up to N discover packets (default 3)\n-T SEC          Pause between packets (default 3)\n-A SEC          Wait if lease is not obtained (default 20)\n-b              Background if lease is not obtained\n        -n              Exit if lease is not obtained\n        -q              Exit after obtaining lease\n        -R              Release IP on exit\n-f              Run in foreground\n        -S              Log to syslog too\n        -r IP           Request this IP address\n        -o              Don't request any options (unless -O is given)\n        -O OPT          Request option OPT from server (cumulative)\n        -x OPT:VAL      Include option OPT in sent packets (cumulative)\n                        Examples of string, numeric, and hex byte opts:\n                        -x hostname:bbox - option 12\n                        -x lease:3600 - option 51 (lease time)\n                        -x 0x3d:0100BEEFC0FFEE - option 61 (client id)\n                        -x 14:'\"dumpfile\"' - option 14 (shell-quoted)\n        -F NAME         Ask server to update DNS mapping for NAME\n        -V VENDOR       Vendor identifier (default 'udhcp VERSION')\n        -C              Don't send MAC as client identifier\nSignals:\n        USR1    Renew lease\n        USR2    Release lease\n</code></pre>"},{"location":"embedded-dev/rotary-encoder/","title":"\u65cb\u8f6c\u7f16\u7801\u5668","text":""},{"location":"embedded-dev/rotary-encoder/#ec11","title":"EC11","text":"<p>\u6ce8\uff1a\u4ee5\u4e0b\u5185\u5bb9\u5747\u4e3a\u5206\u6790\u4ee3\u7801\u5f97\u51fa\uff0c\u672a\u7ecf\u5b9e\u9645\u9a8c\u8bc1\u3002</p> <p>Linux\u5185\u6838\u9a71\u52a8\u4e2d\u65cb\u8f6c\u7f16\u7801\u5668\u7684\u72b6\u6001\u68c0\u6d4b\u903b\u8f91\u5982\u4e0b\u6240\u793a</p> <pre><code>rotary-encoder,encoding = \"gray\"\n\nBIT:  1  0\nPIN:  B  A\n\nCW/clockwise/\u987a\u65f6\u9488\n\nA ````````````````````|__________________|````````````\n\nB ```````````|_________________|``````````````````````\n\n\nraw(gray)   01       00        10        11\n\nGPIO_ACTIVE_LOW\nlogic(gray) 10       11        01        00\n\nnormal      11       10        01        00\nstate               armed     (2-1)    report\n\n\nCCW/counter-clockwise/\u9006\u65f6\u9488\n\nA ```````````|_________________|``````````````````````\n\nB ````````````````````|__________________|````````````\n\n\nraw(gray)   10        00       01        11\n\nGPIO_ACTIVE_LOW\nlogic(gray) 01        11       10        00\n\nnormal      01        10       11        00\nstate                armed    (2-3)     report\n</code></pre> <p>\u5185\u6838\u9a71\u52a8\u4e2d\u5c06\u8bfb\u53d6\u5230\u7684\u65cb\u8f6c\u7f16\u7801\u5668\u7f16\u7801\u503c\u7531\u683c\u96f7\u7801\u8f6c\u6362\u4e3a\u666e\u901a\u4e8c\u8fdb\u5236\u6570\u503c\uff0c\u5229\u7528\u8be5\u6570\u503c\u5b9e\u73b0\u4e86\u72b6\u6001\u673a\u5e76\u8fdb\u884c\u4e86\u4e8b\u4ef6\u4e0a\u62a5\u3002</p> <p>\u5185\u6838\u4e2d\u8bfb\u53d6\u7f16\u7801\u5668\u6570\u503c\u5e76\u8fdb\u884c\u8f6c\u6362\u7684\u4ee3\u7801\u5982\u4e0b</p> <pre><code>static unsigned int rotary_encoder_get_state(struct rotary_encoder *encoder)\n{\nint i;\nunsigned int ret = 0;\n\nfor (i = 0; i &lt; encoder-&gt;gpios-&gt;ndescs; ++i) {\nint val = gpiod_get_value_cansleep(encoder-&gt;gpios-&gt;desc[i]);\n\n/* convert from gray encoding to normal */\nif (encoder-&gt;encoding == ROTENC_GRAY &amp;&amp; ret &amp; 1)\nval = !val;\n\nret = ret &lt;&lt; 1 | val;\n}\n\nreturn ret &amp; 3;\n}\n</code></pre> <p>\u5176\u4e2d\uff0c\u5c06\u683c\u96f7\u7801\u8f6c\u6362\u4e3a\u666e\u901a\u6570\u503c\u65f6\u4f7f\u7528\u4e86\u4e00\u4e2a\u7b80\u5355\u7684<code>!</code>\u903b\u8f91\uff0c\u5176\u539f\u7406\u662f\u56e0\u4e3a\u65cb\u8f6c\u7f16\u7801\u5668\u6570\u503c\u53ea\u6709\u4e24\u4f4d\uff0c\u5f53\u6211\u4eec\u5c06\u4e24\u4f4d\u7684\u666e\u901a\u6570\u503c\u4e0e\u683c\u96f7\u7801\u904d\u5386\u5199\u51fa\u65f6\u4f1a\u5f97\u5230\u5982\u4e0b\u5185\u5bb9\uff1a</p> normal gray 00 00 01 01 10 11 11 10 <p>\u4e0d\u96be\u770b\u51fa\uff0c\u5f53\u9ad8\u4f4d\u4e3a1\u65f6\u4f4e\u4f4d\u7684\u72b6\u6001\u6b63\u597d\u662f\u76f8\u53cd\u7684\uff0c\u56e0\u6b64\u5f53\u9ad8\u4f4d\u4e3a1\u65f6\u628a\u4f4e\u4f4d\u53d6\u53cd\u4fbf\u53ef\u4ee5\u5c06\u7f16\u7801\u5668\u6570\u503c\u7531\u683c\u96f7\u7801\u8f6c\u6362\u4e3a\u666e\u901a\u6570\u503c\u4e86\u3002</p>"},{"location":"embedded-dev/MCU/arm/","title":"ARM","text":""},{"location":"embedded-dev/MCU/arm/#1-_exit","title":"1. _exit\u95ee\u9898","text":"<p>\u94fe\u63a5\u65f6\u62a5\u9519\uff0c\u4fe1\u606f\u5982\u4e0b</p> <pre><code>gcc-arm-none-eabi-8-2019-q3-update/bin/../lib/gcc/arm-none-eabi/8.3.1/../../../../arm-none-eabi/lib/thumb/v7e-m+fp/hard/libc.a(lib_a-exit.o): in function `exit':\nexit.c:(.text.exit+0x16): undefined reference to `_exit'\ncollect2: error: ld returned 1 exit status\n</code></pre> <p>\u9020\u6210\u4e0a\u8ff0\u95ee\u9898\u7684\u539f\u56e0\u662f\u94fe\u63a5\u65f6\u672a\u6307\u5b9a<code>--specs=nosys.specs</code>\uff0c\u589e\u52a0\u8be5\u53c2\u6570\u5373\u53ef\u89e3\u51b3\u6b64\u95ee\u9898.</p> <p>\u6b64\u5916\uff0c\u5982\u679c\u9700\u8981semihosting\uff0c\u94fe\u63a5\u5982\u4e0b\uff1a</p> <pre><code>$ arm-none-eabi-gcc --specs=rdimon.specs $(OTHER_LINK_OPTIONS)\n</code></pre> <p>\u5982\u679c\u4f7f\u7528retarget\uff08\u91cd\u5b9a\u5411\uff09\uff0c\u94fe\u63a5\u5982\u4e0b\uff1a</p> <pre><code>$ arm-none-eabi-gcc --specs=nosys.specs $(OTHER_LINK_OPTIONS)\n</code></pre>"},{"location":"embedded-dev/MCU/at-tiny85/","title":"AT tiny85","text":"<p>\u624b\u4e0a\u6709\u4e24\u4e2a\u53ebLipyPad\u7684\u5c0f\u7535\u8def\u677f\uff0c\u67e5\u8be2\u53d1\u73b0\u662f\u4e2aatmel\u7684avr\u5355\u7247\u673a\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528digispark\u63d0\u4f9b\u7684\u5e93\u5728Arduino IDE\u4e2d\u8fdb\u884c\u7f16\u7a0b\u548c\u70e7\u5f55\uff0c\u4f3c\u4e4e\u633a\u597d\u73a9\u7684\u6837\u5b50\uff0c\u5927\u6982\u4e86\u89e3\u4e86\u4e00\u4e0b\uff0c\u968f\u540e\u914d\u7f6e\u4e00\u4e0b\u5f00\u53d1\u73af\u5883\uff0c\u8bb0\u5f55\u4e00\u4e0b\u3002</p> <p>\u7531\u4e8e\u56fd\u5185\u7f51\u7edc\u73af\u5883\u7684\u539f\u56e0\uff0cArduino IDE\u5f00\u53d1\u677f\u7ba1\u7406\u4e2d\u4e0b\u8f7d\u7d22\u5f15\u6587\u4ef6\u603b\u662f\u5931\u8d25\uff0c\u6240\u4ee5\u9700\u8981\u6dfb\u52a0\u4ee3\u7406\uff0c\u5728Arduino IDE\u7684\u7f51\u7edc\u8bbe\u7f6e\u4e2d\u624b\u52a8\u6dfb\u52a0\u4e00\u4e2ahttp\u7684\u4ee3\u7406\uff0c\u5982\u679c\u4f60\u7684\u7f51\u7edc\u6ca1\u6709\u95ee\u9898\uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u8fd9\u4e00\u6b65\u3002</p> <ol> <li> <p>\u6dfb\u52a0\u5f00\u53d1\u677f\uff0c\u6dfb\u52a0\u5f00\u53d1\u677f\u94fe\u63a5http://digistump.com/package_digistump_index.json\u5e76\u8fdb\u884c\u5b89\u88c5</p> </li> <li> <p>\u6211\u81ea\u5df1\u6d4b\u8bd5\u7684\u65f6\u5019\u53d1\u73b0\u70e7\u5f55\u4f9d\u8d56libusb-0.1\u7684\u5e93\uff0c\u4f46\u7cfb\u7edf\u9ed8\u8ba4\u5b89\u88c5\u7684\u662f1.0\u7684\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528apt search\u641c\u7d22\u5b89\u88c5\u4e00\u4e0blibusb-0.1</p> </li> <li> <p>attiny85\u70e7\u5f55\u7684\u56fa\u4ef6\u6765\u81ea\u8fd9\u91ccmicronucleus\uff0c\u8fd9\u4e2a\u56fa\u4ef6\u4f7f\u7528\u4e86\u4e00\u4e2a\u53ebv-usb\u7684\u5e93,\u9700\u8981\u5c06micronucleus\u4ed3\u5e93\u4e2dcommandline\u76ee\u5f55\u4e0b\u768449-micronucleus.rules\u6dfb\u52a0\u5230/etc/udev/rules.d\u4e2d\u5e76\u91cd\u542fudev\u670d\u52a1</p> </li> </ol> <p>\u4ee5\u4e0a\uff0c\u6ca1\u4ec0\u4e48\u610f\u5916\u7684\u8bdd\u5230\u8fd9\u91cc\u5c31\u53ef\u4ee5\u6253\u5f00\u4e00\u4e2ablink\u5b9e\u4f8b\u8fdb\u884c\u6d4b\u8bd5\u4e86\uff0c\u5728\u63d0\u793a\u8fde\u63a5\u5f00\u53d1\u677f\u540e\u63d2\u5165USB\u5373\u53ef\u4e0b\u8f7d\u6210\u529f\u4e86\u3002</p> <p>\u53ef\u4ee5\u53c2\u8003digispark wiki\u4e2d\u7684\u5b89\u88c5\u53ca\u4f7f\u7528\u5e2e\u52a9\u6587\u6863\u3002</p>"},{"location":"embedded-dev/MCU/dbg-tools/","title":"\u8c03\u8bd5\u5de5\u5177","text":""},{"location":"embedded-dev/MCU/dbg-tools/#jlink","title":"JLINK","text":"<p>\u4f7f\u7528eclipse\u7b49IDE\u65f6\u53ef\u80fd\u4f1a\u9700\u8981\u4f7f\u7528JLink\u8fdb\u884c\u7a0b\u5e8f\u70e7\u5f55\uff0c\u5982\u679c\u4f7f\u7528\u56fe\u5f62\u754c\u9762\u7684\u8bdd\u9700\u8981\u5728\u591a\u4e2a\u754c\u9762\u4e4b\u95f4\u8fdb\u884c\u5207\u6362\uff0c\u4e0d\u662f\u5f88\u65b9\u4fbf\uff0c\u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7Tools\u4e4b\u7c7b\u7684IDE\u5de5\u5177\u901a\u8fc7\u547d\u4ee4\u884c\u76f4\u63a5\u8c03\u7528JLink\u4ece\u800c\u5b9e\u73b0\u7a0b\u5e8f\u4e0b\u8f7d\uff0c\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\u3002</p> <p>JLink\u6709\u4e00\u4e2a\u5f88\u5b9e\u7528\u7684\u547d\u4ee4\u884c\u53c2\u6570\u662f-CommandFile &lt;*.jlink&gt;\uff0c\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u5411JLink\u7a0b\u5e8f\u4f20\u9012\u6211\u4eec\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u8fd9\u4e2a*.jlink\u6587\u4ef6\u7684\u5185\u5bb9\u5176\u5b9e\u5c31\u662fJLink\u5185\u90e8\u547d\u4ee4\u7684\u6709\u5e8f\u6392\u5217\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4fbf\u662f\u6211\u5728\u70e7\u5f55STM32F030K6\u7684\u7a0b\u5e8f\u65f6\u4f7f\u7528\u5230\u7684jlink\u6587\u4ef6\u3002</p> <p><pre><code>Device STM32F030K6\nsi SWD\nspeed 4000\nloadfile .\\bin\\Release\\stm32f030.hex\nr\ng\nexit\n</code></pre> Device \u547d\u4ee4\u6307\u5b9a\u76ee\u6807\u82af\u7247 si \u547d\u4ee4\u9009\u62e9\u8c03\u8bd5\u5668\u4f7f\u7528\u7684\u603b\u7ebf\uff0c\u5982SWD\u3001JTAG\u7b49 speed \u6307\u5b9a\u4f20\u8f93\u901f\u7387 loadfile \u547d\u4ee4\u52a0\u8f7d\u76ee\u6807\u6587\u4ef6\u81f3\u5355\u7247\u673a\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528loadbin r g exit \u4f9d\u6b21\u662f\u590d\u4f4d\u3001\u8fd0\u884c\u7136\u540e\u9000\u51faJLink.exe\u7a0b\u5e8f</p> <p>\u5c06\u4e0a\u9762\u7684\u8fd9\u51e0\u53e5\u4fdd\u5b58\u6210\u6587\u4ef6load.jlink\uff0c\u653e\u5230\u5de5\u7a0b\u76ee\u5f55\u4e2d\u53bb\uff0c\u7136\u540e\u4f7f\u7528IDE\u63d0\u4f9b\u7684\u5916\u90e8\u8c03\u7528\u5de5\u5177\u4fbf\u80fd\u76f4\u63a5\u5c06\u7a0b\u5e8f\u70e7\u5f55\u81f3\u5355\u7247\u673a\u4e86\u3002</p>"},{"location":"embedded-dev/MCU/dbg-tools/#daplink","title":"DAPLINK","text":"<p>CMSIS DAP\u662fARM\u63a8\u51fa\u7684\u5f00\u6e90\u65b9\u6848\u7684\u8c03\u8bd5\u5668\uff0c\u76ee\u524d\u8be5\u9879\u76ee\u5728Github\u4e0a\u5df2\u66f4\u540d\u4e3aDAPLink\uff0cARM\u5b98\u65b9\u63a8\u8350\u7684GDB Server\u662fpyocd\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528openocd\u6765\u4f5c\u4e3a\u8c03\u8bd5\u670d\u52a1\u5668\u3002</p> <p>\u4e4b\u524d\u4ece\u6069\u667a\u6d66\u6280\u672f\u793e\u533a\u8bba\u575b\u7533\u8bf7\u5230\u4e86\u4e07\u5229\u7684\u5f00\u53d1\u677fLPC54114\uff0c\u8be5\u677f\u677f\u8f7dCMSIS DAP\u8c03\u8bd5\u5668\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8fdb\u884c\u8c03\u8bd5\u3002\u6700\u521d\u6211\u6253\u7b97\u4f7f\u7528openocd\u6765\u4f5c\u4e3aGDB Server\uff0c\u4f46\u63a5\u4e0b\u6765\u6211\u53d1\u73b0\u76ee\u524d\u7248\u672c\u7684openocd\u5e76\u6ca1\u6709\u63d0\u4f9bLPC54114\u5fae\u63a7\u5236\u5668\u7684flash\u70e7\u5f55\u7b97\u6cd5\u652f\u6301\uff0c\u7136\u540e\u53ea\u80fd\u4f7f\u7528pyocd\u4e86\uff0c\u7136\u800cRelease\u7248\u672c(2018\u5e743\u6708\u5de6\u53f3\uff0c\u76ee\u524d\u7684\u7248\u672c\u5df2\u63d0\u4f9b\u4e86LPC54114\u652f\u6301)\u7684pyocd\u540c\u6837\u6ca1\u6709\u63d0\u4f9b\u652f\u6301,\u4f46\u662f\u6211\u5728github\u4ed3\u5e93\u4e2d\u53d1\u73b0\u5df2\u7ecf\u6709LPC54114\u7684\u652f\u6301\uff0c\u7136\u540e\u6309\u7167\u63d0\u793a\u4ece\u6e90\u7801\u8fdb\u884c\u4e86\u5b89\u88c5\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002</p>"},{"location":"embedded-dev/MCU/dbg-tools/#_2","title":"\u66f4\u65b0\u56fa\u4ef6","text":"<p>linux\u7cfb\u7edf\u4e0b\u66f4\u65b0\u56fa\u4ef6\u65e0\u6cd5\u4f7f\u7528\u62d6\u62fd\u5f0f\u66f4\u65b0\uff0c\u9700\u8981\u4f7f\u7528\u5982\u4e0b\u7684\u547d\u4ee4</p> <pre><code>dd if={new_firmware.bin} of={firmware.bin} conv=notrunc\n</code></pre>"},{"location":"embedded-dev/MCU/dbg-tools/#pyocd","title":"pyocd","text":"<p>\u76ee\u524d\u5f88\u5c11\u4f1a\u4f7f\u7528pyocd\u4f5c\u4e3agdbserver\u6765\u8fdb\u884c\u5355\u6b65\u8c03\u8bd5\uff0c\u4e3b\u8981\u7528\u5b83\u6765\u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u547d\u4ee4\u5982\u4e0b\uff0c\u53c2\u6570\u90fd\u6bd4\u8f83\u4e00\u76ee\u4e86\u7136\u4e86</p> <pre><code>pyocd flash -t lpc54114 xxx.bin\n</code></pre> <p>\u67e5\u770bpyocd\u652f\u6301\u7684target\u5217\u8868\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4</p> <pre><code>pyocd list --target\n</code></pre> <p>\u5176\u4ed6\u529f\u80fd\u7684\u4f7f\u7528\u53ef\u4ee5\u53c2\u8003\u5e2e\u52a9\u4fe1\u606f\u4ee5\u53capyocd\u7684\u652f\u6301\u6587\u6863\u3002</p>"},{"location":"embedded-dev/MCU/dbg-tools/#openocd","title":"openocd","text":"<p>\u81f3\u4e8eopenocd\uff0c\u867d\u7136\u6ca1\u6709\u4f7f\u7528\uff0c\u4f46\u5728\u8fd9\u91cc\u4e5f\u505a\u4e9b\u8bb0\u5f55\uff0c\u65b9\u4fbf\u4ee5\u540e\u4f7f\u7528\u3002\u4e0b\u9762\u6587\u6863\u6765\u6e90\u4e8eCMSIS-DAP\u548copenOCD\u90a3\u4e9b\u4e8b,\u4e3b\u8981\u6b65\u9aa4\u5982\u4e0b(\u4ee5stm32\u4e3a\u4f8b)</p> <ol> <li>\u65b0\u5efa\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6ocd-stm32.cfg\uff0c\u4f7f\u7528swd\u63a5\u53e3</li> </ol> <pre><code>interface cmsis-dap\ntransport select swd\nsource [find target/stm32f1x.cfg] </code></pre> <ol> <li>\u8fde\u63a5CMSIS-DAP\u548cstm32f103\uff0c\u52a0\u8f7d\u811a\u672c</li> </ol> <pre><code>openocd -f ./ocd-stm32.cfg\n</code></pre> <ol> <li>\u8fd9\u6837\u663e\u793a\u5c31\u662f\u8fde\u63a5\u6210\u529f\u4e86</li> </ol> <pre><code>Open On-Chip Debugger 0.9.0 (2015-05-19-12:09)\nLicensed under GNU GPL v2\nFor bug reports, read\nhttp://openocd.org/doc/doxygen/bugs.html\nInfo : only one transport option; autoselect 'swd'\nWarn : Transport \"swd\" was already selected\nadapter speed: 1000 kHz\nadapter_nsrst_delay: 100\nnone separate\ncortex_m reset_config sysresetreq\nInfo : CMSIS-DAP: SWD  Supported\nInfo : CMSIS-DAP: Interface Initialised (SWD)\nInfo : CMSIS-DAP: FW Version = 1.0\nInfo : SWCLK/TCK = 1 SWDIO/TMS = 1 TDI = 0 TDO = 0 nTRST = 0 nRESET = 1\nInfo : CMSIS-DAP: Interface ready\nInfo : clock speed 1000 kHz\nInfo : SWD IDCODE 0x1ba01477\nInfo : stm32f1x.cpu: hardware has 6 breakpoints, 4 watchpoints\n</code></pre> <p>openOCD\u9ed8\u8ba4\u7aef\u53e3telnet 4444\uff0cgdb server 3333\uff0c\u7136\u540etelnet\u8fde\u63a5\u5230 127.0.0.1:4444\uff0c\u5c31\u53ef\u4ee5\u4e3a\u6240\u6b32\u4e3a\u4e86\u3002</p> <pre><code>\u4e0b\u8f7d\u4e00\u4e2ahex\u6587\u4ef6\u5230flash\nflash write_image erase ./F103.hex\n</code></pre>"},{"location":"embedded-dev/MCU/msp430/","title":"MSP430","text":""},{"location":"embedded-dev/MCU/msp430/#launchpad-g2","title":"LaunchPad G2","text":"<p>\u624b\u91cc\u6709\u4e24\u5757LaunchPad G2\uff0c\u95f2\u7740\u6ca1\u4e8b\u5728linux\u4e0b\u642d\u4e86\u4e00\u4e0b\u7f16\u8bd1\u73af\u5883\uff0c\u5de5\u5177\u94fe\u76f4\u63a5\u53bbTI\u5b98\u7f51\u4e0b\u8f7dgcc\u5c31\u597d\uff0c\u4e0d\u8fc7\u8fd8\u5f97\u4e0b\u8f7d\u4e00\u4e2a\u652f\u6301\u5305\uff0c\u8fd9\u4e2a\u652f\u6301\u5305\u5305\u542b\u4e86\u6240\u6709\u8bbe\u5907\u7684\u5934\u6587\u4ef6\u548c\u94fe\u63a5\u811a\u672c\uff0c\u5b98\u7f51\u5feb\u901f\u6307\u5357\u91cc\u8bf4\u660e\u4e86\u652f\u6301\u6587\u4ef6\u5e94\u8be5\u62f7\u8d1d\u5230\u54ea\u91cc\u3002</p> <p>\u7136\u540e\u5b89\u88c5\u4e00\u4e0bmspdebug\uff0c\u76f4\u63a5apt\u5c31\u597d\uff0c\u8fd9\u4e2a\u7528\u6765\u70e7\u5f55\u7a0b\u5e8f\u5230\u5355\u7247\u673a\u4e2d\u3002</p> <p>\u6700\u540e\u5199\u4e2a\u7b80\u5355\u7684blink\uff0c\u5199\u4e2a\u7b80\u5355\u7684Makefile\u7f16\u8bd1\u4e00\u4e0b\uff0c\u7136\u540e</p> <pre><code>sudo mspdebug rf2500 'prog xxx.bin'\n</code></pre> <p>\u7a0b\u5e8f\u5c31\u6b22\u5feb\u7684\u8fd0\u884c\u8d77\u6765\u4e86\u3002</p>"},{"location":"embedded-dev/MCU/rt-thread/","title":"RT-Thread","text":""},{"location":"embedded-dev/MCU/rt-thread/#_1","title":"\u97f3\u9891\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1","text":"<p>\u5f88\u4e45\u4e4b\u524d\u673a\u7f18\u5de7\u5408\u62ff\u5230\u4e00\u5757\u4e07\u5229\u7535\u5b50\u7684LPC54114-Lite\u5f00\u53d1\u677f\uff0c\u4e00\u76f4\u4ee5\u6765\u90fd\u5bf9mp3\u5ff5\u5ff5\u4e0d\u5fd8\uff0c\u4e4b\u524d\u4e5f\u5728\u8fd9\u5757\u677f\u5b50\u4e0a\u8dd1\u8fc7libmp3\u8fd9\u4e2a\u5f00\u6e90\u7684\u89e3\u7801\u5e93\u6765\u64ad\u653emp3\uff0c\u4e0d\u8fc7\u90a3\u65f6\u8dd1\u7684\u662ffreeRTOS\uff0c\u6700\u8fd1\u67e5\u770brt-thread\u6587\u6863\u65f6\u6070\u5de7\u770b\u5230rt-thread\u6587\u6863\u4e2d\u5305\u542b\u4e86audio\u8bbe\u5907\u76f8\u5173\u7684\u8bf4\u660e\uff0c\u5fc3\u8840\u6765\u6f6e\uff0c\u53c2\u8003\u5176\u4ed6bsp\u4e2d\u5df2\u6709\u7684audio\u9a71\u52a8\uff0c\u505a\u4e86\u4e00\u4e9b\u57fa\u7840\u7684\u529f\u80fd\uff0c\u7b80\u5355\u5b9e\u73b0\u4e86\u4e00\u4e0b\u8be5\u677f\u5361\u4e0a\u7684\u97f3\u9891\u8bbe\u5907\u9a71\u52a8\u3002</p>"},{"location":"embedded-dev/MCU/rt-thread/#_2","title":"\u9a71\u52a8\u7ed3\u6784","text":"<p>\u7b80\u5355\u770b\u4e86\u4e0baudio\u8bbe\u5907\u7684\u6e90\u7801\uff0crt-thread\u7684\u8bbe\u5907\u9a71\u52a8\u8bbe\u8ba1\u601d\u60f3\u548cLinux\u63a5\u8fd1\uff0c\u63d0\u4f9b\u4e86\u4e00\u7cfb\u7edf\u901a\u7528\u7684ops\u56de\u8c03\u51fd\u6570\uff0c\u7531\u7279\u5b9a\u7684bsp\u4ee3\u7801\u6765\u5b9e\u73b0\u8fd9\u4e9bops\u56de\u8c03\u51fd\u6570\uff0c\u7136\u540e\u7528\u6237\u4ee3\u7801\u5c31\u80fd\u4f7f\u7528\u901a\u7528\u7684read/write\u6765\u64cd\u4f5c\u8bbe\u5907\u4e86\u3002\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u5173\u6ce8</p> <p><pre><code>struct rt_audio_ops\n{\nrt_err_t (*getcaps)(struct rt_audio_device *audio, struct rt_audio_caps *caps);\nrt_err_t (*configure)(struct rt_audio_device *audio, struct rt_audio_caps *caps);\nrt_err_t (*init)(struct rt_audio_device *audio);\nrt_err_t (*start)(struct rt_audio_device *audio, int stream);\nrt_err_t (*stop)(struct rt_audio_device *audio, int stream);\nrt_size_t (*transmit)(struct rt_audio_device *audio, const void *writeBuf, void *readBuf, rt_size_t size);\n/* get page size of codec or private buffer's info */\nvoid (*buffer_info)(struct rt_audio_device *audio, struct rt_audio_buf_info *info);\n};\n</code></pre> \u8fd9\u4e2aops\u7ed3\u6784\u5c31\u597d\u4e86\uff0c\u6bcf\u4e2a\u56de\u8c03\u51fd\u6570\u7684\u529f\u80fd\u4ece\u5b57\u9762\u610f\u4e49\u770b\u5df2\u7ecf\u5f88\u660e\u663e\u4e86\uff0c\u5177\u4f53\u7684\u5b9e\u73b0\u6211\u4eec\u53ef\u4ee5\u53c2\u8003\u5176\u4ed6bsp\u5df2\u6709\u7684audio\u9a71\u52a8\uff0c\u8fd9\u91cc\u6211\u53c2\u8003\u7684\u662fqemu-vexpress-a9\u8fd9\u4e2absp\u4e2d\u7684audio\u9a71\u52a8\uff0c\u5176\u5b9e\u53ea\u8981\u6b63\u786e\u7684\u5b9e\u73b0<code>init</code>\u3001<code>start</code>\u3001<code>stop</code>\u3001<code>transmit</code>\u3001<code>buffer_info</code>\u8fd9\u51e0\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u97f3\u9891\u8bbe\u5907\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\uff0c\u53ea\u4e0d\u8fc7\u65e0\u6cd5\u8fdb\u884c\u914d\u7f6e\u3002 \u8fd9\u91cc\u8fd8\u9700\u8981\u5173\u6ce8\u7684\u662f<code>rt_audio_tx_complete</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u4f1a\u5c06\u5f85\u53d1\u9001\u7684\u6570\u636e\u62f7\u8d1d\u81f3<code>buffer_info</code>\u6240\u6307\u5b9a\u7684\u7f13\u51b2\u533a\u4e2d\uff0c\u5982\u679ctransmit\u8fd9\u4e2a\u56de\u8c03\u5b58\u5728\u7684\u8bdd\uff0c\u4f1a\u89e6\u53d1\u8be5\u56de\u8c03\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002</p>"},{"location":"embedded-dev/MCU/rt-thread/#ops","title":"ops\u56de\u8c03\u5b9e\u73b0","text":"<p>\u8fd9\u4e9bops\u56de\u8c03\u90fd\u8ddf\u5177\u4f53\u7684\u5668\u4ef6\u548c\u786c\u4ef6\u8fde\u7ebf\u76f8\u5173\u4e86\uff0c<code>init</code>\u505a\u5177\u4f53\u786c\u4ef6\u7684\u521d\u59cb\u5316\uff0c<code>start</code>\u4f7f\u80fd\u5668\u4ef6\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c<code>stop</code>\u7ed3\u675f\u6570\u636e\u4f20\u8f93\uff0c<code>transmit</code>\u5f00\u59cb\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u5757\u4f20\u8f93\uff0c<code>buffer_info</code>\u83b7\u53d6\u7f13\u5b58\u533a\u4fe1\u606f\uff0c\u76f4\u63a5\u53c2\u8003\u5176\u4ed6bsp\u7684\u5b9e\u73b0\u5c31\u53ef\u4ee5\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528DMA\u6765\u8fdb\u884c\u97f3\u9891\u6570\u636e\u7684\u4f20\u8f93\uff0c\u8fd9\u91cc\u9700\u8981\u8003\u8651\u4e0d\u540cmcu\u7684\u5dee\u5f02\uff0c\u5bf9\u4e8estm32f4\u6765\u8bf4\uff0c\u4ed6\u7684dma\u652f\u6301\u534a\u7a7a\u548c\u5168\u7a7a\u4e2d\u65ad\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5c06dma\u914d\u7f6e\u4e3a\u4e52\u4e53\u4f20\u8f93\u6a21\u5f0f\uff0c\u53ef\u4ee5\u7701\u53bbtransmit\u8fd9\u4e2a\u56de\u8c03\u3002 \u5bf9\u4e8eLPC54114-Lite\u8fd9\u4e2a\u677f\u5361\uff0c\u4ed6\u7684dma\u662f\u53ef\u4ee5\u914d\u7f6e\u6210\u4e52\u4e53\u6a21\u5f0f\u7684\uff0c\u4f46\u662fdma\u53ea\u6709\u5168\u7a7a\u8fd9\u4e2a\u7c7b\u578b\u7684\u4e2d\u65ad\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u6682\u4e14\u5b9e\u73b0\u4e00\u4e0btransmit\u8fd9\u4e2a\u56de\u8c03\uff0c\u7531\u8fd9\u4e2a\u56de\u8c03\u6765\u89e6\u53d1\u6570\u636e\u7684\u4f20\u8f93\u3002 \u57fa\u672c\u4e0a\u5230\u8fd9\u91cc\u97f3\u9891\u8bbe\u5907\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7b80\u5355\u7684\u6d4b\u8bd5\u64ad\u653e\u56fa\u5b9a\u9891\u7387\u7684\u97f3\u9891\uff0c\u7136\u540e\u5b9e\u73b0<code>configure</code>\u56de\u8c03\u4e4b\u540e\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u97f3\u9891\u91c7\u6837\u7387\u8fd9\u4e9b\u53c2\u6570\u4e86\uff0c\u97f3\u9891\u8bbe\u5907\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002</p>"},{"location":"embedded-dev/MCU/rtos/","title":"RTOS\u7b80\u5355\u5bf9\u6bd4","text":"<p>\u5927\u591a\u6570\u4fe1\u606f\u6765\u6e90\u4e8e\u7f51\u7edc\uff0c\u5177\u6709\u4e00\u5b9a\u7684\u53c2\u8003\u4ef7\u503c\uff0c\u53c2\u8003\u94fe\u63a5\u5982\u4e0b\uff1a</p> <p>https://www.zhihu.com/question/301250055</p> <p>https://zhuanlan.zhihu.com/p/23618181</p> <p>\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08Real-time operating system, RTOS\uff09\uff0c\u53c8\u79f0\u5373\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b83\u4f1a\u6309\u7167\u6392\u5e8f\u8fd0\u884c\u3001\u7ba1\u7406\u7cfb\u7edf\u8d44\u6e90\uff0c\u5e76\u4e3a\u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u4e00\u81f4\u7684\u57fa\u7840\u3002</p> <p>\u76ee\u524d\u5174\u8d77\u7684\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u5176\u6838\u5fc3\u5c31\u662fRTOS\uff0c\u66f4\u591a\u7684\u662f\u56f4\u7ed5\u5176\u5f00\u53d1\u5404\u81ea\u7684\u751f\u6001\uff0c\u4ece\u800c\u4f7f\u5f00\u53d1\u66f4\u52a0\u65b9\u4fbf\uff0c\u52a0\u5feb\u4ea7\u54c1\u5316\u7684\u901f\u5ea6\u3002</p> <p>\u76ee\u524d\u7f51\u4e0a\u5404\u7c7b\u5f00\u6e90\u7684RTOS/\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u5c42\u51fa\u4e0d\u7a77\uff0c\u56fd\u5185\u53d7\u4f17\u5e7f\u6cdb\u7684\u4ee5\u53ca\u6bd4\u8f83\u77e5\u540d\u7684\u4e3b\u8981\u6709\uff1aFreeRTOS\u3001ucosiii\u3001RT-Thread\u3001Contiki\u3001Zephyr\u3001Nuttx\u3001RIOT\u3001mbedOS\u3001RTX...</p> <ul> <li>FreeRTOS\uff1a\u5168\u4e16\u754c\u4f7f\u7528\u91cf\u6700\u5927\u7684\u4e86\uff0c\u8fd8\u6709\u4e00\u4e2aSafeRTOS\u7684\u7248\u672c\u3002\u8001\u724c\u7cfb\u7edf\uff0c\u7a33\u5b9a\u6027\u6709\u4fdd\u969c\u3002</li> <li>ucos III\uff1a\u5f00\u6e90\u534f\u8bae\u53d8\u6765\u53d8\u53bb\u7684\u3002\u672c\u6765ucosii\u7684\u65f6\u5019\u7528\u6237\u57fa\u6570\u4e5f\u5f88\u5927\u7684\u3002\u4ee3\u7801\u5bb9\u9519\u505a\u4e86\u5f88\u591a\uff0c\u4fdd\u8bc1\u4e86\u7a33\u5b9a\u6027\u3002\u8001\u724c\u7cfb\u7edf\uff0c\u6709\u4fdd\u969c\u3002</li> <li>RT-Thread\uff1a\u4e0a\u6d77\u8d5b\u777f\u5fb7\u5f00\u53d1\u7684\uff0c\u56fd\u5185\u793e\u533a\u5efa\u8bbe\u5f88\u597d\u3002\u63d0\u51fa\u4e86\u8f6f\u4ef6\u5305\u6982\u5ff5\u548c\u4e00\u4e9b\u517c\u5bb9Unix\u63a5\u53e3\u3002\u719f\u6089Linux\u7684\u6216\u8005\u5df2\u6709Linux\u4ee3\u7801\u7684\u9879\u76ee\u79fb\u690d\u8d77\u6765\u5f88\u65b9\u4fbf\u3002\u4f7f\u7528\u8d77\u6765\u8fd8\u662f\u5f88\u65b9\u4fbf\u7684\u3002</li> <li>Contiki\uff1a\u8fd9\u4e2a\u4e25\u683c\u8bf4\u4e0d\u662f\u4e2aRTOS\uff0c\u5b9e\u9645\u4f7f\u7528PT\u534f\u7a0b\u8c03\u5ea6\u5199\u7684\uff0c\u4f5c\u8005\u4e5f\u5c31\u662fPT\u7684\u4f5c\u8005\uff0c\u8bb0\u5f97\u662f\u4e2a\u745e\u5178\u7684\u5927\u4f6c\u3002\u6240\u4ee5\u6ca1\u6709\u8fdb\u7a0b\u6808\uff0c\u76f8\u5f53\u4e8e\u8fd8\u662f\u5728\u4e00\u4e2awhile\u91cc\u8fd0\u884c\u7684switch\u5206\u652f\u3002\u4e5f\u6b63\u56e0\u4e3a\u5982\u6b64\uff0c\u5f00\u9500\u5f88\u5c0f\uff0c8051\u5185\u4e2a\u90fd\u8dd1\u7684\u52a8\u3002Contiki\u4e5f\u662f\u4e2a\u5fae\u5185\u6838\uff08microkernel\uff09\uff0c\u6240\u6709\u7684\u7cfb\u7edf\u670d\u52a1\u90fd\u662f\u901a\u8fc7\u542f\u7ebf\u7a0b\u5b8c\u6210\uff0cProtothreads\u7ebf\u7a0b\u6574\u5408\u4e86\u7ebf\u7a0b\u95f4\u4e8b\u4ef6\u901a\u8baf\uff0c\u4f7f\u5f97\u7f16\u5199\u7cfb\u7edf\u670d\u52a1\u975e\u5e38\u5bb9\u6613\u3002\u9a71\u52a8\u7a0b\u5e8f\u65b9\u9762\uff0cContiki\u6ca1\u6709\u7edf\u4e00\u7684\u9a71\u52a8\u7a0b\u5e8f\u6846\u67b6\uff0c\u9a71\u52a8\u90fd\u662f\u5404\u5bb6MCU\u81ea\u5e26\u5f00\u53d1\u5305\u63d0\u4f9b\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\u80fd\u591f\u4fdd\u8bc1\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u591f\u5c0f\u3002</li> <li>Nuttx\uff1a\u548clinux\u5f88\u50cf\uff0c\u529f\u80fd\u4e5f\u975e\u5e38\u5168\u3002</li> <li>RIOT\u662f\u9762\u5411\u5f00\u53d1\u8005\u7684\uff0c\u5f00\u6e90\u7684\uff0c\u9002\u5408\u7269\u8054\u7f51\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\u5b83\u7684\u80cc\u540e\u6ca1\u6709\u67d0\u4e2a\u516c\u53f8\u7684\u652f\u6301\uff0c\u800c\u5b8c\u5168\u662f\u7531\u793e\u533a\u9a71\u52a8\u3002</li> <li>Zephyr:Linux\u57fa\u91d1\u4f1a\u65d7\u4e0b\u9879\u76ee\uff0c\u548cLinux\u5f88\u50cf\u3002\u652f\u6301\u7684\u5f00\u53d1\u677f\u5f88\u591a\uff0c\u7ec4\u4ef6\u4e5f\u5f88\u591a\uff0c\u793e\u533a\u4e5f\u5f88\u6d3b\u8dc3\uff0c\u7f3a\u70b9\u662f\u5165\u95e8\u96be\u5ea6\u8f83\u5927\uff0c\u7f16\u8f91\u73af\u5883\u6784\u5efa\u590d\u6742\u3002</li> <li>RTX\uff1artx\u8fd9\u4e2a\u771f\u5fc3\u4e0d\u9519\u3002\u4ece51\u5c31\u5f00\u59cb\u7528\uff0c\u96c6\u6210\u5728keil\u91cc\u9762\uff0c\u5efa\u5de5\u7a0b\u5f88\u65b9\u4fbf\uff0c\u529f\u80fd\u4e5f\u5f88\u5f3a\u5927\u3002\u8fd8\u6709jlink\u5185\u4e2asegger\u5bb6\u7684\uff0c\u4e5f\u633a\u597d\uff0c\u633a\u559c\u6b22\u4ed6\u5bb6\u7684\u5404\u79cd\u7ec4\u4ef6\u7684</li> </ul> <p>\u9879\u76ee\u9636\u6bb5:\u63a8\u8350freertos,ucosiii\u6216\u8005rt-thread\u7684ltsc\u5206\u652f\uff0c\u4f9d\u987a\u5e8f\u63a8\u8350\u3002\u7a33\u5b9a\u6027\u6700\u91cd\u8981\uff0c\u5982\u679c\u9879\u76ee\u9700\u8981\u7279\u6b8a\u8ba4\u8bc1\u5565\u7684\u9700\u8981\u4f60\u518d\u770b\u770b</p> <p>\u4f20\u611f\u5668\u9879\u76ee:contiki,nuttx\u90fd\u4e0d\u9519</p> <p>\u7279\u6b8a\u9700\u6c42\u6bd4\u5982zigbee\u534f\u8bae\u6808\u84dd\u7259\u534f\u8bae\u6808\u6216\u8005\u4ec0\u4e48\u7684\uff0c\u4f60\u518d\u770b\u5177\u4f53\u573a\u666f\u5427\u7528keil\u7684\u53ef\u4ee5\u5c1d\u8bd5\u4e0brtx</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u5404\u7c7bRTOS\u7684\u6838\u5fc3\u90fd\u662f\u8c03\u5ea6\uff0c\u5269\u4e0b\u7684\u90fd\u662f\u56f4\u7ed5\u8fd9\u4e2a\u6838\u5fc3\u589e\u52a0\u5404\u7c7b\u8bbe\u5907\u9a71\u52a8\u6a21\u578b\u3001\u901a\u4fe1\u6a21\u578b\u3001\u7f51\u7edc\u901a\u4fe1\u63a5\u53e3\u3001POSIX\u517c\u5bb9\u63a5\u53e3\uff0c\u57fa\u672c\u90fd\u662f\u751f\u6001\u7684\u6bd4\u62fc\uff0c\u4f5c\u4e3a\u7231\u597d\u8005\u6216\u8005\u5f00\u53d1\u4eba\u5458\u8fd8\u662f\u9700\u8981\u6839\u636e\u5177\u4f53\u7684\u60c5\u51b5\u6765\u9009\u62e9\u9002\u5408\u81ea\u5df1\u4f7f\u7528\u7684\u7cfb\u7edf\u3002</p>"},{"location":"embedded-dev/amlogic/s905x/","title":"S905X","text":""},{"location":"embedded-dev/amlogic/s905x/#_1","title":"\u7b80\u4ecb","text":"<p>\u5728\u67d0\u4e8c\u624b\u5e02\u573a\u5165\u624b\u4e86\u4e00\u4e2a\u7535\u89c6\u76d2\u5b50\uff0c\u76d2\u5b50\u578b\u53f7\u4e3a<code>Trongle X3</code>\uff0c\u4e3b\u63a7\u4e3aS905X\u3002</p> <p>\u641c\u7d22\u53d1\u73b0\uff0c\u8fd9\u4e2a\u578b\u53f7\u7684\u76d2\u5b50\u4e0e<code>MINI M8S II</code>\u8fd9\u4e2a\u76d2\u5b50\u5916\u5f62/PCB\u7b49\u5b8c\u5168\u4e00\u81f4\uff0c\u5e76\u4e14\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528<code>p212</code>\u8bbe\u5907\u6811\u542f\u52a8\u5185\u6838\uff0c\u53ea\u6709\u5185\u5b58\u5bb9\u91cf\u4e0eEMMC\u5bb9\u91cf\u7565\u6709\u4e0d\u540c\uff0c\u5176\u5916\u5f62/PCB\u7b49\u56fe\u7247\u5982\u4e0b\u3002</p> <p>\u7535\u89c6\u76d2\u5b50\u5185\u90e8\u56fe\u7247\u6765\u81ea\u8fd9\u91cc\u3002</p> <p> </p> <p>\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u524d\u9762\u677fled\u706f\u662f\u7531GPIODV_24\u63a7\u5236\uff0c1\u70b9\u4eae\uff0c0\u7184\u706d\u3002</p>"},{"location":"embedded-dev/amlogic/s905x/#_2","title":"\u6570\u636e\u624b\u518c","text":"<p>S905X\u6570\u636e\u624b\u518c</p> <p>S905X GPIO\u7528\u6237\u6307\u5357</p>"},{"location":"embedded-dev/amlogic/s905x/#_3","title":"\u542f\u52a8\u6d41\u7a0b","text":"<p>S905X\u7684\u542f\u52a8\u6d41\u7a0b\u89c1\u6570\u636e\u624b\u518c\u4e2d\u7684<code>18.2</code>\u5c0f\u8282\uff0c\u5173\u4e8e\u542f\u52a8\u6d41\u7a0b\u4e2d\u63d0\u5230\u7684<code>recovery</code>\u4fe1\u53f7\uff0c\u53ef\u4ee5\u901a\u8fc7<code>Amlogic HDMI Boot Dongle</code>\u8bbe\u5907\u6765\u8fdb\u884c\u63a7\u5236\uff0c\u8be6\u7ec6\u7684\u8bf4\u660e\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\uff0c\u672c\u5c0f\u8282\u540e\u7eed\u5185\u5bb9\u5927\u90fd\u6765\u81ea\u6b64\u5904\u3002</p> <p>Amlogic BOOTROM\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\u4f1a\u901a\u8fc7HDMI\u63a5\u53e3\u4e2d\u7684I2C\u603b\u7ebf\u4ece\u5730\u5740<code>0x52</code>\uff0c\u504f\u79fb<code>0xf8(248)</code>\u5904\u8bfb\u53d68\u5b57\u8282\u5185\u5bb9\uff0c\u5982\u679c\u8fd98\u5b57\u8282\u5185\u5bb9\u662f<code>boot@USB</code>\u90a3\u4e48\u4f1a\u5f3a\u5236\u4eceUSB\u8fdb\u884c\u542f\u52a8\u3002\u76f8\u5e94\u7684\uff0c\u5982\u679c\u5185\u5bb9\u662f<code>boot@SDC</code>\u548c<code>boot@SPI</code>\u90a3\u4e48\u4f1a\u5f3a\u5236\u4eceSD\u5361\u548cSPI\u8fdb\u884c\u542f\u52a8\u3002</p> <p><code>Amlogic HDMI Boot Dongle</code>\u8bbe\u5907\u7684\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4e3b\u8981\u5143\u5668\u4ef6\u4e3a\u4e00\u4e2aEEPROM\u3002</p> <p></p> <p>\u4ee5Linux\u5e73\u53f0\u3001i2c-dev\u9a71\u52a8\u4e3a\u4f8b\u6307\u5b9a\u4eceSD\u5361\u542f\u52a8\uff0c\u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u5199\u5165eeprom\uff1a</p> <pre><code>$ cd /sys/bus/i2c/devices/i2c-0\n$ echo 24c02 0x52 &gt; new_device\n$ cd *-0052\n$ echo -n \"boot@SDC\" | dd of=eeprom bs=1 seek=248\n$ dd if=eeprom bs=1 skip=248 | hexdump\n</code></pre> <p>\u6ce8\u610f\uff1a\u4eceSD\u5361\u542f\u52a8\u4f3c\u4e4e\u9700\u8981\u4f7f\u7528SDHC\u89c4\u683c\u7684SD\u5361\uff0c\u5426\u5219\u4f1a\u51fa\u73b0<code>sd/emmc read data error: ret=16</code>\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u6d4b\u8bd5\u53d1\u73b0\u786e\u5b9e\u5982\u6b64\uff0c\u53c2\u8003\u8fd9\u91cc\u3002</p>"},{"location":"embedded-dev/amlogic/s905x/#_4","title":"\u7cfb\u7edf\u70e7\u5f55","text":"<p>\u7535\u89c6\u76d2\u5b50\u9ed8\u8ba4\u8fd0\u884c\u7684\u7cfb\u7edf\u662fAndroid\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7f51\u53cb\u63d0\u4f9b\u7684\u9884\u7f16\u8bd1\u955c\u50cf\u6765\u8fd0\u884cDebian\u7b49\u53d1\u884c\u7248\u3002</p> <p>\u7ecf\u8fc7\u6d4b\u8bd5\uff0cophub\u63d0\u4f9b\u7684Armbian\u53ef\u4ee5\u6b63\u5e38\u542f\u52a8\u548c\u4f7f\u7528\uff0c\u8be6\u7ec6\u7684\u4e0b\u8f7d\u5b89\u88c5\u65b9\u5f0f\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\u3002</p> <p>\u6b64\u578b\u53f7\u7684\u7535\u89c6\u76d2\u5b50\u5bf9\u5e94\u7684u-boot\u4e0edtb\u5206\u522b\u4e3a<code>u-boot-s905x-s912.bin</code>\u548c<code>meson-gxl-s905x-p212.dtb</code>\u3002</p>"},{"location":"embedded-dev/amlogic/s905x/#u-boot","title":"u-boot\u7f16\u8bd1","text":"<p>\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u4f7f\u7528\u4e0a\u6e38u-boot\u7684<code>p212_defconfig</code>\u914d\u7f6e\u6587\u4ef6\u7f16\u8bd1\u51fa\u7684u-boot\u4e8c\u8fdb\u5236\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u76d2\u5b50\u81ea\u5e26\u7684u-boot\u8fd0\u884c\u8d77\u6765\uff0c\u4f46\u662f\u5982\u679c\u8981\u5236\u4f5c\u53ef\u542f\u52a8\u7684u-boot\u955c\u50cf\u7684\u8bdd\u8fd8\u9700\u8981\u4eceEMMC\u4e2d\u5bfc\u51fa\u81ea\u5e26\u7684u-boot\uff0c\u968f\u540e\u63d0\u53d6\u51faBL2x\u3001BL3x\u7b49\u5e76\u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\uff0c\u7b80\u5355\u6d41\u7a0b\u5982\u4e0b:</p> <pre><code>$ dd if=/dev/block/bootloader of=bootloader.dump\n$ dd if=bootloader.dump of=dump.bin bs=512 skip=1\n$ cd gxlimg &amp;&amp; mkdir images\n$ ./gxlimg -e ../dump.bin images\n$ ./gxlimg -t bl3x -c u-boot-dtb.bin images/u-boot.bin.enc\n$ ./gxlimg -t fip --bl2 images/bl2.sign --bl30 images/bl30.enc --bl31 images/bl31.enc --bl33 images/u-boot.bin.enc images/gxl-boot.bin\n$ # dd to sd card\n$ dd if=images/gxl-boot.bin of=/dev/sdX bs=512 seek=1\n</code></pre> <p>\u4e0a\u8ff0\u6d41\u7a0b\u7684\u57fa\u672c\u539f\u7406\u662f\u4f7f\u7528\u539f\u6709\u955c\u50cf\u4e2d\u7684BL2x\u3001BL3x\u7b49\u90e8\u5206\u914d\u5408\u81ea\u884c\u7f16\u8bd1\u51fa\u7684u-boot\uff0c\u5c06\u5176\u7ec4\u5408\u6210\u4e00\u4e2a\u65b0\u7684\u53ef\u542f\u52a8\u7684bootloader\uff0c\u8be6\u7ec6\u539f\u7406\u53ca\u4ecb\u7ecd\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\u548c\u8fd9\u91cc</p>"},{"location":"embedded-dev/amlogic/s905x/#_5","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>Mini M8S II TV Box (Amlogic S905X) Review \u2013 Part 1: Unboxing and Teardown</p> <p>Amlogic HDMI Boot Dongle</p> <p>amlogic-s9xxx-armbian</p> <p>u-boot-misc</p> <p>glximg</p>"},{"location":"embedded-dev/bootloader/u-boot/u-boot/","title":"U-Boot","text":""},{"location":"embedded-dev/bootloader/u-boot/u-boot/#1","title":"1. \u521d\u59cb\u5316\u6d41\u7a0b","text":"<p> \u56fe\u6e90\u89c1\u6c34\u5370</p>"},{"location":"embedded-dev/bootloader/u-boot/u-boot/#2","title":"2. \u677f\u7ea7\u914d\u7f6e","text":"<p>\u4e0d\u540c\u7248\u672c\u9636\u6bb5\u7684u-boot\u5bf9\u5355\u677f\u7684\u914d\u7f6e\u65b9\u5f0f\u5e76\u4e0d\u4e00\u81f4\u3002\u8f83\u65e9\u7248\u672c\u7684u-boot\u662f\u901a\u8fc7\u6839\u76ee\u5f55\u4e0b\u7684Makefile\u6765\u76f4\u63a5\u5bf9\u5355\u677f\u8fdb\u884c\u5b9a\u4e49\u7684\uff1b\u4ece2010.09\u7248\u672c\u5f00\u59cb\u677f\u7ea7\u914d\u7f6e\u8fc1\u79fb\u5230\u4e86boards.cfg\u6587\u4ef6\u4e2d;\u800c2014.10\u7248\u672c\u4e4b\u540e\uff0c\u677f\u7ea7\u914d\u7f6e\u6587\u4ef6\u7edf\u4e00\u8fc1\u79fb\u5230\u4e86configs\u76ee\u5f55\u4e0b\uff0c\u677f\u7ea7\u914d\u7f6e\u5934\u6587\u4ef6\u4fdd\u5b58\u5728/include/configs\u8def\u5f84\u4e0b\u3002</p> <p>u-boot\u7684\u7a7a\u95f4\u5212\u5206\u5728crt0.S\u4e2d\u7684board_init_f\u5b8c\u6210\uff0c\u5728relocate\u4e4b\u524d\u5bf9\u7a7a\u95f4\u8fdb\u884c\u5212\u5206\uff0c\u8ba1\u7b97\u51farelocate\u7684\u4f4d\u7f6e\u504f\u79fb\u4ee5\u53caglobal_data\u7b49\u7684\u504f\u79fb\uff0c\u7136\u540e\u5bf9u-boot\u4ee3\u7801\u8fdb\u884c\u4e86\u91cd\u5b9a\u5411\u3002</p> <p>\u6dfb\u52a0\u65b0\u7684\u9ed8\u8ba4\u73af\u5883\u53d8\u91cf\u5728include/env_default.h\u4e2d\u3002</p> <p>\u6dfb\u52a0\u6539\u52a8\u7684\u539f\u5219\u662f\u5c3d\u53ef\u80fd\u7684\u5c11\u4fee\u6539\u516c\u5171\u6587\u4ef6\uff0c\u76f8\u5173\u6539\u52a8\u5c3d\u53ef\u80fd\u7684\u653e\u5230\u677f\u7ea7\u6587\u4ef6\u4e2d\u3002</p> <p>\u4f7f\u7528SPL\u65f6\u5e0c\u671b\u53ef\u4ee5\u81ea\u52a8\u751f\u6210u-boot-with-spl.bin\u6587\u4ef6\uff0c\u65b9\u4fbf\u6211\u4eec\u70e7\u5f55\uff0cu-boot\u7684Makefile\u5df2\u7ecf\u505a\u597d\u4e86\u8fd9\u90e8\u5206\u5de5\u4f5c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u677f\u7ea7\u914d\u7f6e\u5934\u6587\u4ef6\u4e2d\u5b9a\u4e49\u5982\u4e0b\u4e24\u4e2a\u5b8f\u5373\u53ef</p> <pre><code>#define CONFIG_SPL_TARGET \"u-boot-with-spl.bin\"\n#define CONFIG_SPL_PAD_TO 0x1000\n</code></pre> <p>\u5176\u4e2d\uff0cCONFIG_SPL_TARGET\u8fd9\u4e2a\u5b8f\u5b9a\u4e49\u4e86\u5408\u5e76\u540e\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5982\u679c\u4e0d\u4f7f\u7528u-boot-with-spl.bin\u8fd9\u4e2a\u540d\u79f0\u7684\u8bdd\u9700\u8981\u81ea\u884c\u5728Makefile\u4e2d\u6dfb\u52a0\u76f8\u5e94\u7684\u89c4\u5219\u6765\u751f\u6210\u6700\u7ec8\u7684\u6587\u4ef6\u3002CONFIG_SPL_PAD_TO\u8fd9\u4e2a\u5b8f\u5b9a\u4e49\u4e86\u6211\u4eecSPL\u6240\u5360\u7684\u5927\u5c0f\uff0c\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u586b\u5199\u5c31\u53ef\u4ee5\u3002</p> <p>\u5728mini2440\u4e0a\u7f16\u8bd1u-boot\u65f6\uff0c\u4f7f\u7528codesourcery\u7684arm-2014.05-29-arm-none-linux-gnueabi-i686-pc-linux-gnu.tar.bz2\u5de5\u5177\u94fe\uff0c\u53ef\u4ee5\u7f16\u8bd1\u6210\u529f\u4f46\u662f\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\uff0c\u7528led\u706f\u5b9a\u4f4d\u95ee\u9898\u53d1\u73b0\u95ee\u9898\u51fa\u5728get_PCLK()\u51fd\u6570\uff0c\u6000\u7591\u95ee\u9898\u51fa\u5728\u6d6e\u70b9\u8fd0\u7b97\u90e8\u5206\uff0c\u4e0a\u7f51\u67e5\u8bc1\uff0c\u786e\u5b9e\u5982\u6b64\uff0c\u800cu-boot\u4e5f\u63d0\u4f9b\u4e86\u7528\u6237\u79c1\u6709\u5e93\uff0c\u7531CONFIG_USE_PRIVATE_LIBGCC\u63a7\u5236\uff0c\u7136\u540e\u5728mini2440_defconfig\u4e2d\u6dfb\u52a0\u8fd9\u4e00\u9879\uff0cu-boot\u5c31\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\u4e86:)</p>"},{"location":"embedded-dev/epaper/","title":"\u7535\u5b50\u58a8\u6c34\u5c4f","text":""},{"location":"embedded-dev/epaper/#2in9","title":"2in9\u8bb0\u5f55","text":"<p>\u4ece\u6c49\u67142.9\u5bf8\u7535\u5b50\u4ef7\u7b7e\u4e2d\u62c6\u51fa\u7684\u58a8\u6c34\u5c4f\u53ef\u4ee5\u4f7f\u7528\u5fae\u96ea\u7535\u5b50\u7684V1\u7248\u672c\u7a0b\u5e8f\u8fdb\u884c\u9a71\u52a8\uff0c\u6709\u51e0\u70b9\u9700\u8981\u8bb0\u5f55\u4e00\u4e0b</p> <p>\u58a8\u6c34\u5c4f\u8f83\u957f\u7684\u4e00\u4fa7\u4e3a\u9a71\u52a8\u82af\u7247\u7684\u9ad8\u4fa7\uff0c\u8f83\u77ed\u7684\u4e00\u4fa7\u4e3a\u9a71\u52a8\u82af\u7247\u7684\u5bbd\u4fa7\uff0c\u793a\u610f\u56fe\u5982\u4e0b</p> <pre><code>       0               128\n        ----------------        01234567 ... 128\n0      |                |       ******** ...  * \n       |                |       \u5728\u5bbd\u4fa7\u6bcf8\u4e2a\u50cf\u7d20\u70b9\u4e3a\u4e00\u7ec4\uff0c\u5b57\u8282\u5012\u5e8f\uff0c\u5373pixel 0\u4e3aMSB\uff0c\n       |                |       pixel 7\u4e3aLSB\uff0c\u53d6\u6a21\u65f6\u9700\u8981\u6ce8\u610f\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n       |                |\n296    |                |\n        ----------------\n</code></pre> <p>\u7535\u5b50\u4ef7\u7b7e\u5185\u90e8\u6709\u4e00\u4e2aMOS-FET\u7528\u4e8e\u63a7\u5236\u58a8\u6c34\u5c4f\u7684\u4f9b\u7535\uff0c\u8fde\u63a5\u5728P2.6\u3002</p> <p>\u6700\u7ec8\u7684\u663e\u793a\u6548\u679c\u5982\u4e0b</p> <p></p> <p>\u4f7f\u7528\u7535\u5b50\u4ef7\u7b7e\u81ea\u5e26\u7684MSP430\u5355\u7247\u673a\u9a71\u52a8\u7684\u793a\u4f8b\u7a0b\u5e8f\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\u3002</p> <p>\u7535\u5b50\u58a8\u6c34\u5c4f\u4e2dlut\u7684\u65f6\u5e8f\u89e3\u8bfb\uff0c\u4ee5phase0A\u4e3a\u4f8b:</p> <ul> <li>\u5f53\u50cf\u7d20\u70b9\u4ece\u767d\u8f6c\u9ed1\u65f6(HL), V_{pixel} \u7535\u538b\u4e3a VSH</li> <li>\u5f53\u8c61\u7d20\u70b9\u4ece\u9ed1\u8f6c\u767d\u65f6(LH), V_{pixel} \u7535\u538b\u4e3a VSL</li> <li>\u5176\u4ed6\u60c5\u51b5\u4e0b\uff0cV_{pixel} \u7535\u538b\u4e3a VSS</li> </ul>"},{"location":"embedded-dev/fet/","title":"\u573a\u6548\u5e94\u7ba1","text":""},{"location":"embedded-dev/fet/#_2","title":"\u53c2\u8003\u8d44\u6599","text":"<p>MOS\u7ba1\u7684\u5de5\u4f5c\u539f\u7406</p> <p>\u4e00\u6587\u5f7b\u5e95\u5f04\u6e05MOS\u7ba1 \uff08NMOS\u4e3a\u4f8b\uff09</p>"},{"location":"embedded-dev/fet/#_3","title":"\u5de5\u4f5c\u539f\u7406","text":"<p>\u573a\u6548\u5e94\u7ba1\u4f9d\u9760\u7535\u573a\u6765\u63a7\u5236\u5bfc\u7535\u6c9f\u9053\uff0c\u4ece\u800c\u8fbe\u5230\u63a7\u5236\u7535\u6d41\u7684\u76ee\u7684\u3002</p> <p></p> <p>\u4ee5\u4e0a\u56feNMOS\u4e3a\u4f8b\uff0c\u5728\u95e8\u6781(G)\u4e0e\u886c\u5e95(B)\u672a\u65bd\u52a0\u7535\u573a\u7684\u60c5\u51b5\u4e0b\uff0c\u6e90\u6781(S)\u4e0e\u886c\u5e95(B)\u3001\u6f0f\u6781(D)\u4e0e\u886c\u5e95(B)\u95f4\u5b58\u5728\u8017\u5c3d\u5c42\uff0c\u5c06\u4f1a\u963b\u6b62\u7535\u5b50\u6d41\u52a8\u3002</p> <p>\u5f53\u5728\u95e8\u6781(G)\u4e0e\u886c\u5e95(B)\u95f4\u65bd\u52a0\u6b63\u5411\u7535\u538b\u65f6\uff0c\u57fa\u5e95\u4e2d\u7684\u5c11\u6570\u5b50\u5373\u7535\u5b50\u4f1a\u88ab\u5438\u5f15\u5230\u95e8\u6781(G)\u4fa7\uff0c\u591a\u6570\u5b50\u7a7a\u7a74\u88ab\u5438\u5f15\u5230\u886c\u5e95(B)\u4e00\u4fa7\uff0c\u6b64\u65f6\u4e24\u6781\u4e2d\u95f4\u4f1a\u5f62\u6210\u65b0\u7684\u8017\u5c3d\u66fe\uff0c\u800c\u6e90\u7ea7(S)\u4e0e\u6f0f\u6781(D)\u95f4\u5b58\u5728\u7684\u6e90\u6781(S)\u4e0e\u886c\u5e95(B)\u3001\u6f0f\u6781(D)\u4e0e\u886c\u5e95(B)\u95f4\u7684\u8017\u5c3d\u5c42\u5c06\u88ab\u5438\u5f15\u5230\u95e8\u6781\u7684\u7535\u5b50\u6253\u7834\uff0c\u6b64\u65f6\u7535\u5b50\u4fbf\u53ef\u4ee5\u5728\u6e90\u7ea7\u4e0e\u6f0f\u6781\u95f4\u81ea\u7531\u6d41\u52a8\u4e86\uff0c\u6b64\u65f6MOS\u7ba1\u4fbf\u5bfc\u901a\u4e86\u3002</p> <p>\u6253\u7834\u539f\u6709\u8017\u5c3d\u5c42\u7684\u90e8\u5206\u88ab\u79f0\u4e3a\u6c9f\u9053\uff0c\u6c9f\u9053\u7531\u886c\u5e95\u4e2d\u7535\u5b50\u88ab\u5438\u5f15\u800c\u6765\u5f62\u6210\u7684\u5c31\u53ebN\u6c9f\u9053\uff0c\u53cd\u4e4b\u5c31\u53ebP\u6c9f\u9053\u3002</p>"},{"location":"embedded-dev/fet/#_4","title":"\u7535\u8def\u7b26\u53f7","text":"<p>MOS\u7ba1\u6807\u51c6\u7b26\u53f7\u4e2d\uff0c\u886c\u5e95\u7684\u7bad\u5934\u8868\u793a\u886c\u5e95\u4e2d\u7535\u5b50\u7684\u79fb\u52a8\u65b9\u5411\u3002\u4ece\u4e0a\u8ff0\u7b26\u53f7\u4e2d\u53ef\u4ee5\u770b\u51fa\u65e5\u5e38\u4f7f\u7528\u7684\u666e\u901a\u7c7b\u578b\u7684\u573a\u6548\u5e94\u7ba1\u886c\u5e95(B)\u5e94\u8be5\u662f\u4e0e\u6e90\u6781(S)\u76f8\u8fde\u7684\uff0c\u8fd8\u662f\u4ee5NMOS\u4e3a\u4f8b\uff0c\u4ece\u5176\u5de5\u4f5c\u539f\u7406\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u8981\u60f3\u4f7f\u5176\u5bfc\u901a\uff0c\u9700\u8981\u5728\u95e8\u7ea7(G)\u4e0e\u886c\u5e95(B)\u95f4\u65bd\u52a0\u6b63\u5411\u7535\u573a\uff0c\u5bf9\u5e94\u5230\u6570\u636e\u624b\u518c\u4e2d\u4e3aVgs\u7684\u7535\u538b\u503c\uff0c\u4e3a\u4e00\u4e2a\u5927\u4e8e0\u7684\u503c\u3002</p> <p>\u56e0\u6b64\u5728\u8bbe\u8ba1\u7535\u8def\u65f6\u6211\u4eec\u5c06\u6e90\u7ea7(S)\u63a5\u5730\uff0c\u901a\u8fc7\u63a7\u5236\u95e8\u7ea7(G)\u7684\u9ad8\u4f4e\u7535\u5e73\u53d8\u5316\u4fbf\u53ef\u4ee5\u63a7\u5236NMOS\u7684\u5bfc\u901a\u4e0e\u5173\u65ad\u4e86\u3002</p>"},{"location":"embedded-dev/fet/#_5","title":"\u5e38\u7528\u7535\u8def","text":"<p>USB\u4f9b\u7535\u4e0e\u7535\u6c60\u4f9b\u7535\u5207\u6362\u7535\u8def(PMOS)</p> <p></p> <p>\u7535\u6c60\u7535\u538b\u68c0\u6d4b\u901a\u65ad\u63a7\u5236\u7535\u8def(PMOS)</p> <p></p>"},{"location":"embedded-dev/linux/porting-to-new-soc/","title":"Linux SOC\u7ea7\u5185\u6838\u79fb\u690d\u5b9e\u8df5","text":"<p>Warning</p> <p>\u672c\u6587\u672a\u5b8c\u6210\uff0c\u5df2\u7ec8\u6b62\uff0c\u5185\u5bb9\u4ec5\u4f9b\u53c2\u8003</p> <p>Note</p> <p>\u4e00\u76f4\u4ee5\u6765\u90fd\u60f3\u5b66\u4e60\u5982\u4f55\u5c06Linux\u79fb\u690d\u5230\u4e00\u4e2a\u67b6\u6784\u5df2\u7ecf\u88ab\u652f\u6301\u7684\u65b0SOC\u4e0a\uff0c\u73b0\u5728\u7ec8\u4e8e\u6709\u65f6\u95f4\u6765\u8fdb\u884c\u4e00\u4e9b\u5b9e\u8df5\u7ec3\u4e60\u4e86\uff0c\u8fd9\u4e2a\u7b14\u8bb0\u8bb0\u5f55\u4e86\u6574\u4e2a\u5b9e\u8df5\u8fc7\u7a0b\u4ee5\u53ca\u5728\u79fb\u690d\u8fc7\u7a0b\u4e2d\u8e29\u5230\u7684\u4e00\u4e9b\u5751\u3002\u6211\u53ea\u6709mini2440\u548clicheepi zero\u4e24\u4e2a\u5e73\u53f0\u7684\u5f00\u53d1\u677f\uff0c\u60f3\u6bd4\u8f83\u800c\u8a00\uff0cs3c2440\u7684\u5185\u90e8\u7ed3\u6784\u6bd4\u8f83\u7b80\u5355\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c06s3c2440\u5047\u8bbe\u6210\u4e00\u4e2a\u65b0\u7684SOC\uff0c\u6682\u4e14\u547d\u540d\u4e3afoo\u5427\uff0c\u79fb\u690d\u8fc7\u7a0b\u91c7\u7528\u4e86\u8bbe\u5907\u6811\u7684\u673a\u5236\uff0c\u4e0b\u9762\u5c31\u662f\u6b63\u6587\u4e86\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/#1","title":"1. \u79fb\u690d\u524d\u9700\u8981\u4e86\u89e3\u7684\u4e00\u4e9b\u4fe1\u606f","text":"<p>Linux\u7684\u79fb\u690d\u6709\u4e09\u79cd\u7ea7\u522b\uff1a</p> <ul> <li>\u79fb\u690d\u5230\u4e00\u4e2a\u65b0\u7684\u67b6\u6784\u4e0a</li> <li>\u79fb\u690d\u5230\u4e00\u4e2a\u67b6\u6784\u5df2\u7ecf\u88ab\u652f\u6301\u7684SOC\u4e0a</li> <li>\u79fb\u690d\u5230\u4e00\u4e2a\u65b0\u7684\u677f\u5361\u4e0a</li> </ul> <p>\u67b6\u6784\u7ea7\u522b\u7684\u79fb\u690d\u50cf\u6211\u4eec\u8fd9\u6837\u7684\u666e\u901a\u5f00\u53d1\u8005\u5f88\u96be\u4f1a\u63a5\u89e6\u5230\uff0c\u677f\u5361\u7ea7\u522b\u7684\u79fb\u690d\u7f51\u4e0a\u5df2\u7ecf\u6709\u76f8\u5f53\u591a\u7684\u6587\u6863\u4e86\uff0c\u800cSOC\u7ea7\u522b\u79fb\u690d\u7684\u5de5\u4f5c\u5f80\u5f80\u7531\u82af\u7247\u539f\u5382\u6765\u8fdb\u884c\uff0c\u8fd9\u6b21\u7684\u79fb\u690d\u8fc7\u7a0b\u5c31\u5927\u91cf\u53c2\u8003\u4e86\u5185\u6838\u4e2d\u4e0d\u540c\u5382\u5546\u7684\u4ee3\u7801\u3002</p> <p>\u90a3\u4e48\uff0c\u8981\u8ba9linux\u8fd0\u884c\u5728\u4e00\u4e2a\u65b0\u7684SOC\u4e0a\u9700\u8981\u505a\u54ea\u4e9b\u5de5\u4f5c\u5462\uff0c\u6211\u5728\u7f51\u4e0a\u627e\u5230\u4e86\u4e24\u7bc7\u6587\u6863\uff1a</p> <ul> <li>arm-soc-checklist.pdf</li> <li>porting-linux-to-a-new-soc.pdf</li> </ul> <p>\u4ece\u6587\u6863\u4e2d\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u5230\uff0c\u7531\u4e8eSOC\u91c7\u7528\u7684\u67b6\u6784\u5df2\u7ecf\u88ablinux\u652f\u6301\uff0c\u8fd9\u610f\u5473\u7740\u5185\u5b58\u7ba1\u7406\u90e8\u5206\u5df2\u7ecf\u662f\u53ef\u7528\u7684\uff0c\u8981\u8ba9linux\u8fd0\u884c\u8d77\u6765\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0\u4e2d\u65ad\u63a7\u5236\u5668\u9a71\u52a8\u3001\u5b9a\u65f6\u5668\u9a71\u52a8\u3001\u4e32\u53e3\u9a71\u52a8\u8fd9\u4e09\u90e8\u5206\u3002\u5f53\u7136\u5b9e\u73b0\u8fd9\u4e9b\u9a71\u52a8\u53ea\u662f\u6700\u57fa\u7840\u7684\u90e8\u5206\uff0c\u8981\u8ba9\u5404\u4e2a\u5916\u8bbe\u6b63\u5e38\u8fd0\u884c\u8fd8\u9700\u8981\u5927\u91cf\u7684\u9a71\u52a8\u5f00\u53d1\u5de5\u4f5c\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/#2","title":"2. \u642d\u5efa\u7f16\u8bd1\u6846\u67b6","text":"<p>\u7f16\u8bd1\u6846\u67b6\u90e8\u5206\u7684\u642d\u5efa\u53c2\u8003\u4e86mach-mxs\u5e73\u53f0\u7684\u4ee3\u7801</p> <ol> <li>\u5728arch/arm/\u4e0b\u65b0\u5efamach-foo\u76ee\u5f55\uff0c\u5728\u8be5\u76ee\u5f55\u4e0b\u65b0\u5efaKconfig\u3001Makfile\u3001mach-foo.c\u6587\u4ef6\uff0c\u4fee\u6539\u540e\u7684\u76ee\u5f55\u6811\u5982\u4e0b\uff1a</li> </ol> <pre><code>arch/arm/mach-foo\n\u251c\u2500\u2500 Kconfig\n\u251c\u2500\u2500 mach-foo.c\n\u2514\u2500\u2500 Makefile\n</code></pre> <ol> <li>\u4fee\u6539mach-foo\u4e2d\u7684\u4e09\u4e2a\u6587\u4ef6\uff0c\u5206\u522b\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff1a</li> </ol> <pre><code>/* mach-foo.c */\n#include &lt;linux/io.h&gt;\n#include &lt;linux/compiler.h&gt;\n\n#include &lt;asm/mach/arch.h&gt;\n\nstatic void __init foo_machine_init(void)\n{\n}\n\nstatic const __initconst char *const foo_dt_compat[] = {\n\"none,foo\",\nNULL,\n};\n\nDT_MACHINE_START(foo, \"mach-foo(DT)\")\n.init_machine   = foo_machine_init,\n.dt_compat  = foo_dt_compat,\nMACHINE_END\n</code></pre> <pre><code>#Makefile\nobj-$(CONFIG_ARCH_FOO) += mach-foo.o\n</code></pre> <pre><code>#Kconfig\nconfig ARCH_FOO\n    bool \"foo(actually s3c2440) SOC support\"\ndepends on ARCH_MULTI_V4T\n    select CPU_ARM920T\n    select GPIOLIB\n    select PINCTRL\n    select SOC_BUS\n    help\nSupport for my test project.\n</code></pre> <p>\u8fd9\u91cc\u7684\u4fee\u6539\u53c2\u8003\u4e86mach-mxs\u4e2d\u7684\u4ee3\u7801\uff0cCPU_ARM920T\u8fd9\u4e2a\u5b8f\u7528\u6765\u5b9a\u4e49CPU\u7684\u7c7b\u578b\uff0c\u5185\u6838\u4e00\u5f00\u59cb\u68c0\u6d4bCPU\u662f\u5426\u5339\u914d\u4e5f\u662f\u901a\u8fc7\u8fd9\u4e2a\u5b8f\u6765\u9009\u62e9CPU\u578b\u53f7\u7684\uff0c\u5177\u4f53\u4fe1\u606f\u53ef\u4ee5\u4ece\u8fd9\u91cc\u67e5\u770b\u3002Kconfig\u4e2d\u5176\u4f59\u7684\u9009\u9879\u90fd\u662f\u76f4\u63a5\u4ecemach-foo\u76ee\u5f55\u4e0b\u6284\u6765\u7684\uff0c\u6682\u65f6\u53ef\u4ee5\u4e0d\u7528\u7406\u4f1a\uff0c\u4e0d\u8fc7\u8fd9\u4e2aSOC_BUS\u540e\u9762\u53ef\u80fd\u4f1a\u7528\u5230\uff0c\u4e5f\u662f\u4e00\u4e2a\u6bd4\u8f83\u6709\u8da3\u7684\u7279\u6027\uff0c\u53ef\u4ee5\u4ece\u8fd9\u91cc\u67e5\u770b\u7ec6\u8282\u3002</p> <ol> <li>\u4fee\u6539\u4e0a\u7ea7\u76ee\u5f55(arch/arm)\u4e2d\u7684Kconfig\u3001Makefile\uff0c\u4e3b\u8981\u4fee\u6539\u5982\u4e0b\uff1a</li> </ol> <pre><code>#arch/arm/Kconfig\nsource \"arch/arm/mach-foo/Kconfig\"\n</code></pre> <pre><code>#arch/arm/Makefile\nmachine-$(CONFIG_ARCH_FOO)      += foo\n</code></pre> <p>\u89c2\u5bdf\u8fd9\u4e24\u4e2a\u6587\u4ef6\u91cc\u9762\u7684\u539f\u59cb\u5185\u5bb9\u53ef\u4ee5\u53d1\u73b0\u662f\u6309\u7167\u82f1\u6587\u5b57\u6bcd\u987a\u5e8f\u6765\u6392\u5e8f\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u6dfb\u52a0\u8fd9\u4e24\u5904\u7684\u65f6\u5019\u4e5f\u8981\u9075\u5faa\u8fd9\u4e2a\u89c4\u5219\uff0c\u8fd9\u91cc\u7684CONFIG_ARCH_FOO\u662f\u65b0\u6dfb\u52a0\u7684SOC\u7684\u5b8f\uff0c\u5bf9\u5e94\u7b2c2\u6b65\u4e2dKconfig\u4e2d\u7684\u5185\u5bb9\u3002</p> <ol> <li>\u5728arch/arm/boot/dts\u4e2d\u65b0\u5efa\u4e24\u4e2a\u6587\u4ef6foo.dtsi\u548cfoo-evk.dts\uff0c\u5e76\u5728\u91cc\u9762\u586b\u5145\u9002\u5f53\u7684\u5185\u5bb9\uff0c\u5176\u4e2d\u7684cpus\u8282\u70b9\u548cmemory\u8282\u70b9\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u6765\u586b\u5199</li> </ol> <pre><code>/* foo.dtsi */\n#include \"skeleton.dtsi\"\n\n#include &lt;dt-bindings/gpio/gpio.h&gt;\n#include &lt;dt-bindings/interrupt-controller/irq.h&gt;\n\n/ {\nmodel = \"foo SOC\";\ncompatible = \"none,foo\";\n\ncpus {\n#address-cells = &lt;0&gt;;\n#size-cells = &lt;0&gt;;\n\ncpu {\ncompatible = \"arm,arm920t\";\n};\n};\n};\n</code></pre> <pre><code>/* foo-evk.dts */\n/dts-v1/;\n#include \"foo.dtsi\"\n\n/ {\nmodel = \"foo board\";\ncompatible = \"none,foo\";\n\nmemory {\nreg = &lt;0x30000000 0x04000000&gt;;\n};\n};\n</code></pre> <p>\u4fee\u6539arch/arm/boot/dts/Makefile,\u589e\u52a0\u8bbe\u5907\u6811\u7684\u7f16\u8bd1\u9009\u9879</p> <pre><code>#arch/arm/boot/dts/Makefile\ndtb-$(CONFIG_ARCH_FOO) += \\\nfoo-evk.dtb\n</code></pre> <ol> <li>\u62f7\u8d1dmxs_defconfig\u5230foo_defconfig\u4f5c\u4e3a\u6211\u4eec\u7684\u9ed8\u8ba4\u914d\u7f6e\u6a21\u677f\uff0c\u7136\u540e\u6267\u884cmake menuconfig\u9009\u62e9\u6211\u4eec\u4e0a\u9762\u6dfb\u52a0\u7684\u914d\u7f6e\uff0c\u5e76\u9002\u5f53\u7684\u5220\u51cf\u4e00\u4e9b\u76ee\u524d\u7528\u4e0d\u5230\u7684\u9a71\u52a8\uff0c\u51cf\u5c11\u7f16\u8bd1\u65f6\u95f4\u3002</li> </ol> <p>\u6700\u540e\u6267\u884c\u7f16\u8bd1\uff0c\u5982\u679czImage\u548cdtb\u90fd\u80fd\u6b63\u786e\u751f\u6210\u7684\u8bdd\u5c31\u53ef\u4ee5\u628a\u5f53\u524d\u7684.config\u4fdd\u5b58\u6210foo_defconfig\u4e86\uff0c\u5177\u4f53\u7684\u4fdd\u5b58\u6b65\u9aa4\u53ef\u4ee5\u4ece\u8fd9\u91cc\u67e5\u770b\u3002</p> <p>\u4e0a\u8ff0\u4fee\u6539\u53ef\u4ee5\u53c2\u8003\u8fd9\u4e2a\u8865\u4e01\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/#3-earlycon","title":"3. \u5b9e\u73b0earlycon\u9a71\u52a8","text":"<p>\u6b64\u90e8\u5206\u7684\u4fee\u6539\u53c2\u8003\u4e86X-012-KERNEL-serial early console\u7684\u79fb\u690d\u3001Linux earlycon made life easy\u3001kernel-parameters.txt\u4ee5\u53ca\u5185\u6838\u4e2d\u5176\u4ed6SOC\u7684\u5b9e\u73b0\u3002</p> <p>\u5728\u6b63\u5f0f\u7684\u4e32\u53e3\u9a71\u52a8\u53ef\u7528\u4e4b\u524d\u547d\u4ee4\u884c\u53c2\u6570\u6307\u5b9a\u7684\u7ec8\u7aef\u662f\u65e0\u6cd5\u8f93\u51fa\u4efb\u4f55\u4fe1\u606f\u7684\uff0c\u4e3a\u6b64Linux\u63d0\u4f9b\u4e86\u4e24\u79cd\u673a\u5236\u6765\u8fdb\u884c\u65e9\u671f\u7684log\u8f93\u51fa\uff0c\u5206\u522b\u662fearly_printk\u548cearlycon\uff0c\u4ece\u7f51\u4e0a\u7684\u79cd\u79cd\u8bf4\u6cd5\u6765\u770b\uff0cearlycon\u662f\u4e00\u79cd\u66f4\u597d\u3001\u66f4\u4f18\u96c5\u7684\u65b9\u5f0f\uff0c\u6240\u4ee5\u8fd9\u91cc\u91c7\u7528earlycon\u4f5c\u4e3a\u6211\u4eec\u65e9\u671flog\u6253\u5370\u7684\u65b9\u5f0f\u3002</p> <p>\u5728u-boot\u4e2d\u4e32\u53e3\u5df2\u7ecf\u521d\u59cb\u5316\u8fc7\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e32\u53e3\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u53c2\u8003X-012-KERNEL-serial early console\u7684\u79fb\u690d\uff0c\u5728drivers/tty/serial/\u4e0b\u65b0\u5efafoo-serial.c\uff0c\u5e76\u586b\u5145\u4e0b\u9762\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u4e0d\u540c\u7684\u5730\u65b9\u662f\u501f\u52a9earlycon\u7684\u6846\u67b6\u6765\u6620\u5c04\u7684\u5185\u5b58\uff0c\u6ca1\u6709\u624b\u52a8\u8fdb\u884c\u5185\u5b58\u6620\u5c04\u3002</p> <pre><code>/* drivers/tty/serial/foo-serial.c */\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/console.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;linux/serial_core.h&gt;\n\n#include &lt;asm/io.h&gt;\n#include &lt;asm/early_ioremap.h&gt;\n\n#define UART_UTRSTAT    (0x10)\n#define UART_UTXH   (0x20)\n\nstatic void foo_serial_putc(struct uart_port *port, int ch)\n{\nwhile (!(readl(port-&gt;membase + UART_UTRSTAT) &amp; 0x2));\nwriteb(ch, port-&gt;membase + UART_UTXH);\n}\n\nstatic void earlycon_foo_write(struct console *con, const char *s, unsigned n)\n{\nstruct earlycon_device *dev = con-&gt;data;\n\nuart_console_write(&amp;dev-&gt;port, s, n, foo_serial_putc);\n}\n\nint __init earlycon_foo_setup(struct earlycon_device *dev, const char *opt)\n{\nif (!dev-&gt;port.membase)\nreturn -ENODEV;\n\ndev-&gt;con-&gt;write = earlycon_foo_write;\nreturn 0;\n}\nEARLYCON_DECLARE(foo_serial, earlycon_foo_setup);\n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528\u8bbe\u5907\u6811\u6765\u4f20\u9012earlycon\u9700\u8981\u7684\u53c2\u6570\uff0c\u6240\u4ee5\u5728foo-evk.dts\u4e2d\u6dfb\u52a0\u4e0b\u9762\u7684\u5185\u5bb9\uff0c\u6ce8\u610f\u8fd9\u91cc\u6dfb\u52a0\u4e86\u7528\u4e8e\u6620\u5c04\u7684\u5730\u5740\uff0cearlycon\u9ed8\u8ba4\u4f1a\u6620\u5c0464\u5b57\u8282\u5927\u5c0f\u7684\u7a7a\u95f4</p> <pre><code>    chosen {\nbootargs = \"earlycon=foo_serial,0x50000000 console=ttyS0\";\n};\n</code></pre> <p>\u8fd9\u91cc\u4e4b\u6240\u4ee5\u6dfb\u52a0\u4e86\u4e00\u4e2a\u989d\u5916\u7684console\u53c2\u6570\u662f\u56e0\u4e3a\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u53c2\u6570\u7684\u8bdd\u5185\u6838\u4f1a\u5f88\u5feb\u7684\u5207\u6362\u5230\u9ed8\u8ba4console(tty0)\u4e0a\uff0c\u4e4b\u540e\u6240\u6709\u7684\u542f\u52a8\u65e5\u5fd7\u4fbf\u770b\u4e0d\u5230\u4e86\uff0c\u4f46\u6211\u4eec\u5e76\u4e0d\u60f3\u8fd9\u6837\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u4e00\u4e2a\u975e\u9ed8\u8ba4\u7684console\u8bbe\u5907\u3002</p> <p>\u53c2\u8003\u5176\u4f59\u5382\u5546\u9a71\u52a8\u5bf9Makefile\u548cKconfig\u8fdb\u884c\u4fee\u6539\uff0c\u5e76\u901a\u8fc7menuconfig\u914d\u7f6e\u652f\u6301printk\u7684\u8f93\u51fa,\u9700\u8981\u4f7f\u80fd\u4e0b\u9762\u8fd9\u4e2a\u9009\u9879</p> <pre><code>General setup  ---&gt;\n[*] Configure standard kernel features (expert users)  ---&gt;\n</code></pre> <p>\u4e00\u5207\u987a\u5229\u7684\u8bdd\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e32\u53e3\u770b\u5230kernel\u7684\u542f\u52a8\u8fc7\u7a0b\u4e86\uff0c\u6b64\u90e8\u5206\u4fee\u6539\u53ef\u4ee5\u53c2\u8003\u8fd9\u4e2a\u8865\u4e01\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/#4-irqchip","title":"4. \u5b9e\u73b0irqchip\u9a71\u52a8","text":"<p>\u5f88\u591a\u7684\u9a71\u52a8\u90fd\u4f9d\u8d56\u4e8e\u4e2d\u65ad\uff0c\u6bd4\u5982\u5b9a\u65f6\u5668\uff0c\u800c\u5b9a\u65f6\u5668\u9a71\u52a8\u662f\u5185\u6838\u5fc5\u987b\u7684\uff0c\u6240\u4ee5\u4e2d\u65ad\u7684\u9a71\u52a8\u662f\u5fc5\u987b\u7684\uff0c\u8fd9\u91ccirqchip\u9a71\u52a8\u7684\u5b9e\u73b0\u53c2\u8003\u4e86irq-lpc32xx.c\u3001irq-mxs.c\u3001\u4e09\u661f\u7684\u9a71\u52a8\u4ee3\u7801\u4ee5\u53ca\u8702\u7a9d\u79d1\u6280\u8bba\u575b\u7684\u6587\u7ae0\u3002</p> <p>\u53d7\u76ca\u4e8e\u5185\u6838\u6846\u67b6\u7684\u5de7\u5999\uff0c\u5927\u90e8\u5206\u65f6\u5019\u6211\u4eec\u4e0d\u9700\u8981\u5bf9\u5177\u4f53\u7ec6\u8282\u8fdb\u884c\u4e86\u89e3\u4e5f\u53ef\u4ee5\u5f00\u53d1\u51fa\u6b63\u5e38\u5de5\u4f5c\u7684\u9a71\u52a8\u4ee3\u7801\u3002\u5185\u6838\u9a71\u52a8\u5f00\u53d1\u5f88\u591a\u65f6\u5019\u5c31\u662f\u5c06\u4e00\u4e2a\u8bbe\u5907\u8fdb\u884c\u62bd\u8c61\uff0c\u7136\u540e\u586b\u5145\u5230\u5185\u6838\u63d0\u4f9b\u7684\u6846\u67b6\u4e2d\u53bb\u3002</p> <p>\u4e2d\u65ad\u5b50\u7cfb\u7edf-\u8702\u7a9d\u79d1\u6280\u7cfb\u5217\u6587\u7ae0\u5bf9linux\u4e2d\u65ad\u5b50\u7cfb\u7edf\u8fdb\u884c\u4e86\u5f88\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u4ece\u8fd9\u4e9b\u6587\u7ae0\u4e2d\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u5230\u5f88\u591a\u7ec6\u8282\uff0c\u4f46\u662f\u672c\u6b21\u79fb\u690d\u4e3b\u8981\u662f\u53c2\u8003\u4e86\u5185\u6838\u4e2d\u4e00\u4e9b\u5382\u5546\u7684\u4ee3\u7801\u3002</p> <p>s3c2440\u7684\u4e2d\u65ad\u63a7\u5236\u5668\u5c06\u4e2d\u65ad\u6e90\u5206\u4e3a\u4e86main\u548csub\u4e24\u79cd\uff0c\u8981\u60f3\u81ea\u5df1\u5199\u4e00\u4efd\u9a71\u52a8\uff0c\u5148\u8bfb\u4e00\u4e0b\u4e09\u661f\u63d0\u4f9b\u7684\u9a71\u52a8\u518d\u4e0a\u624b\u4e5f\u4e0d\u8fdf\u3002\u5382\u5546\u9a71\u52a8\u603b\u662f\u4f1a\u4e00\u4efd\u9a71\u52a8\u517c\u5bb9\u591a\u6b3eSOC\uff0c\u6709\u65f6\u4f1a\u4e3a\u6211\u4eec\u9605\u8bfb\u4ee3\u7801\u5e26\u6765\u4e00\u4e9b\u969c\u788d\u3002\u8fd9\u91cc\u5bf9\u6bd4\u9605\u8bfb\u4e86\u4e0a\u9762\u63d0\u5230\u7684\u51e0\u4efd\u4ee3\u7801\uff0c\u53c8\u8003\u8651\u5230s3c3440\u4e2d\u65ad\u63a7\u5236\u5668\u7684\u8bbe\u8ba1\uff0c\u6700\u540e\u51b3\u5b9a\u53c2\u7167irq-lpc32xx.c\u4e2d\u7684\u5b9e\u73b0\u65b9\u5f0f\u6765\u7f16\u5199foo\u7684irqchip\u9a71\u52a8\u3002</p> <p>\u7531\u4e8e\u79fb\u690d\u8fc7\u7a0b\u6bd4\u8f83\u590d\u6742\uff0c\u4e14\u5e76\u4e0d\u901a\u7528\uff0c\u4f46\u662f\u6574\u4f53\u601d\u60f3\u662f\u4e00\u81f4\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u662f\u7b80\u8981\u4ecb\u7ecd\u4e00\u4e0b\u79fb\u690d\u7684\u6d41\u7a0b\u3002</p> <p>\u9996\u5148\u5c06\u62bd\u8c61\u597d\u7684\u4e2d\u65ad\u63a7\u5236\u5668\u5728\u8bbe\u5907\u6811\u4e2d\u8fdb\u884c\u63cf\u8ff0\uff0c\u4e0b\u9762\u662f\u6211\u81ea\u5df1\u5bf92440\u4e2d\u65ad\u63a7\u5236\u5668\u7684\u63cf\u8ff0</p> <pre><code>    mic: mic@4a000000 {\ncompatible = \"foo,foo-mic\";\nreg = &lt;0x4a000000 0x20&gt;;\ninterrupt-controller;\n#interrupt-cells = &lt;2&gt;;\n};\n\nsic: sic@4a000000 {\ncompatible = \"foo,foo-sic\";\nreg = &lt;0x4a000000 0x20&gt;;\ninterrupt-controller;\n#interrupt-cells = &lt;2&gt;;\n\ninterrupt-parent = &lt;&amp;mic&gt;;\ninterrupts = &lt;6 IRQ_TYPE_LEVEL_LOW&gt;,\n&lt;9 IRQ_TYPE_LEVEL_LOW&gt;,\n&lt;15 IRQ_TYPE_LEVEL_LOW&gt;,\n&lt;16 IRQ_TYPE_LEVEL_LOW&gt;,\n&lt;23 IRQ_TYPE_LEVEL_LOW&gt;,\n&lt;28 IRQ_TYPE_LEVEL_LOW&gt;,\n&lt;31 IRQ_TYPE_LEVEL_LOW&gt;;\n};\n</code></pre> <p>\u8bbe\u5907\u6811\u62bd\u8c61\u597d\u4e4b\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u7f16\u5199\u9a71\u52a8\u6587\u4ef6\u4e86\uff0c\u5728drivers/irqchip\u4e2d\u65b0\u5efairq-foo.c\u6587\u4ef6\uff0c\u5e76\u4fee\u6539Makefile\u3002\u7136\u540e\u5728\u6587\u4ef6\u4e2d\u4f7f\u7528IRQCHIP_DECLARE\u5b8f\u5b9a\u4e49\u4e00\u4e2a\u521d\u59cb\u5316\u51fd\u6570\uff0c\u5728\u8fd9\u4e2a\u521d\u59cb\u5316\u51fd\u6570\u91cc\u4e3b\u8981\u5b8c\u6210\u7684\u5de5\u4f5c\u6709</p> <ul> <li>\u5bc4\u5b58\u5668\u5730\u5740\u7684\u6620\u5c04</li> <li>irq_domain\u7684\u6dfb\u52a0\u53ca\u8be5domain\u5bf9\u5e94\u7684ops(\u4e3b\u8981\u662fmap\u548cxlate)\u7684\u5b9e\u73b0</li> <li>\u8bbe\u7f6eirq_chip\u7684mask/unmask/ack\u7b49\u56de\u8c03\uff0c\u8fd9\u4e2a\u662f\u548c\u5177\u4f53\u4e2d\u65ad\u63a7\u5236\u5668\u76f8\u5173\u7684</li> <li>\u8bbe\u7f6eirq\u7684handle</li> <li>\u8bbe\u7f6echained\u7c7b\u578b\u7684handle\u548cdata(\u8fd9\u4e00\u6b65\u4e0d\u540c\u7684\u4e2d\u65ad\u63a7\u5236\u5668\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u6709\u7684\u4e0d\u9700\u8981)</li> </ul> <p>\u5b9e\u73b0\u9a71\u52a8\u7684\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u8fd8\u4f1a\u9700\u8981\u7ef4\u62a4\u4e00\u4e9b\u9a71\u52a8\u79c1\u6709\u7684\u6570\u636e\u7ed3\u6784\u4ee5\u4fbf\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\uff0c\u5728\u8fd9\u91cc\u5c31\u7ef4\u62a4\u4e86\u4e00\u4efdmic\u5bf9\u5e94\u7684sic\u7684sub_bits\u6570\u636e\uff0c\u4ee5\u4fbf\u5728mask/unmask\u7684\u65f6\u5019\u505a\u4e00\u4e9b\u5224\u65ad\uff0c\u8fd9\u90e8\u5206\u53c2\u8003\u4e86\u4e09\u661f\u9a71\u52a8\u4e2d\u7684\u505a\u6cd5\u3002</p> <p>irqchip\u7684\u9a71\u52a8\u79fb\u690d\u5230\u8fd9\u91cc\u5c31\u7ed3\u675f\u4e86\uff0c\u7ecf\u8fc7\u6d4b\u8bd5mic\u662f\u53ef\u4ee5\u6b63\u5e38\u7684\u5de5\u4f5c\u7684\uff0c\u800csic\u8fd8\u6ca1\u6709\u6d4b\u8bd5\uff0c\u540e\u7eed\u7f16\u5199\u4e32\u53e3\u9a71\u52a8\u7684\u65f6\u5019\u4fbf\u4f1a\u7528\u5230sic\u4e86\uff0c\u5230\u65f6\u5019\u518d\u770bsic\u80fd\u5426\u6b63\u5e38\u5de5\u4f5c\u3002\u6574\u4e2a\u79fb\u690d\u8fc7\u7a0b\u4e2d\u53c2\u8003\u4e86\u4e09\u661f\u63d0\u4f9b\u7684\u9a71\u52a8\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u5382\u5546\u7684\u9a71\u52a8\uff0c\u591a\u8bfb\u4e00\u8bfb\u8fd9\u4e9b\u4ee3\u7801\u4fbf\u53ef\u4ee5\u719f\u6089\u9a71\u52a8\u7f16\u5199\u7684\u6d41\u7a0b\u4e86\uff0c\u4e0a\u8ff0\u6539\u52a8\u5185\u5bb9\u90fd\u5728\u8fd9\u4e2a\u8865\u4e01\u4e2d\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/#5-clk","title":"5. \u5b9e\u73b0clk\u9a71\u52a8","text":"<p>\u8fd9\u90e8\u5206\u9a71\u52a8\u7684\u7f16\u5199\u53c2\u8003\u4e86\u4e09\u661f\u63d0\u4f9b\u7684\u9a71\u52a8\u548c\u5168\u5fd7\u7684simple-gates\u9a71\u52a8\u3002</p> <p>clk\u9a71\u52a8\u5c5e\u4e8e\u7535\u6e90\u7ba1\u7406\u5b50\u7cfb\u7edf\u7684\u4e00\u90e8\u5206,\u4e3b\u8981\u529f\u80fd\u662f\u5b9e\u73b0soc\u5185\u90e8\u5404\u6a21\u5757\u548c\u5916\u8bbe\u7684\u65f6\u949f\u7ba1\u7406,\u7f16\u5199\u8fd9\u4e00\u90e8\u5206\u9a71\u52a8\u7684\u65f6\u5019\u9700\u8981\u5bf9CCF(Common Clock Framework)\u6709\u4e9b\u7b80\u5355\u7684\u4e86\u89e3,\u8fd9\u90e8\u5206\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003\u7535\u6e90\u7ba1\u7406\u5b50\u7cfb\u7edf-\u8702\u7a9d\u79d1\u6280\u3002</p> <p>\u7531\u4e8e\u5bf9clock\u5404\u4e2a\u90e8\u5206\u8fdb\u884c\u5206\u7c7b\u6bd4\u8f83\u590d\u6742\uff0c\u51b5\u4e14\u8fd9\u91cc\u4e5f\u4e0d\u9700\u8981\u7279\u522b\u590d\u6742\u7684\u65f6\u949f\u7ba1\u7406\u529f\u80fd\uff0c\u800c\u4e14\u5728u-boot\u4e2d\u5df2\u7ecf\u5c06fclk\u3001hclk\u548cpclk\u521d\u59cb\u5316\u597d\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u7b80\u5355\u7c97\u66b4\u5c06fclk\u3001hclk\u548cpclk\u6ce8\u518c\u6210fixed rate clock\uff0c\u5185\u6838fixed rate\u76f8\u5173\u7684\u90e8\u5206\u4f1a\u81ea\u52a8\u4e3a\u6211\u4eec\u6ce8\u518c\u5bf9\u5e94\u7684clock\uff0c\u8bbe\u5907\u6811\u5982\u4e0b\u6240\u793a</p> <pre><code>    clocks {\ncompatible = \"simple-bus\";\n#address-cells = &lt;1&gt;;\n#size-cells = &lt;1&gt;;\n\nxti: xti {\ncompatible = \"fixed-clock\";\nclock-frequency = &lt;12000000&gt;;\nclock-output-names = \"xti\";\n#clock-cells = &lt;0&gt;;\n};\n\nfclk: fclk {\ncompatible = \"fixed-clock\";\nclock-frequency = &lt;400000000&gt;;\nclock-output-names = \"fclk\";\n#clock-cells = &lt;0&gt;;\n};\n\nhclk: hclk {\ncompatible = \"fixed-clock\";\nclock-frequency = &lt;100000000&gt;;\nclock-output-names = \"hclk\";\n#clock-cells = &lt;0&gt;;\n};\n\npclk: pclk {\ncompatible = \"fixed-clock\";\nclock-frequency = &lt;50000000&gt;;\nclock-output-names = \"pclk\";\n#clock-cells = &lt;0&gt;;\n};\n};\n</code></pre> <p>\u7136\u540e\u53c2\u8003\u5168\u5fd7\u7684simple-gates\u9a71\u52a8\u7f16\u5199\u6211\u4eec\u7684gates\u8bbe\u5907\u6811\u53ca\u9a71\u52a8\uff0c\u8bbe\u5907\u6811\u5982\u4e0b\u6240\u793a</p> <pre><code>    clk: clock-controller@0x4c000000 {\ncompatible = \"foo,foo-clock\";\nreg = &lt;0x4c000000 0x40&gt;;\n#clock-cells = &lt;1&gt;;\n\nclock-indices = &lt;4&gt;, &lt;5&gt;, &lt;6&gt;, &lt;7&gt;, &lt;8&gt;, &lt;9&gt;, &lt;10&gt;,&lt;11&gt;,\n&lt;12&gt;, &lt;13&gt;, &lt;14&gt;, &lt;15&gt;,\n&lt;16&gt;, &lt;17&gt;, &lt;18&gt;, &lt;19&gt;,\n&lt;20&gt;;\nclock-parent-names = \"hclk\",\"hclk\",\"hclk\",\"pclk\",\n\"pclk\",\"pclk\",\"pclk\",\"pclk\",\n\"pclk\",\"pclk\",\"pclk\",\"pclk\",\n\"pclk\",\"pclk\",\"pclk\",\"hclk\",\n\"pclk\";\nclock-gates-names = \"nand\", \"lcdc\", \"usb-host\", \"usb-device\",\n\"timer\", \"sdi\", \"uart0\", \"uart1\",\n\"uart2\", \"gpio\", \"rtc\", \"adc\",\n\"iic\", \"iis\", \"spi\", \"camera\",\n\"ac97\";\n};\n</code></pre> <p>\u5177\u4f53\u7684\u4ee3\u7801\u53ef\u4ee5\u67e5\u770b\u8fd9\u4e2a\u8865\u4e01\u3002</p> <p>\u8fd9\u91cc\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff0c\u5982\u679c\u67d0\u4e2a\u5916\u8bbe\u7684\u65f6\u949f\u5728\u6ce8\u518cgate\u4e4b\u524d\u662f\u5f00\u7740\u7684\uff0c\u90a3\u4e48\u4e00\u5b9a\u8981\u5728\u6ce8\u518c\u5b8cgate\u4e4b\u540e\u901a\u8fc7\u5185\u6838\u63a5\u53e3\u4f7f\u80fd\u4e00\u4e0b\u8be5\u65f6\u949f\uff0c\u4ee3\u7801\u91cc\u7684foo_critical_clocks\u5c31\u662f\u8d77\u8fd9\u4e2a\u4f5c\u7528\u7684\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u5728initcall\u9636\u6bb5\u8c03\u7528clk_disable_unused\u65f6\u5bfc\u81f4\u963b\u585e\uff0c\u6211\u731c\u6d4b\u8fd9\u91cc\u963b\u585e\u53ef\u80fd\u662f\u56e0\u4e3a\u72b6\u6001\u4e0d\u4e00\u81f4\u5bfc\u81f4\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7initcall_debug\u6765\u8c03\u8bd5initcall\u7684\u6267\u884c\uff0c\u53ef\u4ee5\u4ece\u8fd9\u91cc\u4e86\u89e3\u7ec6\u8282\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/#6-timekeeping","title":"6. \u5b9e\u73b0timekeeping\u9a71\u52a8","text":"<p>\u6700\u5f00\u59cb\u770b\u4e09\u661f\u63d0\u4f9b\u7684pwm timer\u9a71\u52a8\u65f6\u6709\u70b9\u61f5\uff0c\u4e09\u661f\u7684\u9a71\u52a8\u5e94\u8be5\u662f\u4f7f\u7528\u540c\u4e00\u4e2a\u5b9a\u65f6\u5668\u65e2\u4f5c\u4e3aclocksource\u53c8\u4f5c\u4e3aclcokevent\uff0c\u4ece\u4ed6\u4eec\u7684\u529f\u80fd\u5206\u7c7b\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4fe9\u6309\u9053\u7406\u5e94\u8be5\u4f7f\u7528\u4e0d\u540c\u5b9a\u65f6\u5668\uff0c\u8fd9\u7bc7\u535a\u5ba2\u5bf9time\u90e8\u5206\u505a\u4e86\u6bd4\u8f83\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u91cc\u9762\u4e5f\u63d0\u5230\u4e86\u8fd9\u4e24\u4e2a\u529f\u80fd\u5e94\u8be5\u662f\u7531\u4e24\u4e2a\u786c\u4ef6\u90e8\u5206\u6765\u5b9e\u73b0\u7684\u3002\u6240\u4ee5\u8fd9\u91cc\u7684\u79fb\u690d\u51b3\u5b9a\u91c7\u7528\u4e24\u4e2a\u5b9a\u65f6\u5668\u6765\u5b9e\u73b0\uff0c\u4e00\u4e2a\u63d0\u4f9b\u4e2d\u65ad\uff0c\u800c\u53e6\u4e00\u4e2a\u4e0d\u63d0\u4f9b\u4e2d\u65ad\uff0c\u901a\u8fc7\u8bbe\u5907\u6811\u4e2d\u7684\u4e00\u4e9b\u5b57\u6bb5\u6765\u8fdb\u884c\u533a\u5206\uff0c\u4e0d\u8fc7\u8fd9\u6837\u505a\u4f3c\u4e4e\u4e0d\u662f\u5f88\u4f18\u96c5\uff0c\u4e0d\u8fc7\u8fd8\u662f\u5148\u5b9e\u73b0\u529f\u80fd\u518d\u8bf4\u5427\u3002</p> <p>\u6700\u5f00\u59cb\u5b9e\u73b0\u9a71\u52a8\u7684\u65f6\u5019\u6211\u60f3\u63d0\u9ad8\u4e00\u4e9b\u7cbe\u5ea6\uff0c\u4e8e\u662f\u5c06\u5b9a\u65f6\u5668\u7684\u65f6\u949f\u5206\u9891\u5230\u4e865M\uff0c\u4f46\u5b9e\u9645\u8fd0\u884c\u7684\u65f6\u5019\u53d1\u73b0\u542f\u52a8\u65f6\u5019\u7684\u65f6\u95f4\u6233\u51fa\u73b0\u4e86\u5f88\u4e25\u91cd\u7684\u56de\u7ed5\u73b0\u8c61\uff0c\u8fd9\u90e8\u5206\u65f6\u95f4\u6233\u7684\u6253\u5370\u5e94\u8be5\u662f\u7531sched_clock\u90e8\u5206\u901a\u8fc7\u6211\u4eec\u7528sched_clock_register\u6ce8\u518c\u7684\u8bfb\u51fd\u6570\u6765\u5b9e\u73b0\u7684\uff0c\u4f46\u662fs3c2440\u7684\u5b9a\u65f6\u5668\u53ea\u670916\u4f4d\uff0c\u53ef\u80fd\u662f\u63d0\u9ad8\u5b9a\u65f6\u5668\u9891\u7387\u540e\u6ea2\u51fa\u592a\u5feb\u5bfc\u81f4\u5185\u6838\u8fd8\u6ca1\u6765\u5f97\u53ca\u67e5\u8be2\u5bfc\u81f4\u7684\uff0c\u6240\u4ee5\u6700\u540e\u8fd8\u662f\u5c06\u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\u8c03\u8282\u5230\u4e861M\u3002</p> <p>\u8fd9\u90e8\u5206\u7684\u4fee\u6539\u53ef\u4ee5\u67e5\u770b\u8fd9\u4e2a\u8865\u4e01\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/#7-uart","title":"7. \u5b9e\u73b0uart\u9a71\u52a8","text":"<p>TODO</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/arch-arm/","title":"ARM","text":"<p>\u4e3b\u8981\u8bb0\u5f55\u4e00\u4e9b\u5185\u6838\u4e2darm\u67b6\u6784\u76f8\u5173\u7684\u5185\u5bb9</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/arch-arm/#1","title":"1. \u5904\u7406\u5668\u7c7b\u578b\u68c0\u67e5","text":"<p>__lookup_processor_type \u68c0\u67e5\u5904\u7406\u5668\u662f\u5426\u652f\u6301\uff0c\u5176\u4e2d\u7528\u5230\u4e86 __lookup_processor_type_data \u8fd9\u4e2a\u6570\u636e\uff0c\u6ce8\u91ca\u8bf4\u660e\u4e86\u5b83\u7684\u6570\u636e\u7c7b\u578b\u5b9a\u4e49\u5728 arch/arm/include/asm/procinfo.h \u4e2d\uff0c\u8fdb\u5165\u8fd9\u4e2a\u6587\u4ef6\u4e2d\uff0c\u4ece\u6ce8\u91ca\u6765\u770b\uff0c\u8fd9\u90e8\u5206\u6570\u636e\u662f\u5728 arch/arm/mm/proc-*.S \u4e2d\u5b9a\u4e49\u7684\uff0c\u800c\u8fd9\u4e9b\u6587\u4ef6\u7684\u7f16\u8bd1\u4e0e\u5426\u5219\u4f9d\u8d56\u4e8e\u6211\u4eec\u9009\u62e9\u7684CPU\u7c7b\u578b\uff0cMakefile\u5982\u4e0b</p> <pre><code>obj-$(CONFIG_CPU_ARM7TDMI)  += proc-arm7tdmi.o\nobj-$(CONFIG_CPU_ARM720T)   += proc-arm720.o\nobj-$(CONFIG_CPU_ARM740T)   += proc-arm740.o\nobj-$(CONFIG_CPU_ARM9TDMI)  += proc-arm9tdmi.o\nobj-$(CONFIG_CPU_ARM920T)   += proc-arm920.o\nobj-$(CONFIG_CPU_ARM922T)   += proc-arm922.o\nobj-$(CONFIG_CPU_ARM925T)   += proc-arm925.o\nobj-$(CONFIG_CPU_ARM926T)   += proc-arm926.o\nobj-$(CONFIG_CPU_ARM940T)   += proc-arm940.o\nobj-$(CONFIG_CPU_ARM946E)   += proc-arm946.o\nobj-$(CONFIG_CPU_FA526)     += proc-fa526.o\nobj-$(CONFIG_CPU_ARM1020)   += proc-arm1020.o\nobj-$(CONFIG_CPU_ARM1020E)  += proc-arm1020e.o\nobj-$(CONFIG_CPU_ARM1022)   += proc-arm1022.o\nobj-$(CONFIG_CPU_ARM1026)   += proc-arm1026.o\nobj-$(CONFIG_CPU_SA110)     += proc-sa110.o\nobj-$(CONFIG_CPU_SA1100)    += proc-sa1100.o\nobj-$(CONFIG_CPU_XSCALE)    += proc-xscale.o\nobj-$(CONFIG_CPU_XSC3)      += proc-xsc3.o\nobj-$(CONFIG_CPU_MOHAWK)    += proc-mohawk.o\nobj-$(CONFIG_CPU_FEROCEON)  += proc-feroceon.o\nobj-$(CONFIG_CPU_V6)        += proc-v6.o\nobj-$(CONFIG_CPU_V6K)       += proc-v6.o\nobj-$(CONFIG_CPU_V7)        += proc-v7.o proc-v7-bugs.o\nobj-$(CONFIG_CPU_V7M)       += proc-v7m.o\n</code></pre>"},{"location":"embedded-dev/linux/porting-to-new-soc/arch-arm/#2-text_offset","title":"2. TEXT_OFFSET","text":"<p>TEXT_OFFSET \u5b9a\u4e49\u4e86\u5185\u6838\u955c\u50cf\u76f8\u5bf9\u4e8e\u57fa\u5730\u5740\u7684\u504f\u79fb\uff0c\u8fd9\u91cc\u7684\u57fa\u5730\u5740\uff0c\u65e2\u5305\u62ec\u7269\u7406\u5730\u5740(PHYS_OFFSET)\uff0c\u4e5f\u5305\u62ec\u865a\u62df\u5730\u5740(PAGE_OFFSET)\uff0cTEXT_OFFSET\u5b9a\u4e49\u5728arch/arm/Makefile\u4e2d</p> <p><pre><code>TEXT_OFFSET := $(textofs-y)\n...\ntextofs-y   := 0x00008000\n</code></pre> \u7edd\u5927\u591a\u6570\u7684SOC\u90fd\u4f7f\u7528\u8fd9\u4e2a\u9ed8\u8ba4\u914d\u7f6e\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u52a0\u8f7d\u5185\u6838\u955c\u50cf\u5230\u5185\u5b58\u65f6\u7684\u504f\u79fb\u4e3a8000\u7684\u539f\u56e0\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/bus/","title":"\u603b\u7ebf","text":""},{"location":"embedded-dev/linux/porting-to-new-soc/bus/#1-soc_bus","title":"1. SOC_BUS","text":"<p>\u9605\u8bfb\u4ee3\u7801\u7684\u65f6\u5019\u53d1\u73b0\u4e86CONFIG_SOC_BUS\u8fd9\u4e2a\u914d\u7f6e\u9879\uff0c\u5f00\u542f\u540e\u4f1a\u6dfb\u52a0drivers/base/soc.c\u6587\u4ef6\uff0c\u8fd9\u90e8\u5206\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u4f1a\u6ce8\u518c\u4e00\u4e2a\u540d\u4e3asoc\u7684\u603b\u7ebf\uff0c\u5e76\u5411\u5916\u5bfc\u51fa\u4e86soc_device_register\u51fd\u6570\u3002\u5728soc\u7ea7\u522b\u7684\u79fb\u690d\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u51fd\u6570\u5411soc\u603b\u7ebf\u4e0a\u6ce8\u518c\u4e00\u4e2asoc\u8bbe\u5907\uff0c\u6ce8\u518c\u65f6\u4f20\u5165\u4e00\u4e2astruct soc_device_attribute\u7c7b\u578b\u7684\u7ed3\u6784\u4f53\u53d8\u91cf\u6307\u9488\uff0c\u8fd9\u4e2a\u7ed3\u6784\u4f53\u7684\u58f0\u660e\u5982\u4e0b</p> <pre><code>struct soc_device_attribute {\nconst char *machine;\nconst char *family;\nconst char *revision;\nconst char *soc_id;\n};\n</code></pre> <p>\u6700\u7ec8\u4f1a\u5728sysfs\u4e2d\u751f\u6210SOC\u76f8\u5173\u7684\u4fe1\u606f\u7684\u6587\u4ef6\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/config/","title":"\u914d\u7f6e","text":""},{"location":"embedded-dev/linux/porting-to-new-soc/config/#1","title":"1. \u4fdd\u5b58\u914d\u7f6e","text":"<p>\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u677f\u7ea7\u914d\u7f6e\u65f6\uff0c\u53ef\u4ee5\u9009\u7528\u5df2\u6709\u7684\u6bd4\u8f83\u76f8\u8fd1\u7684\u5176\u4ed6\u677f\u5361\u7684\u914d\u7f6e\uff0c\u901a\u8fc7menuconfig\u8fdb\u884c\u914d\u7f6e\uff0c\u4fee\u6539\u4ee3\u7801\uff0c\u7136\u540e\u901a\u8fc7<code>make savedefconfig</code>\u6765\u751f\u6210\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u76f4\u63a5\u5c06defconfig\u590d\u5236\u4fdd\u5b58\u5373\u53ef\u4f5c\u4e3a\u6211\u4eec\u65b0\u6dfb\u52a0\u7684\u677f\u5361\u7684\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/config/#2-tags","title":"2. tags","text":"<p>\u4f7f\u7528vim\u67e5\u770b\u6e90\u7801\u65f6ctags\u7684\u8df3\u8f6c\u529f\u80fd\u8fd8\u662f\u975e\u5e38\u5b9e\u7528\u7684\uff0c\u5185\u6838\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9009\u9879\u6765\u751f\u6210\u53ea\u5305\u542b\u6307\u5b9a\u67b6\u6784\u7684ctags\u7d22\u5f15\u6587\u4ef6</p> <pre><code>make ARCH=arm tags\n</code></pre>"},{"location":"embedded-dev/linux/porting-to-new-soc/device-tree/","title":"FDT","text":"<p> <p></p> <p>\u5185\u6838\u5bf9\u8bbe\u5907\u6811\u7684\u5904\u7406\u7684\u4e3b\u8981\u6d41\u7a0b</p> <pre><code>start_kernel\n--&gt;setup_arch\n--&gt;setup_machine_fdt                         /* arch/arm/kernel/devtree.c */\n--&gt;early_init_dt_verify\n--&gt;of_flat_dt_match_machine\n--&gt;early_init_dt_scan_nodes\n--&gt;of_scan_flat_dt(early_init_dt_scan_chosen, boot_command_line);\n/* Retrieve various information from the /chosen node */\n--&gt;of_scan_flat_dt(early_init_dt_scan_root, NULL);\n/* Initialize {size,address}-cells info */\n--&gt;of_scan_flat_dt(early_init_dt_scan_memory, NULL);\n/* Setup memory, calling early_init_dt_add_memory_arch */\n--&gt;unflatten_device_tree                              /* drivers/of/fdt.c */\n--&gt;__unflatten_device_tree\n--&gt;unflatten_dt_nodes(blob, NULL, dad, NULL);\n/* First pass, scan for size */\n--&gt;unflatten_dt_nodes(blob, mem, dad, mynodes);\n/* Second pass, do actual unflattening */\n--&gt;rest_init\n--&gt;kernel_thread(kernel_init, NULL, CLONE_FS);\n--&gt;kernel_init\n--&gt;kernel_init_freeable\n--&gt;do_basic_setup\n--&gt;do_initcalls\n--&gt;do_initcall_level\n--&gt;of_platform_default_populate_init /* drivers/of/platform.c */\n--&gt;of_platform_default_populate\n--&gt;of_platform_populate\n--&gt;of_platform_bus_create\n--&gt;...\n</code></pre> <p>\u7b2c\u4e00\u90e8\u5206\u5b8c\u6210\u8bbe\u5907\u6811\u7684\u6241\u5e73\u5316\u5904\u7406\uff1b\u7b2c\u4e8c\u90e8\u5206\u626b\u63cf\u6574\u4e2a\u8bbe\u5907\u6811\uff0c\u5e76\u4e3a\u5176\u4e2d\u7b26\u5408\u8981\u6c42\u7684\u8282\u70b9\u751f\u6210\u5e73\u53f0\u8bbe\u5907\u3002</p> <p>\u7b2c\u4e8c\u90e8\u5206\u4e2d\u7b26\u5408\u8981\u6c42\u7684\u8282\u70b9\u5305\u62ec\u6839\u8282\u70b9\u4e0b\u6709compatible\u5c5e\u6027\u7684\u8282\u70b9\u4ee5\u53cacompatible\u5c5e\u6027\u5339\u914d\u4e0b\u9762\u7ed3\u6784\u4f53\u4e2d\u5c5e\u6027\u7684\u8282\u70b9\u3002</p> <pre><code>const struct of_device_id of_default_bus_match_table[] = {\n{ .compatible = \"simple-bus\", },\n{ .compatible = \"simple-mfd\", },\n{ .compatible = \"isa\", },\n#ifdef CONFIG_ARM_AMBA\n{ .compatible = \"arm,amba-bus\", },\n#endif /* CONFIG_ARM_AMBA */\n{} /* Empty terminated list */\n};\n</code></pre>"},{"location":"embedded-dev/linux/porting-to-new-soc/parameters/","title":"Parameters","text":""},{"location":"embedded-dev/linux/porting-to-new-soc/parameters/#1-earlycon","title":"1. earlycon","text":"<p>earlycon\u5728\u6b63\u5f0f\u7684console\u8bbe\u5907\u53ef\u7528\u4e4b\u524d\u8f93\u51fa\u5185\u6838\u7684\u542f\u52a8\u4fe1\u606f\uff0cearlycon\u9a71\u52a8\u4f1a\u8d1f\u8d23map\u53c2\u6570\u4e2d\u6307\u5b9a\u7684\u5bc4\u5b58\u5668\u5730\u5740\uff0cmap\u957f\u5ea6\u4e3a64\uff0c\u8be6\u7ec6\u7684\u53c2\u6570\u53ef\u4ee5\u53c2\u8003kernel-parameters.txt\u6587\u6863\u3002</p>"},{"location":"embedded-dev/linux/porting-to-new-soc/parameters/#2-initcall_debug","title":"2. initcall_debug","text":"<p>initcall_debug\u7528\u6765\u8ffd\u8e2ainitcall\u8c03\u7528\u7684\u8fdb\u5ea6\uff0c\u6709\u65f6\u5019\u6709\u4e9b\u5f02\u5e38\u60c5\u51b5\u4f1a\u5bfc\u81f4initcall\u4e2d\u7684\u67d0\u4e9b\u90e8\u5206\u963b\u585e\uff0c\u8fd9\u4e2a\u53c2\u6570\u5bf9\u6211\u4eec\u7684\u8c03\u8bd5\u5f88\u6709\u5e2e\u52a9\u3002</p>"},{"location":"embedded-dev/rockchip/rk3128/","title":"RK3128","text":""},{"location":"embedded-dev/rockchip/rk3128/#ec6108v9a","title":"EC6108V9A","text":""},{"location":"embedded-dev/rockchip/rk3128/#_1","title":"\u6551\u7816","text":"<p>\u670b\u53cb\u7ed9\u4e86\u4e00\u4e2a\u534e\u4e3a\u60a6\u76d2EC6108V9A\u7535\u89c6\u76d2\u5b50\uff0c\u91c7\u7528RK3128\u4f5c\u4e3a\u4e3b\u63a7\uff0c\u60f3\u8bd5\u7740\u628a\u5176\u4e2d\u7684\u7cfb\u7edf\u66f4\u6362\u4e3aDebian\uff0c\u8fd9\u6837\u53ef\u73a9\u6027\u66f4\u9ad8\u4e00\u70b9\u3002</p> <p>\u641c\u7d22\u53d1\u73b0Firefly\u63d0\u4f9b\u5b8c\u6574\u7684RK3128 Ubuntu\u955c\u50cf\uff0c\u4e8e\u662f\u4eceFirefly\u63d0\u4f9b\u7684\u8d44\u6e90\u4e2d\u4e0b\u8f7d\u4e86\u9884\u7f16\u8bd1\u597d\u7684Ubuntu\u955c\u50cf\uff0c\u7ed3\u679c\u5b8c\u5168\u65e0\u6cd5\u542f\u52a8\uff0c\u8fdeboot\u8f93\u51fa\u90fd\u6ca1\u6709\uff0c\u53ea\u597d\u4ece\u7f51\u4e0a\u641c\u7d22\u4e86\u4e00\u4e0b\u7ebf\u5237\u5305\uff0c\u5e76\u5c06\u5176\u8fdb\u884c\u4e86\u8fd8\u539f\uff0c\u8fd8\u5728\u7ed3\u679c\u4e0d\u9519\uff0c\u8fd8\u539f\u6210\u529f\u3002\u7ebf\u5237\u6551\u7816\u5305\u53ef\u4ee5\u4ece\u8fd9\u91cc\u4e0b\u8f7d\u3002</p> <p>\u7531\u4e8e\u6b64\u65f6\u76d2\u5b50\u5b8c\u5168\u65e0\u54cd\u5e94\uff0c\u56e0\u6b64\u9700\u8981\u901a\u8fc7\u77ed\u63a5\u70b9\u8ba9\u5176\u8fdb\u5165maskrom\u6a21\u5f0f\u8fdb\u884c\u5237\u673a\uff0c\u77ed\u63a5\u70b9\u5982\u4e0b\u3002</p> <p></p>"},{"location":"embedded-dev/rockchip/rk3128/#uboot","title":"Uboot\u622a\u505c","text":"<p>\u7531\u4e8e\u76d2\u5b50\u7684\u9ed8\u8ba4Uboot\u542f\u52a8\u5ef6\u8fdf\u4e3a0,\u56e0\u6b64\u65e0\u6cd5\u8ba9\u5176\u505c\u5728Uboot\u7684\u547d\u4ee4\u884c\u3002\u89c2\u5bdf\u4e86\u4e00\u4e0b\u6551\u7816\u5305\u89e3\u5305\u540e\u7684Uboot\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u53d1\u73b0\u662f\u88f8\u6587\u4ef6\uff0c\u5e76\u672a\u7ecf\u8fc7\u52a0\u5bc6\u7b49\u76f8\u5173\u64cd\u4f5c\uff0c\u56e0\u6b64\u51b3\u5b9a\u4eceUboot\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5165\u624b\u8fdb\u884c\u5c1d\u8bd5\u3002\u5173\u952e\u6539\u52a8\u90e8\u5206\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p> <p>\u7ecf\u8fc7\u89c2\u5bdf\uff0c\u53d1\u73b0Uboot\u4e8c\u8fdb\u5236\u4e2d\u5b58\u5728\u9ed8\u8ba4\u73af\u5883\u53d8\u91cf<code>bootdelay</code>\uff0c\u4fbf\u5c1d\u8bd5\u4fee\u6539\u8be5\u73af\u5883\u53d8\u91cf\u7684\u503c\u8ba9\u542f\u52a8\u5ef6\u8fdf\u4e0d\u4e3a\u96f6\uff0c\u7ed3\u679c\u5c45\u7136\u4e0d\u751f\u6548\uff0c\u767e\u601d\u4e0d\u5f97\u5176\u89e3\uff0c\u4e8e\u662f\u4ecegithub\u4e2d\u641c\u4e86\u4e00\u4efdrockchip\u7684Uboot\u4ee3\u7801\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u5728\u677f\u7ea7\u521d\u59cb\u5316\u90e8\u5206\u5c45\u7136\u6709\u8c03\u6574\u73af\u5883\u53d8\u91cf\u7684\u64cd\u4f5c\uff0c\u4ee3\u7801\u5982\u4e0b</p> <pre><code>static void board_init_adjust_env(void)\n{\nbool change = false;\n\nchar *s = getenv(\"bootdelay\");\nif (s != NULL) {\nunsigned long bootdelay = 0;\n\nbootdelay = simple_strtoul(s, NULL, 16);\ndebug(\"getenv: bootdelay = %lu\\n\", bootdelay);\n#if (CONFIG_BOOTDELAY &lt;= 0)\nif (bootdelay &gt; 0) {\nsetenv(\"bootdelay\", simple_itoa(0));\nchange = true;\ndebug(\"setenv: bootdelay = 0\\n\");\n}\n#else\nif (bootdelay != CONFIG_BOOTDELAY) {\nsetenv(\"bootdelay\", simple_itoa(CONFIG_BOOTDELAY));\nchange = true;\ndebug(\"setenv: bootdelay = %d\\n\", CONFIG_BOOTDELAY);\n}\n#endif\n}\n</code></pre> <p>\u4e0d\u96be\u770b\u51fa\u4fee\u6539\u7684\u73af\u5883\u53d8\u91cf\u5728\u8fd9\u91cc\u88ab\u8fd8\u539f\u6210\u4e86\u7f16\u8bd1\u65f6\u7684\u503c\uff0c\u56e0\u6b64\u6ca1\u6709\u751f\u6548\u3002</p> <p>\u7ee7\u7eed\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u73af\u5883\u53d8\u91cf\u4e2d\u8fd8\u6709<code>preboot</code>\uff0c\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\u4f1a\u5728\u8fdb\u5165\u547d\u4ee4\u884c\u5faa\u73af\u524d\u88ab\u6267\u884c\uff0c\u6b64\u65f6\u677f\u7ea7\u521d\u59cb\u5316\u90e8\u5206\u5df2\u7ecf\u7ed3\u675f\uff0c\u4e14\u677f\u7ea7\u521d\u59cb\u5316\u90e8\u5206\u4e5f\u672a\u5bf9\u8be5\u73af\u5883\u53d8\u91cf\u8fdb\u884c\u8c03\u6574\uff0c\u56e0\u6b64\u53ef\u4ee5\u501f\u52a9\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\u91cd\u65b0\u8c03\u6574bootdelay\u7684\u503c\u3002\u5bf9\u6b64\u5904\u5185\u5bb9\u8fdb\u884c\u4fee\u6539\uff0c\u4fee\u6539\u524d\u540e\u5bf9\u6bd4\u5982\u4e0b\u3002</p> <p></p> <p>\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\uff0cUboot\u5012\u8ba1\u65f6\u4fbf\u4f1a\u53d8\u4e3a2\u79d2\uff0c\u6b64\u65f6\u4fbf\u53ef\u4ee5\u4e2d\u65ad\u5012\u8ba1\u65f6\uff0c\u4f9b\u6211\u4eec\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u4e86\u3002</p>"},{"location":"embedded-dev/rockchip/rk3128/#debian","title":"\u5f15\u5bfc\u5185\u6838\u53caDebian\u7cfb\u7edf","text":"<p>\u5728\u6210\u529f\u622a\u505cUboot\u540e\uff0c\u53d1\u73b0\u8be5Uboot\u63d0\u4f9b\u7684\u547d\u4ee4\u6781\u5c11\uff0c\u5e76\u6ca1\u6709\u5e38\u89c1\u7684emmc\u8bfb\u53d6\u7b49\u547d\u4ee4\uff0c\u56e0\u6b64\u53ea\u80fd\u501f\u52a9\u539f\u6709\u7684bootrk\u547d\u4ee4\u6765\u5f15\u5bfc\u5185\u6838\u53caDebian\u3002</p> <p>\u4ece\u7ebf\u5237\u5305\u4e2d\u89e3\u51faboot.img\u955c\u50cf\uff0c\u968f\u540e\u4f7f\u7528debootstrap\u547d\u4ee4\u6784\u5efa\u4e00\u4e2a\u6700\u5c0farmhf debian\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u5c06\u6587\u4ef6\u7cfb\u7edf\u5236\u4f5c\u6210ext2\u6587\u4ef6\u7cfb\u7edf\u7684\u955c\u50cf\uff0c\u4fee\u6539package-file\u548cparameter\u6587\u4ef6\uff0c\u4e3b\u8981\u662f\u5bf9\u6253\u5305\u6587\u4ef6\u548cmtd\u5206\u533a\u8868\u8fdb\u884c\u4fee\u6539\uff0c\u4fee\u6539\u540e\u4f7f\u7528rockchip\u63d0\u4f9b\u7684\u6253\u5305\u5de5\u5177\u91cd\u65b0\u6253\u5305\u56de\u7edf\u4e00\u955c\u50cf\uff0c\u5e76\u8fdb\u884c\u70e7\u5f55\u3002\u5982\u679c\u64cd\u4f5c\u65e0\u8bef\u7684\u8bdd\u4fbf\u53ef\u4ee5\u6210\u529f\u542f\u52a8\u5230Debian\u73af\u5883\u4e86\uff0c\u5b8c\u6574\u542f\u52a8log\u5982\u4e0b</p> <pre><code>U-Boot 2014.10-RK3128-01-01497-g3464f5e (Jun 17 2015 - 20:20:17)\n\nCPU: rk3128\nCPU's clock information:\n    arm pll = 600000000HZ\n    periph pll = 594000000HZ\n    ddr pll = 600000000HZ\n    codec pll = 400000000HZ\nBoard:  Rockchip platform Board\nUboot as second level loader\nDRAM:  Found dram banks:1\nAdding bank:0000000060000000(0000000040000000)\n128 MiB\nrk dma pl330 version: 1.1\nremotectl v0.1\nstorage init OK!\nUsing default environment\n\nGetParam\ncheck parameter success\nUnknow param: MACHINE_MODEL:rk3036!\nUnknow param: MACHINE_ID:007!\nUnknow param: MANUFACTURER:RK30SDK!\npower key: bank-0 pin-5\nSecureBootEn = 0, SecureBootLock = 0\n\n#Boot ver: 2015-06-17#2.20\nempty serial no.\ncheckKey\nvbus = 1\nboard_fbt_key_pressed: ir_keycode = 0x0, frt = 0\nread logo_on switch from dts [1]\ncan't find power_ctr node for lcdc0\nread_deviceinfo_storage:p_deviceinfo=0x67d00000,p_baseparamer=0x67e00000\nfailed to find part:deviceinfo\nuboot changed by Huawei for CA!!!!!!!!!!!!!\nfailed to find part:baseparamer\n[EDID-EXTEND] It is a  CEA 861 Series Extension.\nno baseparametr,find best edid mode,vic=16\ninput_color=1,output_color=0\nsucess output HDMI.\nfailed to find part:logo\nfailed to find part:resource\nshow_resource_image:show logo from resource or boot partition\ncheckKey\nvbus = 1\nboard_fbt_key_pressed: ir_keycode = 0x0, frt = 0\nfailed to find part:misc\nmisc partition not found!\nHit any key to stop autoboot:  0 \nrkboot # \nrkboot # bootrk boot\nkernel   @ 0x62000000 (0x0064dd88)\nramdisk  @ 0x64bf0000 (0x00000200)\nCML tvetestmode is =0\nSecure Boot state: 0\nbootrk: do_bootm_linux...\n   Loading Device Tree to 64515000, end 6452b87f ... OK\nAdd bank:0000000060000000, 0000000040000000\n\nStarting kernel ...\n\n&lt;hit enter to activate fiq debugger&gt;\n[    0.000000] Booting Linux on physical CPU 0xf00\n[    0.000000] Initializing cgroup subsys cpu\n[    0.000000] Initializing cgroup subsys cpuacct\n[    0.000000] Linux version 3.10.0 (liujunjie@HW-TV-S1) (gcc version 4.6.x-google 20120106 (prerelease) (GCC) ) #16 SMP PREEMPT Tue Jun 16 23:15:18 CST 2015\n[    0.000000] CPU: ARMv7 Processor [410fc075] revision 5 (ARMv7), cr=10c5387d\n[    0.000000] CPU: PIPT / VIPT nonaliasing data cache, VIPT aliasing instruction cache\n[    0.000000] Machine: Rockchip RK3128, model: rockchip,rk3128\n[    0.000000] get_bootmode: storagemedia=emmc, flag_uboot_bootmode_nand=0\n[    0.000000] hdmi init vic is 16\n[    0.000000] cvbs init tve.format is -1\n[    0.000000] cvbs init tve.testmode is 0\n[    0.000000] rockchip_ion_reserve\n[    0.000000] ion heap(cma): base(0) size(800000) align(0)\n[    0.000000] ion heap(vmalloc): base(0) size(0) align(0)\n[    0.000000] cma: CMA: reserved 8 MiB at 9f800000\n[    0.000000] ion_reserve: cma reserved base 9f800000 size 8388608\n[    0.000000] rockchip_deviceinfo_reserve:\n[    0.000000] rockchip_deviceinfo_find_reserve_mem:enable=1,base=0x67d00000,size=0x200000\n[    0.000000] cma: CMA: reserved 16 MiB at 8e800000\n[    0.000000] Memory policy: ECC disabled, Data cache writealloc\n[    0.000000] Boot mode: REBOOT (6) flag: NORMAL (0xc3524200)\n[    0.000000] PERCPU: Embedded 9 pages/cpu @c15ae000 s14016 r8192 d14656 u36864\n[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 260624\n[    0.000000] Kernel command line: root=/dev/mmcblk0p4 rw console=ttyFIQ0  mtdparts=rk29xxnand:0x00000800@0x00002000(fastboot),0x00008000@0x00002800(recovery),0x00006000@0x0000a800(boot),-@\n0x00010800(system) storagemedia=emmc loader.timestamp=2015-06-17_20:20:17 hdmi.vic=16 tve.format=-1 tve.test=0 ir.keycode=0x0\n[    0.000000] PID hash table entries: 4096 (order: 2, 16384 bytes)\n[    0.000000] Dentry cache hash table entries: 131072 (order: 7, 524288 bytes)\n[    0.000000] Inode-cache hash table entries: 65536 (order: 6, 262144 bytes)\n[    0.000000] allocated 2097152 bytes of page_cgroup\n[    0.000000] please try 'cgroup_disable=memory' option if you don't want memory cgroups\n[    0.000000] Memory: 1024MB = 1024MB total\n[    0.000000] Memory: 996640k/996640k available, 51936k reserved, 262144K highmem\n[    0.000000] Virtual kernel memory layout:\n[    0.000000]     vector  : 0xffff0000 - 0xffff1000   (   4 kB)\n[    0.000000]     fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)\n[    0.000000]     vmalloc : 0xf0000000 - 0xff000000   ( 240 MB)\n[    0.000000]     lowmem  : 0xc0000000 - 0xef800000   ( 760 MB)\n[    0.000000]     pkmap   : 0xbfe00000 - 0xc0000000   (   2 MB)\n[    0.000000]     modules : 0xbf000000 - 0xbfe00000   (  14 MB)\n[    0.000000]       .text : 0xc0008000 - 0xc0b01884   (11239 kB)\n[    0.000000]       .init : 0xc0b02000 - 0xc0b5b6c0   ( 358 kB)\n[    0.000000]       .data : 0xc0b5c000 - 0xc0c639b8   (1055 kB)\n[    0.000000]        .bss : 0xc0c639b8 - 0xc0d83044   (1150 kB)\n[    0.000000] SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=4, Nodes=1\n[    0.000000] Preemptible hierarchical RCU implementation.\n[    0.000000]  RCU dyntick-idle grace-period acceleration is enabled.\n[    0.000000] NR_IRQS:16 nr_irqs:16 16\n[    0.000000] rk_clk_tree_init start! cru base = 0xfed00000\n[    0.000000] rk_get_uboot_display_flag: uboot_logo_on = 1\n[    0.000000] rkclk_init_clks: cnt_parent = 25\n[    0.000000] rkclk_init_clks: cnt_rate = 17\n[    0.000000] Architected cp15 timer(s) running at 24.00MHz (phys).\n[    0.000000] Switching to timer-based delay loop\n[    0.000000] sched_clock: ARM arch timer &gt;56 bits at 24000kHz, resolution 41ns\n[    0.000000] process version: 0\n[    0.000000] channel:0, lkg:25\n[    0.000000] target-temp:85\n[    0.000000] channel:0, lkg:25\n[    0.000000] target-temp:85\n[    0.000000] channel:0, lkg:25\n[    0.000000] target-temp:85\n[    0.000000] sched_clock: 32 bits at 100 Hz, resolution 10000000ns, wraps every 4294967286ms\n[    0.274709] Calibrating delay loop (skipped), value calculated using timer frequency.. 48.00 BogoMIPS (lpj=240000)\n[    0.274735] pid_max: default: 32768 minimum: 301\n[    0.274943] Security Framework initialized\n[    0.274972] SELinux:  Initializing.\n[    0.275103] Mount-cache hash table entries: 512\n[    0.276333] Initializing cgroup subsys debug\n[    0.276361] Initializing cgroup subsys memory\n[    0.276413] Initializing cgroup subsys freezer\n[    0.276477] CPU: Testing write buffer coherency: ok\n[    0.277007] /cpus/cpu@0 missing clock-frequency property\n[    0.277033] /cpus/cpu@1 missing clock-frequency property\n[    0.277053] /cpus/cpu@2 missing clock-frequency property\n[    0.277071] /cpus/cpu@3 missing clock-frequency property\n[    0.277143] CPU0: thread -1, cpu 0, socket 15, mpidr 80000f00\n[    0.277215] Setting up static identity map for 0xc07ed420 - 0xc07ed478\n[    0.279593] last_log: 0x8e100000 map to 0xf0004000 and copy to 0xf0086000, size 0x80000 early 0x1648 (version 3.0)\n[    0.352676] CPU1: Booted secondary processor\n[    0.352733] CPU1: thread -1, cpu 1, socket 15, mpidr 80000f01\n[    0.372363] CPU2: Booted secondary processor\n[    0.372408] CPU2: thread -1, cpu 2, socket 15, mpidr 80000f02\n[    0.392120] CPU3: Booted secondary processor\n[    0.392166] CPU3: thread -1, cpu 3, socket 15, mpidr 80000f03\n[    0.392358] Brought up 4 CPUs\n[    0.392410] SMP: Total of 4 processors activated (192.00 BogoMIPS).\n[    0.392425] CPU: All CPU(s) started in SVC mode.\n[    0.393859] devtmpfs: initialized\n[    0.403214] pinctrl core: initialized pinctrl subsystem\n[    0.403717] regulator-dummy: no parameters\n[    0.405244] NET: Registered protocol family 16\n[    0.408167] DMA: preallocated 256 KiB pool for atomic coherent allocations\n[    0.408733] ion_snapshot: 0x8e218000 map to 0xf0107000 and copy to 0xc0d5e504 (version 0.1)\n[    0.408972] Registered FIQ tty driver\n[    0.410879] console [ttyFIQ0] enabled\n[    0.411341] Registered fiq debugger ttyFIQ0\n[    0.412563] rockchip_get_bank_data:name=/pinctrl@20008000/gpio0@2007c000 start=0x2007c000,end=0x2007c0ff\n[    0.412704] rockchip_get_bank_data:name=/pinctrl@20008000/gpio1@20080000 start=0x20080000,end=0x200800ff\n[    0.412784] rockchip_get_bank_data:name=/pinctrl@20008000/gpio2@20084000 start=0x20084000,end=0x200840ff\n[    0.412863] rockchip_get_bank_data:name=/pinctrl@20008000/gpio3@20088000 start=0x20088000,end=0x200880ff\n[    0.412950] rockchip_get_bank_data:name=/pinctrl@20008000/gpio15@2008A000 start=0x20086000,end=0x200860ff\n[    0.413023] rockchip_pinctrl_probe:name=rk312x-GPIO,type=5\n[    0.413053] rockchip_pinctrl_probe:name=base start=0x20008000,end=0x200080a7\n[    0.413097] rockchip_pinctrl_probe:name=mux start=0x200080a8,end=0x200080f3\n[    0.413127] rockchip_pinctrl_probe:name=pull start=0x20008118,end=0x20008137\n[    0.413156] rockchip_pinctrl_probe:name=drv start=0x20008100,end=0x20008103\n[    0.415869] rockchip_pinctrl_probe:init ok\n[    0.422524] rk_iommu 1010e300.vop_mmu: (vop) Enter\n[    0.422578] rk_iommu 1010e300.vop_mmu: skip request vop mmu irq\n[    0.422689] rk_iommu 1010e300.vop_mmu: IOVMM: Created 0x3ffff000 B IOVMM from 0x10000000.\n[    0.422718] rk_iommu 1010e300.vop_mmu: (vop) Initialized\n[    0.422987] rk_iommu 10104440.hevc_mmu: (hevc) Enter\n[    0.423139] rk_iommu 10104440.hevc_mmu: IOVMM: Created 0x3ffff000 B IOVMM from 0x10000000.\n[    0.423170] rk_iommu 10104440.hevc_mmu: (hevc) Initialized\n[    0.423440] rk_iommu 10106800.vpu_mmu: (vpu) Enter\n[    0.423572] rk_iommu 10106800.vpu_mmu: IOVMM: Created 0x3ffff000 B IOVMM from 0x10000000.\n[    0.423602] rk_iommu 10106800.vpu_mmu: (vpu) Initialized\n[    0.423851] rk_iommu 10108800.iep_mmu: (iep) Enter\n[    0.423985] rk_iommu 10108800.iep_mmu: IOVMM: Created 0x3ffff000 B IOVMM from 0x10000000.\n[    0.424015] rk_iommu 10108800.iep_mmu: (iep) Initialized\n[    0.425737] hw-breakpoint: found 5 (+1 reserved) breakpoint and 4 watchpoint registers.\n[    0.425767] hw-breakpoint: maximum watchpoint size is 8 bytes.\n[    0.426057] DDR DEBUG: version 1.02 20140828\n[    0.426081] DDR DEBUG: DRAM Type:DDR3\n[    0.426107] DDR DEBUG: 1 CS, ROW=15, Bank=8, COL=10, Total Capability=1024MB\n[    0.426151] DDR DEBUG: init success!!! freq=300MHz\n[    0.478800] bio: create slab &lt;bio-0&gt; at 0\n[    0.481661] SCSI subsystem initialized\n[    0.482030] usbcore: registered new interface driver usbfs\n[    0.482137] usbcore: registered new interface driver hub\n[    0.482383] usbcore: registered new device driver usb\n[    0.484166] media: Linux media interface: v0.10\n[    0.484258] Linux video capture interface: v2.00\n[    0.484351] pps_core: LinuxPPS API ver. 1 registered\n[    0.484373] pps_core: Software ver. 5.3.6 - Copyright 2005-2007 Rodolfo Giometti &lt;giometti@linux.it&gt;\n[    0.484422] PTP clock support registered\n[    0.485449] Rockchip ion module is successfully loaded (v1.0)\n[    0.485729] Advanced Linux Sound Architecture Driver Initialized.\n[    0.486545] Bluetooth: Core ver 2.16\n[    0.486623] NET: Registered protocol family 31\n[    0.486645] Bluetooth: HCI device and connection manager initialized\n[    0.486680] Bluetooth: HCI socket layer initialized\n[    0.486709] Bluetooth: L2CAP socket layer initialized\n[    0.486764] Bluetooth: SCO socket layer initialized\n[    0.487209] cfg80211: Calling CRDA to update world regulatory domain\n[    0.489329] i2c-core: driver [rk818] using legacy suspend method\n[    0.489359] i2c-core: driver [rk818] using legacy resume method\n[    0.491152] Switching to clocksource arch_sys_counter\n[    0.527190] fb disp policy is box\n[    0.527294] rk-fb rockchip-fb: rk fb ion client create success!\n[    0.527321] rk-fb rockchip-fb: rockchip framebuffer driver probe\n[    0.527816] rk-screen rk_screen.9: rockchip screen probe success\n[    0.528964] rk312x-lcdc lcdc0: can't find power_ctr node for lcdc0\n[    0.528995] rk_fb_trsm_ops_get:un supported transmitter:6!\n[    0.529514] graphics fb0: rockchip framebuffer registerd:fb0\n[    0.530230] graphics fb1: rockchip framebuffer registerd:fb1\n[    0.530652] graphics fb2: rockchip framebuffer registerd:fb2\n[    0.531275] rk312x-lcdc lcdc0: set lcdc0 dclk failed\n[    0.531312] rk312x-lcdc lcdc0: lcdc0: dclk:148500000&gt;&gt;fps:60 \n[    0.531339] rk312x-lcdc lcdc0: wakeup from standby!\n[    0.574680] alloc_buffer:ion_phy_addr=0x10000000\n[    0.594713] fb0:phy:10000000&gt;&gt;vir:f0131000&gt;&gt;len:0x1800000\n[    0.594750] rk312x-lcdc lcdc0: lcdc0 probe ok, iommu enabled\n[    0.597844] NET: Registered protocol family 2\n[    0.598785] TCP established hash table entries: 8192 (order: 4, 65536 bytes)\n[    0.599010] TCP bind hash table entries: 8192 (order: 4, 65536 bytes)\n[    0.599211] TCP: Hash tables configured (established 8192 bind 8192)\n[    0.599321] TCP: reno registered\n[    0.599351] UDP hash table entries: 512 (order: 2, 16384 bytes)\n[    0.599421] UDP-Lite hash table entries: 512 (order: 2, 16384 bytes)\n[    0.599896] NET: Registered protocol family 1\n[    0.600496] Unpacking initramfs...\n[    0.601587] hw perfevents: enabled with ARMv7_Cortex_A7 PMU driver, 5 counters available\n[    0.602169] probe device 10106000.vpu_service\n[    0.602300] vpu_service: power on\n[    0.603376] checking hw id 4831\n[    0.604247] vcodec vpu_service: vcodec ion client create success!\n[    0.604703] vpu_service: power off...\n[    0.604762] done\n[    0.604779] init success\n[    0.604863] probe device 10104000.hevc_service\n[    0.604988] hevc_service: power on\n[    0.606058] checking hw id 6867\n[    0.606705] vcodec hevc_service: vcodec ion client create success!\n[    0.607130] hevc_service: power off...\n[    0.607187] done\n[    0.607204] init success\n[    0.607370] rknandbase v1.0 2014-03-31\n[    0.607553] rknand 10500000.nandc0: no irq resource?\n[    0.607730] rknand_driver:ret = 0 \n[    0.609920] audit: initializing netlink socket (disabled)\n[    0.609996] type=2000 audit(0.340:1): initialized\n[    0.611376] bounce pool size: 64 pages\n[    0.622073] fuse init (API version 7.22)\nE[  ux:  315l7]not ckenaper SC Iigeneri/ tb/g) drix/raverseo/p0.4cloadldcy.a1or N46s\nheduler noop registered\n[    0.631634] io scheduler deadline registered\n[    0.631821] io scheduler cfq registered (default)\n[    0.637511] rga 1010c000.rga: rga ion client create success!\n[    0.637869] rga: Driver loaded succesfully\n[    0.637991] rga: Module initialized.\n[    0.638585] rk3036-hdmi 20034000.hdmi: rk3036_hdmi_probe,type=1\n[    0.639261] rk3036_hdmi_initial:,phy_pre_emphasis=63\n[    0.639426] rk3036-hdmi 20034000.hdmi: rk3036 hdmi probe success.\n[    0.640384] IEP Power ON\n[    0.640463] iep ion client create success!\n[    0.640953] IEP Power OFF\n[    0.640993] IEP Driver loaded succesfully\n[    0.641150] Module initialized.\n[    0.64136\n elcm e l ttmDdbiis GN\n                      [Li  0 64 (95]tek3tve \n                                            010e200.tve: rockchip,rk312x-tve tv encoder probe ok\n[    0.658777] cec input device !!!\n[    0.659104] input: hdmi_cec_key as /devices/virtual/input/input0\n[    0.698089] hdmi connect to lcdc0\n[    0.974900] rk_battery_charger_detect_cb , battery_charger_detect 2\n[    0.977349] dma-pl330 20078000.pdma: Loaded driver for PL330 DMAC-2364208\n[    0.977386] dma-pl330 20078000.pdma:         DBUFF-64x8bytes Num_Chans-8 Num_Peri-16 Num_Events-16\n[    0.977972] vdd_arm: 950 &lt;--&gt; 1425 mV at 1250 mV \n[    0.978547] vdd_logic: 950 &lt;--&gt; 1425 mV at 1200 mV \n[    0.979457] rk_serial.c v1.8 2014-03-04\n[    0.986015] loop: module loaded\n[    0.989721] Freeing initrd memory: 2048K (c7d00000 - c7f00000)\n[    0.989753] rockchip_deviceinfo_probe:info.flag_reserve=1\n[    0.991027] SCSI Media Changer driver v0.25 \n[    0.991625] tun: Universal TUN/TAP device driver, 1.6\n[    0.991651] tun: (C) 1999-2004 Max Krasnyansky &lt;maxk@qualcomm.com&gt;\n[    0.992818] stmmac_probe_config_dt: Can not read property: pmu_regulator.\n[    0.992850] stmmac_probe_config_dt: Can not read property: pmu_enable_level.\n[    0.992875] stmmac_probe_config_dt: clock input or output? (output).\n[    0.992899] stmmac_probe_config_dt: TX delay(0x30).\n[    0.992920] stmmac_probe_config_dt: RX delay(0x10).\n[    0.993012] stmmac_probe_config_dt: is rockchip,rk312x-gmac\n[    0.993032] stmmc_pltfr_init: \n[    0.993050] stmmc_pltfr_init: ERROR: Get power-gpio failed.\n[    0.993167] stmmc_pltfr_init: init for RMII\n[    0.993436] stmmac - user ID: 0x10, Synopsys ID: 0x35\n[    0.993458]  Normal descriptors\n[    0.993474]  Ring mode enabled\n[    0.993491]  DMA HW capability register supported\n[    0.993511]  RX Checksum Offload Engine supported (type 2)\n[    0.993530]  TX Checksum insertion supported\n[    0.993546]  Wake-Up On Lan supported\n[    0.993624]  Enable RX Mitigation via HW Watchdog Timer\n[    0.994544] PPP generic driver version 2.4.2\n[    0.994917] PPP BSD Compression module registered\n[    0.994946] PPP Deflate Compression module registered\n[    0.994980] PPP MPPE Compression module registered\n[    0.995003] NET: Registered protocol family 24\n[    0.995058] SLIP: version 0.8.4-NET3.019-NEWTTY (dynamic channels, max=256) (6 bit encapsulation enabled).\n[    0.995082] CSLIP: code copyright 1989 Regents of the University of California.\n[    0.995105] Rockchip WiFi SYS interface (V1.00) ... \n[    0.995173] esp_mem_init enter date Mar 31 2015 15:38:58\n[    0.995254] esp_mem_init complete \n[    0.995390] usbcore: registered new interface driver catc\n[    0.995477] usbcore: registered new interface driver kaweth\n[    0.995502] pegasus: v0.9.3 (2013/04/25), Pegasus/Pegasus II USB Ethernet driver\n[    0.995584] usbcore: registered new interface driver pegasus\n[    0.995665] usbcore: registered new interface driver rtl8150\n[    0.995744] usbcore: registered new interface driver r8152\n[    0.995767] hso: drivers/net/usb/hso.c: Option Wireless\n[    0.995901] usbcore: registered new interface driver hso\n[    0.996010] usbcore: registered new interface driver asix\n[    0.996093] usbcore: registered new interface driver ax88179_178a\n[    0.996176] usbcore: registered new interface driver cdc_ether\n[    0.996256] usbcore: registered new interface driver cdc_eem\n[    0.996335] usbcore: registered new interface driver dm9601\n[    0.996417] usbcore: registered new interface driver dm9620\n[    0.996519] usbcore: registered new interface driver smsc75xx\n[    0.996635] usbcore: registered new interface driver smsc95xx\n[    0.996719] usbcore: registered new interface driver gl620a\n[    0.996801] usbcore: registered new interface driver net1080\n[    0.996889] usbcore: registered new interface driver plusb\n[    0.996972] usbcore: registered new interface driver rndis_host\n[    0.997055] usbcore: registered new interface driver cdc_subset\n[    0.997135] usbcore: registered new interface driver zaurus\n[    0.997229] usbcore: registered new interface driver MOSCHIP usb-ethernet driver\n[    0.997358] usbcore: registered new interface driver int51x1\n[    0.997442] usbcore: registered new interface driver kalmia\n[    0.997524] usbcore: registered new interface driver ipheth\n[    0.997617] usbcore: registered new interface driver sierra_net\n[    0.997701] usbcore: registered new interface driver cx82310_eth\n[    0.997806] usbcore: registered new interface driver cdc_ncm\n[    0.997901] usbcore: registered new interface driver qmi_wwan\n[    0.997987] usbcore: registered new interface driver cdc_mbim\n[    0.998010] ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver\n[    0.998321] usbcore: registered new interface driver cdc_acm\n[    0.998345] cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters\n[    0.998454] usbcore: registered new interface driver usblp\n[    0.998541] usbcore: registered new interface driver cdc_wdm\n[    0.998665] usbcore: registered new interface driver usb-storage\n[    0.998744] usbcore: registered new interface driver ums-alauda\n[    0.998819] usbcore: registered new interface driver ums-cypress\n[    0.998894] usbcore: registered new interface driver ums-datafab\n[    0.998968] usbcore: registered new interface driver ums_eneub6250\n[    0.999042] usbcore: registered new interface driver ums-freecom\n[    0.999117] usbcore: registered new interface driver ums-isd200\n[    0.999191] usbcore: registered new interface driver ums-jumpshot\n[    0.999266] usbcore: registered new interface d[er3ums Oar \n] Li0.en934 ] uore39redesteeed l wocktece \n                                          river ums-oumh\nK   [0.9 L434e usg or r;1istmredtcew Cnmeataceldri Nr eds-s[ipe\n.  \n0.999513] usb[e:32eg Oter n] Listeriaceonri[0r1;ms-uddr C\n[r   S.99e5900mus\n                 core: registered new 0;ter  ce  rivmr Lis-unbat o[ 01;997Sy] ogbcoce:tregm.\n registered new interface drr 2mbsOKial[gm]erre\nred fo[ [0;eric O[  1.]00ea3] d bcrge: gi1;ermR net inile acstdri.\nion\ng[  0m1000071] [0bsem alK USB0Se Lal euppg t  s;er39 fourGSl modemt (-pevt)\n00172] usbcore:[gi3ter O n imteCreceedrivir t;1vibmstote\n                                                        [ e ty.00ic19[0 usb20_otg: 0;rsio  3.  m]-Dea-20d2\nrg    li9800m\n\n   1.00082 C3re  Ole :m2.91art[  1.100949orSetd ngssefadlt \ufffd\ufffdlust foo cole Diramt\n Using B[f[0; Dm  mo e\n0   S1.0te13Pe;3odDi TrtnsfPa Intrdr\ufffdpt s ha Cemeot  Diisctled \n                                                               [ ch 10m0\nl     1.te11Vo] OesG VmR PARAM: O2G VOK FL[0:] Rea   d .00ge96] ^^1;^^^Path^^^0m^Device Mode\n[[   ;3001 O0] ic Led en FI os m[0e1;[  Jo1.0al257c pcnit otg_dev = ed89e340\n[    1.001611] usb20_otg 1 1800  . sbu tWngO o;39mKlrn\n10180000.usb: new USB bus registered, assigned b    umb   tar[ ng 001;39muusb20oldplu018l0 0evic:si[0 4., i\n                                                                                                            mem 0x00000000\n[    1.001858] usb usb1: New USB device found, idVendor=1d6b, idProduct=0002\n[    1.001888] usb usb1:  e    B device rtrigg ;fr33, PmLduc =2, SlriadNumuees1[\n                                                                                m .  1.\n1915] usb usb1: Product: DWC OT         Starting Journal Service o..\nller\n[    1.001938] usb usb1: Manufacturer: Linux 3.10.0 dwc_otg_hcd\n[    1.001962] usb usb1: SerialNumber: 10180000.usb\n[   00029 0] hub[1-] 1.a: US  hub f u[0;1[39  ock030 0m.\n-0:1.0: 1 port detected\n[    1.003667] usb20_host: version 3.10a 21-DEC-2012\n[    1.005860] f1a00040\n[    1.005889] Core Release: 2.91a\n[    1.005910] Setting default values for core params\n[    1.006173] Using Buffer DMA mode\n[    1.006197] Periodic Transfer Interrupt Enhancement - disabled\n[    1.006217] Multiprocessor Interrupt En an em   St dtsag  3 m1.mou237]oot  VE  erReM  0l OTystEm Am:.0\n[    1.006255] ^^^^^^^^^^^^^^^^^^Host Mode\n9mKer 1l0Deb9g  ilb 0_htst [0m.0000.usb: new USB bus registered, assigned bus number 2\n[    1.006460] usb20_host 101c0000.usb: irq 43, io mem 0x00000000\n[    1.006567] Init: Power Port (0)\n[    1.006687] usb usb2: New USB device found, idVendor=1d6b, idProduct=0002\n[    1.006718] usb usb2: New USB device strings: Mfr=3, Product=2, SerialNumber=1\n[    1.006744] usb usb2: Product: DWC OTG Controller\n[    1.006768] usb usb2: Manufacturer: Linux 3.10.0 dwc_otg_hcd\n[    1.006792] usb usb2: SerialNumber: 101c0000.usb\n[    1.007728] hub 2-0:1.0: USB hub found\n[    1.007775] hub 2-0:1.0: 1 port detected\n[    1.009279] usbcore: registered new interface driver xpad\n[    1.009393] usbcore: registered new interface driver usb_acecad\n[    1.009485] usbcore: registered new interface driver aiptek\n[    1.009572] usb[e: reg Otered m] wtirnet r[0ce 39mvoa gKern\nusbcore: registered new interface driver hanwang              l  o 1.0s9[59.\n[    1.009744] usbcore: registered new interface driver kbtab\n[    1.009853] usbcore: registered new interface driver wacom\n[    1.010754] .. rk pwm remotectl v1.1 init\n[    1.011208] input: 20050030.pwm as /devices/20050030.pwm/input/input1\n[    1.011875] i2c /dev entries driver\n[    1.012285] IR NEC protocol handler initialized\n[    1.012309] [R RCm  O  rot0molShardldr ini1i3lmzed\nn  R ot012d 8erIelRF6le otocems0d.e\n                                    initialized\n[    1.012346] IR JVC protocol handler initialized\n[    1.012363] IR Sony protocol handler initialized\n[    1.012382] IR RC5 (streamzap) protocol handler initialized\n[    1  124t1rtin  0; p39mCcelthandler  Uitrali0e...[    1.012419] IR MCE Keyboard/mouse protocol handler initialized\n[    1.012675] usbcore: registered new interface driver uvcvideo\n[    1.012699         Starting S9BL ad/Save Random Seed...\nVideo Class driver (1.1.1)\n[    1.013314] device-mapper: uevent: version 1.0.3\n[    1.013826] device-mapper: ioctl: 4.24.0-ioctl (2013-01-15) initialised: dm-d         Mounting FUSE Control File System...\nevel@redhat.com\n[    1.014523] Bluetooth: HCI UART driver ver 2.2\n         Mounting Kernel Configuration File System...\n[    1.014553] Bluetooth: HCI H4 protocol initialized\n[    1.014572] Bluetooth: HCILL protocol initialized\n[    1.014592] rtk_btusb: Realtek Bluetooth USB driver module init, version 2.19\n[    1.014614] rtk_btusb: Register         Starting Apply Kernel Variables...\n usb char device interface for BT driver\n[    1.014990] usbcore: registered new interface driver rtk_btusb\n[    1.015347] cpufreq version 1.0, suspend freq 816 MHz\n[    1.015722] cpuidle: using governor ladder\n[    1.015741] cpuidle: using governor menu\n[    1.015798] Synopsys Designware Multimedia Card Interface Driver\n[    1.016141] dwmmc_rockchip01321 000  k[dm]cMoVersi n[ID1i392F0S\nchip 1021c000.rksdmmc: Using external DMA controller.\n[    1.017000] 3434..dw_mci_init_slot: fmin=400000, fmax=37500000 [mmc0]\nt[on File System.c0 : Rockchip spec[  OK  ] ifintc  HSC; ;e9mKerne20C4-09-0r\n    1.017225] 1391..dw_mci_set_ios:  no card. [mmc0]\n[    1.017243] dw_mci_set_ios up,regs=0x0 mmc0\n[    1.032522] 1391..dw_mci_set_ios:  no card. [mmc0]\n[    1.052195] rk_sdmmc: BOOT dw_mci_setup_bus: argue clk_mmc workaround out 800000Hz for init[mmc0]\n[    1.052278] dwmmc_rockchip 1021c000.rksdmmc: DW MMC controller at irq 48, 32 bit host data width, 256 deep fifo\n[    1.052299] dwmmc_rockchip 1021c000.rksdmmc: 1 slots initialized\n[    1.052658] dwmmc_rockchip 10214000.rksdmmc: Version ID is 270a\n[    1.053346] dwmmc_rockchip 10214000.rksdmmc: Using external DMA controller.\nmc1 : Rockchip specific MHSC: Ver 1.13 2014-09-050 Stmrtx= 3[0;1;09m oad/S1]\n[    1.053767] mmc1: no vmmc regulator found\n[    1.053981] 1391..dw_mci_set_ios:  no card. [mmc1]\n[    1.053997] dw_mci_set_ios up,regs=0x0 mmc1\n[    1.071850] 1391..dw_mci_set_ios:  no card. [mmc1]\n[    1.084460] mmc0: BKOPS_EN bit is not set\n[    1.086437] mmc_host mmc0: Bus speed (slot 0) = 37500000Hz (slot req 37500000Hz, actual 37500000HZ div = 0)\n[    1.086467] rk_sdmmc: BOOT dw_mci_setup_bus: argue clk_mmc workaround out normal clock [mmc0]\n[    1.086483] rk_sdmmc: BOOT dw_mci_setup_bus: workaround div = 1, host-&gt;bus_hz = 75000000 [mmc0]\n[    1.086588] rk_sdmmc: BOOT Bus speed=37500000Hz,Bus width=8bits.[mmc0]\n[    1.086803] mmc0: new high speed DDR MMC card at address 0001\n[    1.087318] mmcblk0: mmc0:0001 4FPD3R 3.64 GiB \n[    1.087837]   fastboot: 0x000400000 -- 0x000500000 (1 MB)\n[    1.087858]   recovery: 0x000500000 -- 0x001500000 (16 MB)\n[    1.087874]       boot: 0x001500000 -- 0x002100000 (12 MB)\n[    1.087890]     system: 0x002100000 -- 0x0e8c00000 (3691 MB)\n[    1.087914]  mmcblk0: p1 p2 p3 p41391..dw_mci_set_ios:  no card. [mmc1]\n[    1.091606] dw_mci_set_ios off,regs=0x1 mmc1\n[    1.091632] dwmmc_rock[;32m 14K  .r0m]mmta DedM;o;t9mCler at irq 4 U ersbit ho\n2[  OK .0m]52] dwmmc_rtcrthiprurnalc: rvscet[ i.itialized                        t data width, 256 deep f[fo\n[    1.092035] dwmmc_rockchip 10218000.rksdmmc: Version ID is 270a\n[    1.092357] dwmmc_rockchip 10218000.rksdmmc: Using external DMA controller.\n[    1.092649] 3434..dw_mci_init_slot: fmin=200000, fmax=37500000 [mmc2]\n[    1.092667] mmc2 : Rockchip specific MHSC: Ver 1.13 2014-09-05\nmc2  1.092927] 1391..dw_mci_set_i[0 32 caOK  m2]Sta t  1.0929;39 dwplyi_srneloV up,rees=00m \n[    1.101465] dwc_otg_hcd_suspend, usb device mode\n[    1.111216] 1391..dw_mci_set_ios:     c  d. [mmc2]St\n                                                       rti g 1.013;30mF ush J.urna_mto Peretsieos  torogeardm [m\n2]\n[    1.130925] dw_mci_set_ios off,regs=0x1 mmc2\n bit host data width, 256 deep fifo8000rratd mca Dc MeCico tooelein tdir.3\n[    1.131026] dwmmc_rockchip 10218000.rksdmmc: 1 slots initialized\n[    1.131321] boot changed by Huawei for CA!!!!!!!!!!!!!\n[    1.131336] I&gt;&gt;&gt; ROCKCHIP_LEDS_GPIO-&gt;rk_gpio_led_probe(228): rk_gpio_led v1.0 init\n[    1.131621] hidraw: raw HID events driver (C) Jiri Kosina\n[    1.134123] usbcore: registered new interface driver usbhid\n[    1.134139] usbhid: USB HID core driver\n[    1.134688] zram: Created 1 device(s) ...\n[    1.135320] ashmem: initialized\n[    1.135518] logger: created 256K log 'log_main'\n[    1.135686] logger: created 256K log 'log_events'\n[    1.135838] logger: created 256K log 'log_radio'\n[    1.136005] logger: created 256K log 'log_system'\n[    1.137705] This platfrom have not i2s_mclk,no need to set i2s_mclk.\n co tOK ed 0y] piaristerin( wi)0m.ip-audio.13:  rk312x-hifi &lt;-&gt; rockchip-i2s.1 mapping ok\nd    ;1.1992reat[WVol_RiKeLLiles an_ Directo_iesse_mtdm.vice &lt;-&gt; rockchip-i2s.1 mapping ok\nget property: WIFI,poweren_gpio = 30, flags = 0.ev sonkp rsion 4.1.0cesd[fmr\n.149270] [WLAN_RFKILL]: rfkill_wlan_probe: init gpio: gng pr0;e;tym pdate ,hoP aboke Syq e 2B, f/ahut= w. .. \n[    1.149306] [WLAN_RFKILL]: rockchip_wifi_voltage_select: unsupport wifi &amp; sdio refere         Starting Network Time Synchronization...\nnce voltage!. Millerporaelm.C.2 0 - Sta0t6ng f1l39rCCeae Teale widget found for Mic Bias\n[    1.149379] [WLAN_RFKILL]: Exit rfkill_wlan_probe Failed to add route Mic Bias -&gt; direct -&gt; MIC         .140940g a[0;o;3rmHel2x rto kynhhr-audi .o3: upSfCr ifupnow ur..e\n[    1.149437] [BT_RFKILL]: Enter rfkill_rk_init\n[    1.150763] VFP support v0.3: implementor 41 architecture 2 part 30 variant 7 rev 5irect -&gt; MICN\n[    1.150800] rk312x_init_suspendip-audio.13: ASoC: no sink widget found for Mic Bias\n[    1.150811] rk312x_suspend_init0-2006 Netfilter Core Teamto add route Headset Jack -&gt; direct -&gt; Mic Bias\n[    1.151068] Registering SWP/SWPB emulation handlerno source widget found for HPOUTR\n[    1.151657] ddrfreq: verion 1.2 20140526ily 17oC: Failed to add route HPOUTR -&gt; direct -&gt; Ext Spk\n[    1.151680] ddrfreq: normal 528MHz video_1080p 0MHz video_4k 0MHz dualview 0MHz idle 0MHz suspend 198MHz reboot 528MHz\n[    1.151694] ddrfreq: auto-freq=0egistered3: ASoC: no source widget found for HPOUTR\n[    1.151703] ddrfreq: auto-freq-table[0] 240MHzoC: Failed to add route HPOUTR -&gt; direct -&gt; Headphone Jack\n[    1.151713] ddrfreq: auto-freq-table[1] 324MHzlizedo source widget found for HPOUTL\n[    1.151723] ddrfreq: auto-freq-table[2] 396MHztializeded to add route HPOUTL -&gt; direct -&gt; Headphone Jack\n[    1.151732] ddrfreq: auto-freq-table[3] 528MHz-card.18:  rk-hdmi-spdif-hifi &lt;-&gt; rockchip-spdif mapping ok\n[    1.166304] regulator-dummy: disablingEmulation) ver 1.3\n[    1.166647] pcd_pullup, is_on 0rt:rted t[0ol;3umudcv se\n[    1.166742] file system registered Interface Emulation) ver 1.2\n[    1.168192] android_usb gadget: Mass Storage Function, version: 2009/09/11\n[    1.168214] android_usb gadget: Number of LUNs=244ge2]\n[    1.168230]  lun0: LUN: removable file: (no medium)\n[    1.168244]  lun1: LUN: removable file: (no medium)\n[    1.168572] android_usb gadget: android_usb readye\n[    1.168608] drivers/rtc/hctosys.c: unable to open rtc device (rtc0) rtkwifi\n[    1.175780] usbcore: registered new interface driver snd-usb-audioer control.\n[    1.175803] ALSA device list:an_platdata_parse_dt: disable wifi io reference voltage control.\n[    1.175816]   #0: RK_RK312Xwlan_platdata_parse_dt: wifi p\n[    1.175827]   #1: RK-SPDIF-CARD\n[    1.180804] VFS: Mounted root (ext2 filesystem) on device 179:4.\n[    1.181213] Freeing unused kernel memory: 356K (c0b02000 - c0b5b000)\n[    1.348409] Using Buffer DMA mode\n[    1.348437] Periodic Transfer Interrupt Enhancement - disabled\n[    1.348452] Multiprocessor Interrupt Enhancement - disabled\n[    1.348466] OTG VER PARAM: 0, OTG VER FLAG: 0\n[    1.348479] ^^^^^^^^^^^^^^^^^^Host Mode\n[    1.396624] Init: Power Port (0)\n[    1.396701] 10[u  Ore e,] PRTr:0d 0;\n                                       [3  Up.39e85TMP 01800 0.usbm uope/Sh Hdow0:[0m.00\n[    1.460380] systemd[1]: System time before build time, advancing clock.\n[    1.468626] systemd[1]: Failed to lookup module alias 'autofs4': Function not implemented\n[    1.509271] systemd[1]: systemd 241 running in system mode. (+PAM +AUDIT +SELINUX +IMA +APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUT\nILS +KMOD -IDN2 +IDN -PCRE2 default-hierarchy=hybrid)\n[    1.509966] systemd[1]: Detected architecture arm.\n[    1.520811] systemd[1]: Set hostname to &lt;debian-20&gt;.\n[    1.773678] systemd[1]: File /lib/systemd/system/systemd-journald.service:12 configures an IP firewall (IPAddressDeny=any), but the local system does not support BPF/cgroup based firewall\ning.\n[    1.773734] systemd[1]: Proceeding WITHOUT firewalling i[ [f;32t  (Kh s wmr Starte o; showNetwork thmeeSfnrshrloidediun m.i\n                                                                                                                              g IP firewalling.)\n                                                                                                                                                 .99  3[0 syReech[d]t rleb sy0tem3dmSysyst Tim\neriancgetti@edy[0IQ\n0.service:5: Failed to a;ddm eOK de[0m]  oa hed ttygeQ0,[0;1;oringstem nnitialrration-2.\n[    1.998660] sy[t[0;3dm1]:K/ sms Std/tyste[0s1r39mDgity @ttanIQ .feTemcer6:  ailec to add dependeies on de\n;32   2.  0[7m] syareed[ C;ndmDiin caeck resllad  cnivotieal[0u.                                            -ttyFIQ0, ignoring: Unknown error -22\n Socket being skipped.\n[  ; 2m  OK 70m] Stadted  L0st;nimDaolyudpv uerrad  acd cle\ntemd[1]: Listeni[g[o; in  OK l Comp Riaclitytargmed P0;1;  n ac 2.0ties3[0s.\n[   i2.S67t5m] sm.\nmd[1]: Listening on udev Control Socket.\n[    2.074791] systemd[1]: Listening on Syslog Socket.\n[ [0;.2m8 OK  ]0Startsd m[0;1: 9macghla taaget owap.\n[    d .ro85577p ocsseidg1]a:mCndi.i\n                                    on check resulted in Arbitrary Executable File Formats File System Aut m     Poantingin[ s1ippedy\nem   g.0ng350]vicsys0mm.[1]: Created slice system-serial\\x2dgetty.slice.\n[    2.094470] sy[d[2m  RK  he0 ]arget ee e 1il9mDyilyemo.\nio  o2.10g992lesm\n1]: Listening on Jou[nal S2mketK  v/log).\nslice system-getty.slice.mTimeeate0m \n[    2.115881] systemd[1]: Reached target Slices.\n[    2.121452] systemd[1]: Started Forward Password Requests to Wall Directory Watch.\n[    2.130192] systemd[1]: Started Dispatch Password Requests to Console Directory Watch.\n[    2.138625] systemd[1]: Reached target Local Encrypted Volumes.\n[    2.145249] systemd[1]: Reached target Paths.\n[    2.150998] systemd[1]: Listening on Journal Socket.\n[    2.157093] systemd[1]: Condition check resulted in POSIX Message Queue File System being skipped.\n[    2.160247] systemd[1]: Mounting Kernel Debug File System...\n[    2.169331] systemd[1]: Starting udev Coldplug all Devices...\n[    2.175097] systemd[1]: Condition check resulted in Create list of required static device nodes for the current kernel being skipped.\n[    2.184548] systemd[1]: Starting Load Kernel Modules...\n[    2.194759] systemd[1]: Starting Journal Service...\n[    2.208245] systemd[1]: Condition check resulted in Set Up Additional Binary Formats being skipped.\n[    2.208494] systemd[1]: Reached target Sockets.\n[    2.214482] systemd[1]: Condition check resulted in Huge Pages File System being skipped.\n[    2.226081] systemd[1]: Starting Remount Root and Kernel File Systems...\n[    2.254637] systemd[1]: Mounted Kernel Debug File System.\n[    2.341803] systemd[1]: Started Load Kernel Modules.\n[    2.381279] systemd[1]: Started Remount Root and Kernel File Systems.\n[    2.403599] systemd[1]: Starting Create System Users...\n[    2.413364] systemd[1]: Starting Load/Save Random Seed...\n[    2.440706] systemd[1]: Condition check resulted in Rebuild Hardware Database being skipped.\n[    2.445318] systemd[1]: Mounting FUSE Control File System...\n[    2.450831] systemd[1]: Mounting Kernel Configuration File System...\n[    2.464118] systemd[1]: Starting Apply Kernel Variables...\n1]: Mounted Kernel Configuration File System.d 1;y9mSmste[ L  gin391e2] ses[0m.\n[    2.597667] systemd[1]: Started Load/Save Random Seed.\n[    2.706045] systemd[1]: Started Create System Users.\n[    2.713334] systemd[1]: Started Journal Service.\n[    2.903290] systemd-journald[117]: Received request to flush runtime journal from PID 1\n[  OK  ] Started Helper to synchronize boot up for ifupdown.\n         Starting Raise network interfaces...\n[    4.092750] rk312x_delay_workq\n[    4.094255] phy_power_on: enable = 1 \n[    4.133679] Read the Ethernet MAC address from IDB:00:00:00:00:00:00\n[    4.133764] eth0: device MAC address 92:ae:3d:56:64:5d\n[    4.157413] libphy: stmmac: probed\n[    4.157456] eth0: PHY ID 001cc816 at 0 IRQ 0 (stmmac-0:00) active\n[    4.157478] eth0: PHY ID 001cc816 at 1 IRQ 0 (stmmac-0:01) active\n[    7.103863] stmmc_pltfr_fix_mac_speed: fix speed to 100\n[    7.103900] stmmc_pltfr_fix_mac_speed: fix speed for RMII\n[    7.103920] libphy: stmmac-0:01 - Link is Up - 100/Full\n[    7.536261] nf_conntrack: automatic helper assignment is deprecated and it will be removed soon. Use the iptables CT target to attach helpers instead.\n[  OK  ] Started Raise network interfaces.\n[  OK  ] Reached target Network.\n         Starting Permit User Sessions...\n[  OK  ] Started Permit User Sessions.\n[  OK  ] Started Serial Getty on ttyFIQ0.\n[  OK  ] Reached target Login Prompts.\n[  OK  ] Reached target Multi-User System.\n[  OK  ] Reached target Graphical Interface.\n         Starting Update UTMP about System Runlevel Changes...\n[  OK  ] Started Update UTMP about System Runlevel Changes.\n[   13.051244] tty_port_close_start: tty-&gt;count = 1 port count = 2.\n\nDebian GNU/Linux 10 debian-20 ttyFIQ0\n\ndebian-20 login: debian\nPassword: \nLast login: Thu Feb 14 10:12:09 UTC 2019 on ttyFIQ0\nLinux debian-20 3.10.0 #16 SMP PREEMPT Tue Jun 16 23:15:18 CST 2015 armv7l\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\ndebian@debian-20:~$ ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 92:ae:3d:56:64:5d brd ff:ff:ff:ff:ff:ff\n    inet 10.180.13.193/24 brd 10.180.13.255 scope global dynamic eth0\n       valid_lft 86395sec preferred_lft 86395sec\n    inet6 fe80::90ae:3dff:fe56:645d/64 scope link \n       valid_lft forever preferred_lft forever\n3: sit0: &lt;NOARP&gt; mtu 1480 qdisc noop state DOWN group default \n    link/sit 0.0.0.0 brd 0.0.0.0\ndebian@debian-20:~$ ping www.baidu.com\nping: socket: Permission denied\ndebian@debian-20:~$ uname -a\nLinux debian-20 3.10.0 #16 SMP PREEMPT Tue Jun 16 23:15:18 CST 2015 armv7l GNU/Linux\ndebian@debian-20:~$ cat /proc/cpuinfo \nProcessor       : ARMv7 Processor rev 5 (v7l)\nprocessor       : 0\nmodel name      : ARMv7 Processor rev 5 (v7l)\nBogoMIPS        : 48.00\nFeatures        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt vfpd32 evtstrm \nCPU implementer : 0x41\nCPU architecture: 7\nCPU variant     : 0x0\nCPU part        : 0xc07\nCPU revision    : 5\n\nprocessor       : 1\nmodel name      : ARMv7 Processor rev 5 (v7l)\nBogoMIPS        : 48.00\nFeatures        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt vfpd32 evtstrm \nCPU implementer : 0x41\nCPU architecture: 7\nCPU variant     : 0x0                                                                                       \nCPU part        : 0xc07                                                                                     \nCPU revision    : 5                                                                                         \n\nprocessor       : 2\nmodel name      : ARMv7 Processor rev 5 (v7l)\nBogoMIPS        : 48.00\nFeatures        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt vfpd32 evtstrm \nCPU implementer : 0x41\nCPU architecture: 7\nCPU variant     : 0x0\nCPU part        : 0xc07\nCPU revision    : 5\n\nprocessor       : 3\nmodel name      : ARMv7 Processor rev 5 (v7l)\nBogoMIPS        : 48.00\nFeatures        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt vfpd32 evtstrm \nCPU implementer : 0x41\nCPU architecture: 7\nCPU variant     : 0x0\nCPU part        : 0xc07\nCPU revision    : 5\n\nHardware        : Rockchip RK3128\nRevision        : 0000\nSerial          : 0000000000000000\n</code></pre>"},{"location":"embedded-dev/rockchip/rk3128/#_2","title":"\u9ad8\u7248\u672c\u5185\u6838\uff1f","text":"<p>\u5728\u542f\u52a8Debian\u7cfb\u7edf\u540e\uff0c\u5c1d\u8bd5\u4f7f\u7528resize2fs\u6269\u5c55\u5206\u533a\uff0c\u4f46\u662f\u63d0\u793a\u5185\u6838\u4e0d\u652f\u6301\uff0c\u8fd9\u91cc\u5e94\u8be5\u662f\u5185\u6838\u7248\u672c\u6bd4\u8f83\u8001\u5bfc\u81f4\u7684\u3002</p> <p>\u6b64\u5916\uff0c\u9ed8\u8ba4\u7684\u5185\u6838\u955c\u50cf\u4f7f\u80fd\u4e86ANDROID_PARANOID_NETWORK\u7f16\u8bd1\u9009\u9879\uff0c\u4f1a\u5bfc\u81f4\u7f51\u7edc\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u5177\u4f53\u73b0\u8c61\u89c1\u4e0a\u9762\u7684ping\u547d\u4ee4\u8f93\u51fa\u3002</p> <p>Rockchip\u5728github\u4e2d\u63d0\u4f9b\u4e86\u9ad8\u7248\u672c\u7684\u5185\u6838\uff0c\u5c1d\u8bd5\u4f7f\u75285.10\u5206\u652f\u7f16\u8bd1RK3128\u5e73\u53f0\u7684\u5185\u6838\uff0c\u4fee\u6539\u4ee3\u7801\u89e3\u51b3\u4e86\u51e0\u4e2a\u95ee\u9898\uff0c\u6210\u529f\u7f16\u8bd1\u51fa\u5185\u6838\u955c\u50cf\u53ca\u8bbe\u5907\u6811\u6587\u4ef6\uff0c\u4f46\u9057\u61be\u7684\u662f\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u4e0d\u786e\u5b9a\u662f\u4e2d\u65ad\u90e8\u5206\u8fd8\u662f\u65f6\u949f\u6811\u90e8\u5206\u5b58\u5728\u95ee\u9898\uff0c5.10\u7684\u5185\u6838\u6682\u65f6\u65e0\u6cd5\u542f\u52a8\uff0c\u8fd8\u9700\u8fdb\u884c\u4e00\u4e9b\u6392\u67e5\u3002</p> <p>\u5f85\u7eed...</p>"},{"location":"embedded-dev/sunxi/lichee/zero/","title":"\u8354\u679d\u6d3eZERO","text":"<p>\u8354\u679d\u6d3eZERO\u662fsipeed\u63a8\u51fa\u7684\u4e00\u6b3e\u57fa\u4e8e\u5168\u5fd7V3S SOC\u7684\u8ff7\u4f60\u5f00\u53d1\u677f\uff0c\u8be6\u7ec6\u4ed3\u5e93\u53ef\u4ee5\u4ece\u5b98\u65b9\u6587\u6863\u8fdb\u884c\u67e5\u770b\u3002</p>"},{"location":"embedded-dev/sunxi/lichee/zero/#boot-select","title":"Boot Select","text":"<p>V3S\u5185\u7f6e32KB BROM\uff0c\u542f\u52a8\u8fc7\u7a0b\u4e2d\u4f1a\u4f9d\u6b21\u68c0\u6d4bBSP Pin\u72b6\u6001\u3001SD\u5361\u955c\u50cf\u3001SPI flash\u955c\u50cf\u3002\u5982\u679cBSP Pin\u4e3a0\uff0c\u4f1a\u76f4\u63a5\u8fdb\u5165FEL\u6a21\u5f0f\uff0c\u5982\u679c\u5728SD\u5361\u6216SPI flash\u4e2d\u68c0\u6d4b\u5230\u6709\u6548\u955c\u50cf\uff0c\u5219\u4f1a\u4ece\u76f8\u5e94\u4ecb\u8d28\u4e2d\u8fdb\u884c\u542f\u52a8\u3002\u5982\u679cBSP Pin\u4e0d\u4e3a0\u4e14\u672a\u5728SD\u5361\u548cSPI flash\u4e2d\u68c0\u6d4b\u5230\u6709\u6548\u955c\u50cf\uff0c\u90a3\u4e48\u6700\u7ec8\u4e5f\u4f1a\u8fdb\u5165FEL\u6a21\u5f0f\u3002</p> <p>\u5728\u5168\u5fd7V3S\u7528\u6237\u624b\u518c\u4e2d\u5e76\u672a\u627e\u5230BSP Pin\u7684\u5177\u4f53\u8bf4\u660e\uff0c\u7f51\u4e0a\u8d44\u6599\u663e\u793a\uff0cBSP Pin\u662fSPI MISO\u5f15\u811a\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u786e\u5b9e\u6709\u6548\u3002</p>"},{"location":"embedded-dev/sunxi/lichee/zero/#fel-mode","title":"FEL MODE","text":"<p>\u5f53SOC\u8fdb\u5165FEL\u6a21\u5f0f\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7USB\u8fde\u63a5PC\u5e76\u4f7f\u7528sunxi-tools\u8fdb\u884c\u8bbe\u5907\u68c0\u6d4b\u548c\u955c\u50cf\u70e7\u5f55\u7b49\u64cd\u4f5c\u3002</p> <p>\u8fdb\u5165FEL\u6a21\u5f0f\u7684\u9014\u5f84\u9664\u4e0a\u8ff0Boot Select\u5916\u8fd8\u6709\u4ee5\u4e0b\u9014\u5f84\uff1a</p> <ol> <li>\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u7684SD\u5361\u955c\u50cf\uff0c\u955c\u50cf\u5236\u4f5c\u65b9\u6cd5\u5982\u4e0b\uff1a</li> </ol> <pre><code>wget https://github.com/linux-sunxi/sunxi-tools/raw/master/bin/fel-sdboot.sunxi\ndd if=fel-sdboot.sunxi of=/dev/sdX bs=1024 seek=8\n</code></pre> <ol> <li>\u5982\u679cU-Boot\u53ef\u7528\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u8fdb\u5165FEL\u6a21\u5f0f\uff1a</li> </ol> <pre><code>go 0xffff0020\n</code></pre> <p>\u4ee5\u4e0a\u4fe1\u606f\u5747\u6765\u81eahttps://linux-sunxi.org/FEL\u3002</p>"},{"location":"embedded-dev/sunxi/lichee/zero/#_1","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>https://linux-sunxi.org</li> </ul>"},{"location":"embedded-dev/usb/hid/","title":"HID\u62a5\u544a\u63cf\u8ff0\u7b26","text":""},{"location":"embedded-dev/usb/hid/#_1","title":"\u62a5\u544a\u63cf\u8ff0\u7b26\u76f8\u5173\u6559\u7a0b","text":"<p>Tutorial about USB HID Report Descriptors</p> <p>USB HID\u62a5\u544a\u63cf\u8ff0\u7b26\u6559\u7a0b</p>"},{"location":"embedded-dev/usb/hid/#linuxhid","title":"Linux\u4e0b\u67e5\u770b\u8bbe\u5907HID","text":"<p>\u4f9d\u8d56<code>usbutils</code>\u548c<code>hidrd</code>\u8f6f\u4ef6\u5305\uff0c\u9700\u8981\u81ea\u884c\u4e0b\u8f7d\u5b89\u88c5\u3002</p>"},{"location":"embedded-dev/usb/hid/#debugfs","title":"\u4f7f\u7528debugfs\u67e5\u770b","text":"<pre><code>$ # \u76f4\u63a5\u5bfc\u51fa\u63cf\u8ff0\u7b26\u67e5\u770b\n$ cat /sys/kernel/debug/hid/0003\\:04F3\\:0103.0001/rdesc\n05 01 09 06 a1 01 05 08 19 01 29 03 15 00 25 01 75 01 95 03 91 02 95 05 91 01 05 07 19 e0 29 e7 95 08 81 02 75 08 95 01 81 01 19 00 29 91 26 ff 00 95 06 81 00 c0\n\n  INPUT[INPUT]\nField(0)\nApplication(GenericDesktop.Keyboard)\nUsage(8)\nKeyboard.00e0\n        Keyboard.00e1\n        Keyboard.00e2\n        Keyboard.00e3\n        Keyboard.00e4\n        Keyboard.00e5\n        Keyboard.00e6\n        Keyboard.00e7\n      Logical Minimum(0)\nLogical Maximum(1)\nReport Size(1)\nReport Count(8)\nReport Offset(0)\nFlags( Variable Absolute )\nField(1)\nApplication(GenericDesktop.Keyboard)\n\n...\n\n$ # \u4f7f\u7528hidrd-convert\u5de5\u5177\u8f6c\u6362\u683c\u5f0f\n$ cat /sys/kernel/debug/hid/0003\\:04F3\\:0103.0001/rdesc | head -n1 | xxd -r -p | hidrd-convert -o spec\nUsage Page (Desktop),               ; Generic desktop controls (01h)\nUsage (Keyboard),                   ; Keyboard (06h, application collection)\nCollection (Application),\n    Usage Page (LED),               ; LEDs (08h)\nUsage Minimum (01h),\n    Usage Maximum (03h),\n    Logical Minimum (0),\n    Logical Maximum (1),\n    Report Size (1),\n    Report Count (3),\n    Output (Variable),\n    Report Count (5),\n    Output (Constant),\n    Usage Page (Keyboard),          ; Keyboard/keypad (07h)\nUsage Minimum (KB Leftcontrol), ; Keyboard left control (E0h, dynamic value)\nUsage Maximum (KB Right GUI),   ; Keyboard right GUI (E7h, dynamic value)\nReport Count (8),\n    Input (Variable),\n    Report Size (8),\n    Report Count (1),\n    Input (Constant),\n    Usage Minimum (None),           ; No event (00h, selector)\nUsage Maximum (KB LANG2),       ; Keyboard LANG2 (91h, selector)\nLogical Maximum (255),\n    Report Count (6),\n    Input,\nEnd Collection\n</code></pre>"},{"location":"embedded-dev/usb/hid/#usbutils","title":"\u4f7f\u7528usbutils\u8fdb\u884c\u67e5\u770b","text":"<pre><code>$ # \u5bfc\u51fa\u539f\u59cb\u683c\u5f0f\n$ usbhid-dump -d 04f3 -i 255\n006:002:001:DESCRIPTOR         1668584980.090532\n 05 0C 09 01 A1 01 85 01 19 00 2A 3C 02 15 00 26\n3C 02 95 01 75 10 81 00 C0 05 01 09 80 A1 01 85\n02 19 81 29 83 15 00 25 01 75 01 95 03 81 02 95\n05 81 01 C0\n\n006:002:000:DESCRIPTOR         1668584980.094501\n 05 01 09 06 A1 01 05 08 19 01 29 03 15 00 25 01\n75 01 95 03 91 02 95 05 91 01 05 07 19 E0 29 E7\n 95 08 81 02 75 08 95 01 81 01 19 00 29 91 26 FF\n 00 95 06 81 00 C0\n\n$ # \u4f7f\u7528hidrd-convert\u5de5\u5177\u8f6c\u6362\u683c\u5f0f\n$ usbhid-dump -d 04f3 -i 255 | grep -v : | xxd -r -p | hidrd-convert -o spec\nUsage Page (Consumer),              ; Consumer (0Ch)\nUsage (Consumer Control),           ; Consumer control (01h, application collection)\nCollection (Application),\n    Report ID (1),\n    Usage Minimum (00h),\n    Usage Maximum (AC Format),      ; AC format (023Ch, selector)\nLogical Minimum (0),\n    Logical Maximum (572),\n    Report Count (1),\n    Report Size (16),\n    Input,\nEnd Collection,\nUsage Page (Desktop),               ; Generic desktop controls (01h)\nUsage (Sys Control),                ; System control (80h, application collection)\nCollection (Application),\n    Report ID (2),\n    Usage Minimum (Sys Power Down), ; System power down (81h, one-shot control)\nUsage Maximum (Sys Wake Up),    ; System wake up (83h, one-shot control)\nLogical Minimum (0),\n    Logical Maximum (1),\n    Report Size (1),\n    Report Count (3),\n    Input (Variable),\n    Report Count (5),\n    Input (Constant),\nEnd Collection,\nUsage Page (Desktop),               ; Generic desktop controls (01h)\nUsage (Keyboard),                   ; Keyboard (06h, application collection)\nCollection (Application),\n    Usage Page (LED),               ; LEDs (08h)\nUsage Minimum (01h),\n    Usage Maximum (03h),\n    Logical Minimum (0),\n    Logical Maximum (1),\n    Report Size (1),\n    Report Count (3),\n    Output (Variable),\n    Report Count (5),\n    Output (Constant),\n    Usage Page (Keyboard),          ; Keyboard/keypad (07h)\nUsage Minimum (KB Leftcontrol), ; Keyboard left control (E0h, dynamic value)\nUsage Maximum (KB Right GUI),   ; Keyboard right GUI (E7h, dynamic value)\nReport Count (8),\n    Input (Variable),\n    Report Size (8),\n    Report Count (1),\n    Input (Constant),\n    Usage Minimum (None),           ; No event (00h, selector)\nUsage Maximum (KB LANG2),       ; Keyboard LANG2 (91h, selector)\nLogical Maximum (255),\n    Report Count (6),\n    Input,\nEnd Collection\n</code></pre>"},{"location":"embedded-dev/usb/hid/#boot-interface-descriptor","title":"Boot Interface Descriptor","text":"<p>USB HID\u89c4\u8303\u4e2d\u5199\u5230 Set_Protocol Request \u53ef\u4ee5\u5728boot protocol\u548creport protocol\u4e2d\u8fdb\u884c\u5207\u6362\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u56fa\u4ef6\uff08\u6bd4\u5982UEFI\uff09\u4e2d\u5bf9USB\u952e\u76d8\u53ea\u652f\u6301boot protocol\uff0c\u5728\u5bf9USB\u952e\u76d8\u7684\u521d\u59cb\u5316\u6d41\u7a0b\u4e2d\u4f1a\u4f7f\u7528 Set_Protocol Request \u5c06\u952e\u76d8\u8bbe\u7f6e\u4e3aboot protocol\uff0cboot protocol\u7684\u5b9a\u4e49\u662f\u517c\u5bb9report protocol\u7684\uff0c\u5728HID\u89c4\u8303\u9644\u5f55B.2\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u63cf\u8ff0\u7b26\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u63cf\u8ff0\u7b26\u5185\u5bb9\u5982\u4e0b</p> <pre><code>Usage Page (Generic Desktop),\nUsage (Keyboard),\nCollection (Application),\n  Report Size (1),\n  Report Count (8),\n  Usage Page (Key Codes),\n  Usage Minimum (224),\n  Usage Maximum (231),\n  Logical Minimum (0),\n  Logical Maximum (1),\n  Input (Data, Variable, Absolute),\n  Report Count (1),\n  Report Size (8),\n  Input (Constant),\n  Report Count (5),\n  Report Size (1),\n  Usage Page (LEDs),\n  Usage Minimum (1),\n  Usage Maximum (5),\n  Output (Data, Variable, Absolute),\n  Report Count (1),\n  Report Size (3),\n  Output (Constant),\n  Report Count (6),\n  Report Size (8),\n  Logical Minimum (0),\n  Logical Maximum(255),\n  Usage Page (Key Codes),\n  Usage Minimum (0),\n  Usage Maximum (255),\n  Input (Data, Array),\nEnd Collection\n</code></pre>"},{"location":"projects/epd-clock/","title":"EPD-Clock","text":""},{"location":"projects/epd-clock/#_1","title":"\u7b80\u4ecb","text":"<p>\u4f7f\u7528hanshuo\u7535\u5b50\u4ef7\u7b7e\u4e2d\u76842.9\u5bf8\u58a8\u6c34\u5c4f\u3001MSP430G2553\u5355\u7247\u673a\u4ee5\u53caspi nor flash\u7b49\u5143\u4ef6\u8bbe\u8ba1\u5236\u4f5c\u4e86\u4e00\u6b3e\u91c7\u7528\u5355\u82827\u53f7\u5e72\u7535\u6c60\u4f9b\u7535\u7684\u65f6\u949f\u3002\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u5728\u6bcf\u5929\u5de5\u4f5c16\u5c0f\u65f6\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u8282\u5e72\u7535\u6c60\u53ef\u4f9b\u5176\u8fde\u7eed\u5de5\u4f5c6\u4e2a\u6708\u5de6\u53f3\u3002</p> <p></p> <p>\u8be6\u7ec6\u5185\u5bb9\u89c1github\u6216gitee\u3002</p>"},{"location":"projects/epd-clock/#_2","title":"\u540e\u7eed","text":"<p>\u5728\u73b0\u6709\u8bbe\u8ba1\u7684\u57fa\u7840\u4e0a\uff0c\u4f7f\u7528\u767d\u5ad6\u7684ESP32C3\u6a21\u5757\u5bf9\u65f6\u949f\u8fdb\u884c\u4e86\u91cd\u65b0\u8bbe\u8ba1\uff0c\u65b0\u589e\u7684\u529f\u80fd\u4e3b\u8981\u4e3a\u7f51\u7edc\u6821\u65f6\uff0c\u5b9e\u65f6\u5929\u6c14\u83b7\u53d6\u7b49\uff1b\u76f8\u5e94\u7684\uff0c\u4f9b\u7535\u4e5f\u66f4\u6539\u4e3a\u9502\u7535\u6c60\u4f9b\u7535\u3002\u7535\u8def\u53ca\u4ee3\u7801\u5b9e\u73b0\u76ee\u524d\u5747\u5f88\u7b80\u964b\uff0c\u4e0d\u8fc7\u80fd\u7528:)\u3002\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u5728\u4f7f\u7528600mah\u7535\u6c60\u4f9b\u7535\uff0c\u6bcf\u5929\u5de5\u4f5c16\u5c0f\u65f6\uff0c\u6bcf\u5c0f\u65f6\u66f4\u65b0\u4e00\u6b21\u5929\u6c14\u548c\u65f6\u949f\u7684\u60c5\u51b5\u4e0b\u53ef\u8fde\u7eed\u5de5\u4f5c50\u5929\u5de6\u53f3\u3002</p> <p></p> <p>\u8be6\u7ec6\u5185\u5bb9\u89c1github\u6216gitee\u7684<code>esp32c3</code>\u5206\u652f\u3002</p>"},{"location":"projects/serprog/","title":"serprog","text":""},{"location":"projects/serprog/#_1","title":"\u6982\u8ff0","text":"<p>serprog\u662fflashrom\u652f\u6301\u7684\u4f17\u591a\u7f16\u7a0b\u5668\u4e2d\u7684\u4e00\u79cd\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e32\u53e3\u64cd\u4f5c\u5355\u7247\u673a\u6765\u7ed9spi flash\u7f16\u7a0b\uff0c\u5728flashrom\u7684wiki\u4e2d\u4ecb\u7ecd\u4e86\u591a\u79cd\u5e73\u53f0\u7684\u5b9e\u73b0\u3002</p> <p>\u6211\u6700\u5f00\u59cb\u662f\u4eceLinux \u4e0b\u79bb\u7ebf\u70e7\u5199 SPI \u95ea\u5b58\u8fd9\u7bc7\u535a\u5ba2\u4e2d\u4e86\u89e3\u5230\u8fd9\u79cd\u7f16\u7a0b\u5668\uff0c\u5bf9\u6b64\u6bd4\u8f83\u611f\u5174\u8da3\uff0c\u4e8e\u662f\u4ed4\u7ec6\u9605\u8bfb\u4e86\u4e00\u4e0b\u539f\u535a\u4e3b\u7684\u6587\u7ae0\u548c\u4ee3\u7801\u4ed3\u5e93\uff0c\u5e76\u5bf9serprog\u7684\u534f\u8bae\u8fdb\u884c\u4e86\u7814\u8bfb\u3002</p>"},{"location":"projects/serprog/#lpc-serprog","title":"lpc-serprog","text":"<p>\u63a5\u4e0a\u6587\uff0c\u6b63\u597d\u6709\u4e00\u5757lpc54114-lite\u5f00\u53d1\u677f\uff0c\u8be5\u5f00\u53d1\u677f\u6709\u4e00\u7247\u677f\u8f7dspi flash\uff0c\u800c\u4e14\u5fae\u63a7\u5236\u5668\u5177\u6709usb\u8bbe\u5907\u5916\u8bbe\uff0c\u6070\u597d\u53ef\u4ee5\u6ee1\u8db3\u8981\u6c42\uff0c\u4e8e\u662f\u4fbf\u5728\u8be5\u5f00\u53d1\u677f\u4e0a\u8fdb\u884c\u4e86\u7b80\u5355\u5b9e\u73b0\u3002</p> <p>\u4ee3\u7801\u7f16\u5199\u5b8c\u6210\u540e\u8fdb\u884c\u4e86\u7b80\u5355\u7684\u6d4b\u8bd5\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code># \u8bfbflash, W25X80, 1MiB\n$ time sudo flashrom -p serprog:dev=/dev/ttyACM0:4000000 -c W25X80 -r /tmp/test.bin\nflashrom  on Linux 4.19.0-16-amd64 (x86_64)\nflashrom is free software, get the source code at https://flashrom.org\n\nUsing clock_gettime for delay loops (clk_id: 1, resolution: 1ns).\nserprog: Programmer name is \"lpc-serprog\"\nFound Winbond flash chip \"W25X80\" (1024 kB, SPI) on serprog.\nReading flash... done.\n\nreal    0m3.106s\nuser    0m1.163s\nsys     0m0.055s\n\n# \u64e6\u9664flash, W25X80, 1MiB\n$ time sudo flashrom -p serprog:dev=/dev/ttyACM0:4000000 -c W25X80 -E\nflashrom  on Linux 4.19.0-16-amd64 (x86_64)\nflashrom is free software, get the source code at https://flashrom.org\n\nUsing clock_gettime for delay loops (clk_id: 1, resolution: 1ns).\nserprog: Programmer name is \"lpc-serprog\"\nFound Winbond flash chip \"W25X80\" (1024 kB, SPI) on serprog.\nErasing and writing flash chip... Erase/write done.\n\nreal    0m25.594s\nuser    0m23.017s\nsys     0m0.065s\n\n# \u5199flash, W25X80, 1MiB\n$ time sudo flashrom -p serprog:dev=/dev/ttyACM0:4000000 -c W25X80 -w /tmp/test.bin \nflashrom  on Linux 4.19.0-16-amd64 (x86_64)\nflashrom is free software, get the source code at https://flashrom.org\n\nUsing clock_gettime for delay loops (clk_id: 1, resolution: 1ns).\nserprog: Programmer name is \"lpc-serprog\"\nFound Winbond flash chip \"W25X80\" (1024 kB, SPI) on serprog.\nReading old flash chip contents... done.\nErasing and writing flash chip... Erase/write done.\nVerifying flash... VERIFIED.\n\nreal    0m17.041s\nuser    0m2.757s\nsys     0m0.717s\n</code></pre> <p>flashrom\u5728\u4f7f\u7528serprog\u8fdb\u884c\u64cd\u4f5c\u65f6\uff0c\u5728sync\u547d\u4ee4\u9636\u6bb5\u4f1a\u82b1\u8d391s\u7684\u65f6\u95f4\uff0c\u9664\u53bbsync\u9636\u6bb51s\u7684\u65f6\u95f4\u6765\u770b\u8bfb\u5199\u901f\u5ea6\u8fd8\u662f\u4e0d\u9519\u7684\uff0c\u867d\u7136\u76f8\u8f83\u4e8e\u539f\u535a\u4e3b\u7684\u5b9e\u73b0\u8bfb\u5199\u901f\u5ea6\u7565\u6709\u4e0d\u6025\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u5e76\u672a\u505a\u592a\u591a\u4f18\u5316\uff0c\u800c\u4e14\u65e5\u5e38\u62ff\u6765\u4f7f\u7528\u4e5f\u591f\u7528\u4e86\u3002</p> <p>\u4e0a\u8ff0\u5b9e\u73b0\u7684\u4ee3\u7801\u76ee\u524d\u5206\u522b\u6258\u7ba1\u4e8egithub\u4ee5\u53cagitee\u3002</p>"},{"location":"projects/serprog/#stm32-serprog","title":"stm32-serprog","text":"<p>\u4e3a\u4e86\u540c\u65f6\u652f\u63013.3V\u4e0e1.8V spi flash\u8bfb\u5199\u7684\u652f\u6301\uff0c\u53c2\u8003Linux \u4e0b\u79bb\u7ebf\u70e7\u5199 SPI \u95ea\u5b58\u6587\u7ae0\u4e2dgithub\u4ed3\u5e93\u4e2d\u7684\u539f\u7406\u56fe\u7ed8\u5236\u4e86\u4e00\u5757PCB\uff0c\u5e76\u589e\u52a0\u4e86\u7535\u5e73\u8f6c\u6362\u82af\u7247\u548c\u5207\u6362\u5f00\u5173\uff0c\u7531\u4e8e\u76ee\u524d\u6070\u597d\u6709\u51e0\u7247stm32f103R8T6\uff0c\u4fbf\u4f7f\u7528\u8be5\u5fae\u63a7\u5236\u5668\u4f5c\u4e3astm32-serprog\u7684\u4e3b\u63a7\uff0c\u4f7f\u7528\u4e00\u7247txs0108\u6765\u505a\u7535\u5e73\u8f6c\u6362\uff08\u5176\u5b9e\u8fd9\u91cc\u4f7f\u7528txs0104/txb0104\u4fbf\u53ef\u4ee5\u4e86\uff0c\u4e0d\u8fc7\u7ed8\u5236\u539f\u7406\u56fe\u65f6\u672a\u6ce8\u610f\u5230\uff0c\u56e0\u6b64\u4f7f\u7528\u4e86txs0108\uff0cv0.2\u5df2\u7ecf\u505a\u4e86\u4fee\u6539\uff09\uff0c\u7a0b\u5e8f\u7684\u8bdd\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u539f\u535a\u4e3b\u4ed3\u5e93\u4e2d\u7684\u4ee3\u7801\uff0cpcb\u6548\u679c\u5982\u5982\u4e0b\u3002</p> <p></p> <p>\u8be5\u9879\u76ee\u8be6\u7ec6\u60c5\u51b5\u53ef\u4ee5\u5728ieiao/stm32-serprog\u4e2d\u67e5\u770b\u3002</p>"},{"location":"tools/gcc/","title":"GCC","text":""},{"location":"tools/gcc/#_1","title":"\u6307\u5b9a\u5b57\u7b26\u7f16\u7801","text":"<p><code>-finput-charset</code>\u6307\u5b9a\u6e90\u6587\u4ef6\uff08\u4fdd\u5b58\u6587\u4ef6\u65f6\u9009\u62e9\uff09\u7684\u7f16\u7801\u65b9\u5f0f\uff08\u82e5\u4e0d\u6307\u5b9a\uff0c\u7f16\u8bd1\u5668\u9ed8\u8ba4\u662fUTF-8\uff09 <code>-fexec-charset</code>\u6307\u5b9a\u53ef\u6267\u884c\u7a0b\u5e8f\u4e2d\u7684\u5b57\u7b26\u4ee5\u4ec0\u4e48\u7f16\u7801\u65b9\u5f0f\u6765\u8868\u793a\uff0c\u9ed8\u8ba4\u662fUTF-8</p> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6bd4\u8f83\u6709\u7528\u7684\uff0c\u5f53\u4f7f\u7528gcc\u5f00\u53d1\u5355\u7247\u673a\u663e\u793a\u76f8\u5173\u7a0b\u5e8f\u65f6\u82e5\u4f7f\u7528\u7684\u5b57\u5e93\u662fGBK\u6216GB2312\u7f16\u7801\u65f6\u9700\u8981\u4f7f\u7528\u8fd9\u4e2a\u53c2\u6570\u6765\u6307\u5b9a\u7a0b\u5e8f\u4e2d\u5b57\u7b26\u4e32\u7684\u7f16\u7801\u3002</p>"},{"location":"tools/gcc/#_2","title":"\u53bb\u9664\u672a\u7528\u5230\u7684\u51fd\u6570","text":"<p>\u5728\u7f16\u8bd1\u65f6\u6dfb\u52a0<code>-ffunction-sections -fdata-sections</code>\u53c2\u6570\uff0c\u5728\u94fe\u63a5\u65f6\u6dfb\u52a0<code>-Wl,-gc-sections</code>\u53c2\u6570\u5373\u53ef\u81ea\u52a8\u53bb\u9664\u672a\u4f7f\u7528\u7684\u51fd\u6570\uff0c\u51cf\u5c0f\u4ee3\u7801\u4e8c\u8fdb\u5236\u4f53\u79ef\u3002</p>"},{"location":"tools/gcc/#_3","title":"\u91cd\u5b9a\u5411","text":"<p>\u5d4c\u5165\u5f0f\u5f00\u53d1\u4e2d\u53ef\u4ee5\u5c06<code>printf</code>\u51fd\u6570\u8fdb\u884c\u91cd\u5b9a\u5411\u4ee5\u4fbf\u53ef\u4ee5\u4f7f\u7528<code>printf</code>\u51fd\u6570\u8fdb\u884c\u683c\u5f0f\u5316\u8f93\u51fa\u3002</p> <p>\u589e\u52a0<code>_write</code>\u51fd\u6570\u7684\u81ea\u5b9a\u4e49\u5b9e\u73b0\uff0c\u5728\u81ea\u5b9a\u4e49\u5b9e\u73b0\u7684\u51fd\u6570\u4e2d\u5c06buf\u4e2d\u7684\u6570\u636e\u901a\u8fc7\u4e32\u53e3\u8fdb\u884c\u53d1\u9001\u5373\u53ef\u5b9e\u73b0\u91cd\u5b9a\u5411\uff0c\u8be5\u51fd\u6570\u539f\u578b\u5982\u4e0b:</p> <pre><code>int _write (int fd, const void *buf, size_t count);\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>\\n</code>\u9700\u8981\u505a\u7279\u6b8a\u5904\u7406\uff0c\u5f53\u68c0\u6d4b\u5230\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4e3a<code>\\n</code>\u65f6\uff0c\u9700\u8981\u989d\u5916\u589e\u52a0\u4e00\u4e2a<code>\\r</code>\u5b57\u7b26\uff0c\u8fd9\u6837\u4fbf\u7b26\u5408Linux\u7cfb\u7edf\u4e0b\u7684\u4f7f\u7528\u60c5\u51b5\u4e86\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u5b9e\u4f8b\uff1a</p> <pre><code>int _write (int fd, const void *buf, size_t count)\n{\nuint8_t *p = (uint8_t *)buf;\n(void) fd;\nUSART_WriteBlocking(USART0, p, count);\nif (*(p+count-1) == '\\n')\nUSART_WriteByte(USART0, '\\r');\nreturn count;\n}\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u9700\u5728\u94fe\u63a5\u9636\u6bb5\u589e\u52a0<code>--specs=nano.specs --specs=nosys.specs</code>\u53c2\u6570\u4ee5\u4f7f\u80fd\u91cd\u5b9a\u5411(retarget)\u5e76\u4f7f\u7528nano\u7248\u672c\u7684libc\uff0c\u51cf\u5c0fflash\u53caram\u7684\u6d88\u8017\u3002</p>"},{"location":"tools/gcc/#_4","title":"\u53c2\u6570\u4f20\u9012","text":"<p>\u53ef\u4ee5\u901a\u8fc7<code>-Wl,option</code>\u53c2\u6570\u6765\u4f20\u9012\u53c2\u6570\u7ed9\u94fe\u63a5\u5668\uff1b\u540c\u7406\uff0c\u901a\u8fc7<code>-Wa,option</code>\u53ef\u4ee5\u4f20\u9012\u53c2\u6570\u7ed9\u6c47\u7f16\u5668\u3002</p>"},{"location":"tools/gcc/#_5","title":"\u751f\u6210\u4f9d\u8d56\u5173\u7cfb","text":"<p>\u5728\u4f7f\u7528Makefile\u7ec4\u7ec7\u9879\u76ee\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728CFLAGS\u4e2d\u589e\u52a0<code>-MMD -MP</code>\u53c2\u6570\uff0c\u8fd9\u6837GCC\u4fbf\u4f1a\u751f\u6210Makefile\u98ce\u683c\u7684\u4f9d\u8d56\u6587\u4ef6\uff0c\u501f\u52a9\u8fd9\u4e9b\u4f9d\u8d56\u6587\u4ef6\u4fbf\u53ef\u4ee5\u5b9e\u73b0\u4fee\u6539\u5934\u6587\u4ef6\u540e\u81ea\u52a8\u91cd\u65b0\u7f16\u8bd1\u6240\u6709\u76f8\u5173\u7684\u6e90\u7801\u3002</p>"},{"location":"tools/git/","title":"Git","text":""},{"location":"tools/git/#_1","title":"\u5e38\u7528\u64cd\u4f5c","text":""},{"location":"tools/git/#_2","title":"\u4ee3\u7801\u5408\u5e76","text":"<ul> <li>merge</li> <li>rebase</li> </ul>"},{"location":"tools/git/#_3","title":"\u6458\u53d6\u63d0\u4ea4","text":"<ul> <li>cherry-pick</li> </ul>"},{"location":"tools/git/#commit","title":"\u4fee\u6539\u67d0\u4e2acommit","text":"<pre><code># \u4fee\u6539\u4e4b\u524d\u7684\u67d0\u4e2a\u63d0\u4ea4\uff0ccommit-id\u4e3a\u60f3\u4fee\u6539\u7684\u63d0\u4ea4\u4e4b\u524d\u7684\u90a3\u4e2a\u63d0\u4ea4\ngit rebase -i commit-id\n</code></pre>"},{"location":"tools/git/#_4","title":"\u67e5\u770b\u67d0\u884c\u4ee3\u7801\u7684\u63d0\u4ea4\u8bb0\u5f55","text":"<pre><code># \u67e5\u770b\u67d0\u884c\u4ee3\u7801\u7684\u63d0\u4ea4\u8bb0\u5f55\ngit blame -L line\n</code></pre>"},{"location":"tools/git/#add","title":"add\u67d0\u4e00\u884c\u6216\u8005\u67d0\u51e0\u884c","text":"<pre><code>git add -p\n</code></pre> <p>\u6216\u8005\u4f7f\u7528tig\uff0c\u76f4\u63a5\u5728Unstaged changes\u4e2d\u7684\u67d0\u4e00\u884c\u63091\u53ef\u4ee5\u5207\u6362\u8fd9\u4e00\u884c\u7684\u72b6\u6001</p>"},{"location":"tools/hexdump/","title":"Hexdump","text":"<p>hexdump, hd \u2014 ASCII, decimal, hexadecimal, octal dump</p> <p>The hexdump utility is a filter which displays the specified files, or the standard input, if no files are specified, in a user specified format.</p> <p>hexdump\u9664\u4e86\u76f4\u63a5\u67e5\u770b\u4e8c\u8fdb\u5236\u6587\u4ef6\u4ee5\u5916\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5176\u683c\u5f0f\u5316\u8f93\u51fa\u529f\u80fd\u5b9e\u73b0\u4e00\u4e9b\u6bd4\u8f83\u65b9\u4fbf\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u4e3a16\u8fdb\u5236\u6587\u672c\u6587\u4ef6\uff0c\u4f7f\u7528<code>-e</code>\u53c2\u6570\u6765\u6307\u5b9a\u683c\u5f0f\uff0cman\u624b\u518c\u4e2d\u63d0\u4f9b\u7684\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code># hex bytes\n% echo hello | hexdump -v -e '/1 \"%02X \"' ; echo\n68 65 6C 6C 6F 0A\n\n# same, with ASCII section\n% echo hello | hexdump -e '8/1 \"%02X \"\"\\t\"\" \"' -e '8/1 \"%c\"\"\\n\"'\n68 65 6C 6C 6F 0A        hello\n</code></pre> <p>\u4e24\u4e2a\u793a\u4f8b\u7684\u529f\u80fd\u5206\u522b\u5982\u4e0b\uff1a</p> <ul> <li>\u6bcf\u6b21\u8bfb\u53d6\u4e00\u4e2a\u5b57\u8282\uff0c\u5e76\u4f7f\u7528<code>%02X</code>\u683c\u5f0f\u6765\u683c\u5f0f\u5316\u8f93\u51fa</li> <li>\u7b2c\u4e00\u4e2a<code>-e</code>\u542b\u4e49\u4e3a\u6bcf\u6b21\u8bfb\u53d6\u4e00\u4e2a\u5b57\u8282\uff0c\u4ee58\u5b57\u8282\u4e3a\u4e00\u7ec4\u4f7f\u7528<code>\"%02X \"\"\\t\"\" \"</code>\u683c\u5f0f\u6765\u683c\u5f0f\u5316\u8f93\u51fa\uff0c\u7b2c\u4e8c\u4e2a\u540c\u7406</li> </ul> <p>\u6240\u4ee5\uff0c\u5c06\u7b2c\u4e8c\u4e2a\u793a\u4f8b\u7684\u8f93\u5165\u4fee\u6539\u4e3a\u5927\u4e8e8\u4e2a\u5b57\u7b26\u65f6\uff0c\u5176\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>$ echo helloooo | hexdump -e '8/1 \"%02X \"\"\\t\"\" \"' -e '8/1 \"%c\"\"\\n\"'\n68 65 6C 6C 6F 6F 6F 6F  helloooo\n0A                       </code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5408\u7406\u7684\u4f7f\u7528\u683c\u5f0f\u5316\u8f93\u51fa\u53ef\u4ee5\u5b9e\u73b0\u5404\u79cd\u5f62\u5f0f\u7684\u4e8c\u8fdb\u5236\u548c\u5b57\u7b26\u8f6c\u6362\u3002</p> <p>\u4f8b\u5982\u5728\u8c03\u8bd5verilog\u7a0b\u5e8f\u4e2d\u9700\u8981\u751f\u6210\u4e00\u4e9b\u6c47\u7f16\u6307\u4ee4\u7801\u6ce8\u5165rom\u6a21\u5757\uff0c\u901a\u5e38\u6211\u4eec\u4f7f\u7528\u6c47\u7f16\u7f16\u5199\u9700\u8981\u7684\u7a0b\u5e8f\u5e76\u7f16\u8bd1\u751f\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u7136\u540e\u5c06\u5176\u8f6c\u6362\u4e3a16\u8fdb\u5236ascii\u6587\u4ef6\u5e76\u901a\u8fc7testbench\u8fdb\u884c\u8bfb\u53d6\uff0c\u8fd9\u4fbf\u9700\u8981\u4e00\u4e2a\u7a0b\u5e8f\u6765\u5b8c\u6210\u8f6c\u6362\u5de5\u4f5c\u3002</p> <p>\u5047\u8bbe\u6709\u4e00\u4e2a\u9700\u8981\u8f6c\u6362\u7684bin\u6587\u4ef6\uff0c\u5176\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>$ hexdump -C inst_rom.bin 00000000  00 11 01 34 20 00 21 34  00 44 21 34 44 00 21 34  |...4 .!4.D!4D.!4|\n00000010  02 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000020  00 00 00 00 00 00 00 00  00 00 20 01 01 00 00 03  |.......... .....|\n00000030  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|\n00000040\n</code></pre> <p>\u9700\u8981\u5c06\u5176\u4ee54\u5b57\u8282\u4e3a\u5355\u4f4d\u8f6c\u6362\u4e3aascii\u6587\u4ef6\uff0c\u8fd9\u65f6\u5019hexdump\u4fbf\u53ef\u4ee5\u51fa\u9a6c\u4e86\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4:</p> <pre><code>$ hexdump -v -e '/4 \"%08x\\n\"' inst_rom.bin\n34011100\n34210020\n34214400\n34210044\n00000002\n00000000\n00000000\n00000000\n00000000\n00000000\n01200000\n03000001\n00000000\n00000000\n00000001\n00000000\n</code></pre> <p>bingo!</p> <p>\u5df2\u7ecf\u975e\u5e38\u5b8c\u7f8e\u7684\u8f6c\u6362\u51fa\u6765\u4e86\uff0c\u53ea\u8981\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u4e2d\u4fbf\u5b8c\u7f8e\u7684\u89e3\u51b3\u95ee\u9898\u4e86\u3002</p>"},{"location":"tools/linux_tips/","title":"Linux Tips","text":"<p>Linux\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e9b\u5c0f\u5de5\u5177\u3001\u8f6f\u4ef6\u914d\u7f6e\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9b\u5c0f\u73a9\u610f\u513f</p> <ul> <li>linux\u4e2d\u6700\u7b80\u5355\u751f\u6210\u4e00\u4e2auuid\u7684\u65b9\u6cd5</li> </ul> <pre><code>$ cat /proc/sys/kernel/random/uuid\n</code></pre> <ul> <li>\u5c06sd\u5361/U\u76d8\u683c\u5f0f\u5316\u4e3a\u65e0\u5206\u533a\u7684\u6837\u5b50\uff0c\u5176\u5b9e\u662f\u8986\u76d6\u4e86MBR</li> </ul> <pre><code>$ sudo mkfs.vfat -F 32 -I /d\n</code></pre> <ul> <li>\u68c0\u6d4b\u7f51\u7ebf\u63d2\u62d4</li> </ul> <pre><code>$ /sys/class/net/eth0/carrier\n</code></pre> <ul> <li>32\u4f4d\u8fd0\u884c\u5e93</li> </ul> <pre><code>$ apt install lib32z1\n</code></pre> <ul> <li>\u5b57\u7b26\u8f6c\u827a\u672f\u5b57</li> </ul> <pre><code>$ figlet\n</code></pre> <ul> <li>linux\u67e5\u770b\u8fd0\u884c\u65f6\u957f</li> </ul> <pre><code>$ cat /proc/uptime\n</code></pre> <ul> <li>\u53cd\u5411\u67e5\u8be2\u547d\u4ee4\u884c\u5386\u53f2\u8bb0\u5f55\uff0c\u8d85\u5b9e\u7528</li> </ul> <pre><code>$ Ctrl+r\n</code></pre> <ul> <li>linux\u4e32\u53e3\u5de5\u5177</li> </ul> <pre><code>$ picocom\n$ minicom\n$ cutecom\n</code></pre> <ul> <li>\u4e32\u53e3\u63d2\u62d4\u9ed8\u8ba4\u65e0\u901a\u77e5\uff0c\u53ef\u4ee5\u589e\u52a0\u4e00\u4e9b\u4e2audev\u901a\u77e5\u6765\u5b9e\u73b0</li> </ul> <pre><code>ACTION==\"add\", KERNEL==\"ttyUSB*[0-9]\", SUBSYSTEM==\"tty\", RUN+=\"/sbin/runuser -l $user -c 'notify-send %k \u4e32\u53e3\u5df2\u63d2\u5165'\"\nACTION==\"remove\", KERNEL==\"ttyUSB*[0-9]\", SUBSYSTEM==\"tty\", RUN+=\"/sbin/runuser -l $user -c 'notify-send %k \u4e32\u53e3\u5df2\u62d4\u51fa'\"\n</code></pre> <ul> <li>\u6587\u672c\u8f6c\u6570\u7ec4\uff0c\u547d\u4ee4\u884c\u4e00\u952e\u751f\u6210\u5934\u6587\u4ef6</li> </ul> <pre><code>$ xxd -i file\n</code></pre> <ul> <li>kde\u7f51\u7edc\u8bbe\u7f6e\u4e2d\u5bfc\u5165openvpn\u914d\u7f6e</li> </ul> <p>\u7cfb\u7edf\u8bbe\u7f6e&gt;\u8fde\u63a5&gt;\u6dfb\u52a0\u8fde\u63a5&gt;\u5bfc\u5165vpn\u8fde\u63a5</p> <p>\u5982\u679c.ovpn\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542btls-crypt\u5b57\u6bb5\uff0c\u8fd8\u9700\u8981\u5728\u9ad8\u7ea7\u8bbe\u7f6e\u4e2d\u5bf9TLS\u8fdb\u884c\u8bbe\u7f6e</p> <ul> <li>nfs\u670d\u52a1\u914d\u7f6e\u6587\u4ef6</li> </ul> <pre><code>$ /etc/exports\n</code></pre> <ul> <li>mount\u7ed1\u5b9a\u76ee\u5f55</li> </ul> <pre><code>$ sudo mount --bind src dest\n</code></pre> <ul> <li>kvm\u542f\u52a8\u5931\u8d25,\u63d0\u793a<code>\u542f\u52a8\u57df\u65f6\u51fa\u9519: \u6240\u9700\u64cd\u4f5c\u65e0\u6548\uff1a\u7f51\u7edc 'default' \u672a\u6fc0\u6d3b</code></li> </ul> <pre><code>$ sudo virsh net-start default\n</code></pre> <ul> <li>getopt\u547d\u4ee4\u7684\u4f7f\u7528</li> </ul> <pre><code>set -- `getopt -q -l append:port: a:p: --append test -p /dev/ttyUSB0\nwhile [ -n \"$1\" ]\ndo\ncase \"$1\" in\n-a | --append)\nappend = $2\nshift ;;\n-p | --port)\nport = $2\nshift ;;\n--)\nshift\nbreak;;\nesac\nshift\ndone\n</code></pre> <ul> <li>USB\u5171\u4eab\u7f51\u7edcRNDIS</li> </ul> <pre><code># host\n$ modprobe rndis_hos\n# board\n$ modprobe g_ether.ko\n# on host\n$ ifconfig usb0 192.168.2.1\n# on board\n$ ifconfig usb0 192.168.2.100\n# enable forwarding on host\n$ echo 1 &gt; /proc/sys/net/ipv4/ip_forward\n$ iptables -P FORWARD ACCEPT\n$ iptables -A POSTROUTING -t nat -j MASQUERADE -s 192.168.2.0/24\n</code></pre> <ul> <li>input\u8bbe\u5907\u6d4b\u8bd5\u5de5\u5177</li> </ul> <p><code>evtest</code>\u547d\u4ee4\u7528\u4e8e\u6d4b\u8bd5input\u8bbe\u5907\u7684\u8f93\u5165</p> <ul> <li>PRIME Render Offload</li> </ul> <p>\u53cc\u663e\u5361\u7b14\u8bb0\u672c\u5b89\u88c5Nvidia\u95ed\u6e90\u9a71\u52a8\u540e\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u73af\u5883\u53d8\u91cf\u542f\u7528\u72ec\u663e\u52a0\u901f\uff1f \u505a\u6cd5\u5c31\u662f\u5728\u6267\u884c\u7a0b\u5e8f\u65f6\u6dfb\u52a0\u5982\u4e0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u6216\u8005\u76f4\u63a5\u4fee\u6539<code>/usr/share/applications</code>\u76ee\u5f55\u4e0b\u5404\u7a0b\u5e8f\u63cf\u8ff0\u6587\u4ef6\u4e2d\u7684<code>Exec</code>\u5b57\u6bb5\uff0c\u5c06\u5982\u4e0b\u7684\u73af\u5883\u53d8\u91cf\u6dfb\u52a0\u5230\u547d\u4ee4\u4e2d\u3002</p> <pre><code>__NV_PRIME_RENDER_OFFLOAD=1 __GLX_VENDOR_LIBRARY_NAME=nvidia\n</code></pre> <ul> <li>\u6302\u8f7dimg\u6587\u4ef6\u7684\u65b9\u6cd5</li> </ul> <pre><code>$ # \u65b9\u6cd51\n$ mount -t iso9660 -o loop xxx.img /media/imgfile\n$ # \u65b9\u6cd52\n$ mount -o loop,offset=$((offset*sector_size)) xxx.img /media/imgfile\n</code></pre>"},{"location":"tools/make/","title":"Make","text":""},{"location":"tools/make/#_1","title":"\u904d\u5386\u6587\u4ef6","text":"<pre><code>dirs := $(shell find . -maxdepth 3 -type d)\nfiles := $(foreach dir,$(dirs),$(wildcard $(dir)/*.c))\nobjs := $(patsubst %.c,%.o, $(FILES))\n</code></pre>"},{"location":"tools/make/#_2","title":"\u53d8\u91cf\u7684\u66ff\u6362\u5f15\u7528","text":"<pre><code># $(VAR:A=B)\n# example\n# \u6548\u679c\u548cpatsust\u662f\u4e00\u6837\u7684\nfoo := a.o b.o c.o\nbar := $(foo:%.o=%.c)\n</code></pre>"},{"location":"tools/make/#_3","title":"\u5c06\u4e2d\u95f4\u6587\u4ef6\u8f93\u51fa\u5230\u6307\u5b9a\u7684\u76ee\u5f55","text":"<p>\u5c06\u4e2d\u95f4\u6587\u4ef6\u8f93\u51fa\u5230\u6307\u5b9a\u7684\u76ee\u5f55\u9700\u8981\u5c06\u6784\u5efa\u89c4\u5219\u4e00\u5e76\u8fdb\u884c\u4fee\u6539\uff0c\u5982\u4e0b\u793a\u4f8b\u53ef\u4ee5\u5c06\u4e2d\u95f4\u6587\u4ef6\u8f93\u51fa\u5230<code>OUTPUT</code>\u6307\u5b9a\u7684\u76ee\u5f55\u4e2d\u53bb</p> <pre><code>OUTPUT := build\n\n# \u9700\u8981\u6539\u5199\u8fd9\u91cc\u7684\u5339\u914d\u89c4\u5219\u5e76\u589e\u52a0\u4e0b\u9762\u521b\u5efa\u5bf9\u5e94\u76ee\u5f55\u7684\u64cd\u4f5c\n$(OUTPUT)/%.o: %.c\n@echo \"  CC  $&lt;\"\n@if [ ! -d $(dir $@) ]; then mkdir -p $(dir $@); fi\n@$(CC) -c -o $@ $&lt; $(CFLAGS)\n</code></pre>"},{"location":"tools/make/#_4","title":"\u5934\u6587\u4ef6\u6539\u52a8\u540e\u4e0d\u4f1a\u91cd\u65b0\u7f16\u8bd1\u7684\u89e3\u51b3\u529e\u6cd5","text":"<p>gcc\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53eb\u505a<code>-M</code>\u7684\u9009\u9879\u7528\u6765\u751f\u6210make\u683c\u5f0f\u7684\u6e90\u7801\u4f9d\u8d56\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7f16\u8bd1\u9009\u9879\u4e2d\u589e\u52a0<code>-MMD</code>,<code>-MP</code>\u4e24\u4e2a\u53c2\u6570\u6765\u81ea\u52a8\u751f\u6210\u548c\u6e90\u6587\u4ef6\u540d\u79f0\u76f8\u540c\u5e76\u4e14\u540e\u7f00\u4e3a<code>.d</code>\u7684\u4f9d\u8d56\u6587\u4ef6\u5e76\u5728\u9876\u5c42Makefile\u4e2d\u4f7f\u7528<code>-include $(deps)</code>\u6765\u5305\u542b\u8fd9\u4e9b\u89c4\u5219\uff0c\u8fd9\u6837\u5f53<code>.h</code>\u6587\u4ef6\u4fee\u6539\u540e\u4fbf\u4f1a\u81ea\u52a8\u7f16\u8bd1\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u7684\u6587\u4ef6\u4e86\uff0c\u4f7f\u7528\u793a\u4f8b\u5982\u4e0b:</p> <pre><code>CFLAGS += -MMD -MP\n\nobjs := $(patsubst %.c,$(OUTPUT)/%.o,$(srcs))\ndeps := $(objs:%.o=%.d)\n\n-include $(deps)\n$(OUTPUT)/%.o: %.c\n@echo \"  CC  $&lt;\"\n@if [ ! -d $(dir $@) ]; then mkdir -p $(dir $@); fi\n@$(CC) -c -o $@ $&lt; $(CFLAGS)\n</code></pre>"},{"location":"tools/make/#_5","title":"\u7b80\u5355\u7684\u6a21\u677f","text":"<pre><code># Makefile\nCROSS :=\n\nCC = $(CROSS)gcc\nSTRIP = $(CROSS)strip\n\nobjs := a.o\nobjs += lib/b.o\n\nc-flags := -ffunction-sections -fdata-sections\nld-flags := -Wl,-gc-sections\n\ntarget: $(objs)\n@CC $(ld-flags) -o $@ $^\n    @STRIP $@\n\n$(objs): %.o: %.c\n@CC $(c-flags) -c -o $@ $^\n\n.PHONY: clean\n\nclean:\n@find -name '*.o' | xargs rm -f\n</code></pre>"},{"location":"tools/pulseview/","title":"PulseView","text":"<p>\u903b\u8f91\u5206\u6790\u4eea\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u517c\u5bb9\u6dd8\u5b9d\u4e0a\u552e\u5356\u7684\u5404\u7c7b\u4f4e\u7aef\u903b\u8f91\u5206\u6790\u4eea\u3002</p> <p>\u5728Linux\u4e2d\u4f7f\u7528\u5305\u7ba1\u7406\u5de5\u5177\u5b89\u88c5Pulseview\u540e\u4f1a\u62a5\u627e\u4e0d\u5230\u8bbe\u5907\u7684\u9519\u8bef\uff0c\u7ecf\u8fc7\u591a\u6b21\u5b9e\u9a8c\uff0c\u53d1\u73b0\u53ea\u8981\u5b89\u88c5sigrok\u4fbf\u53ef\u4ee5\u81ea\u52a8\u5b89\u88c5PulseView\u5e76\u4e14\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u4e86\u3002</p>"},{"location":"tools/tmux/","title":"tmux","text":""},{"location":"tools/tmux/#session","title":"session\u64cd\u4f5c","text":""},{"location":"tools/tmux/#session_1","title":"\u65b0\u5efasession","text":"<pre><code>tmux new -s &lt;session-name&gt; </code></pre>"},{"location":"tools/tmux/#session_2","title":"\u79bb\u5f00session","text":"<pre><code># ctrl + b d\ntmux detach\n</code></pre>"},{"location":"tools/tmux/#session_3","title":"\u8fdb\u5165session","text":"<pre><code>tmux attach -t &lt;session-name&gt;\n</code></pre>"},{"location":"tools/tmux/#session_4","title":"\u5173\u95edsession","text":"<pre><code>tmux kill-session -t &lt;session-name&gt;\n</code></pre>"},{"location":"tools/tmux/#session_5","title":"\u5207\u6362session","text":"<pre><code>tmux switch -t &lt;session-name&gt;\n</code></pre>"},{"location":"tools/tmux/#_1","title":"\u7a97\u683c\u64cd\u4f5c","text":"<p>\u5207\u5272\u7a97\u683c\u7684\u5feb\u6377\u952e ctrl+b % \u53ef\u4ee5\u5feb\u901f\u7684\u5de6\u53f3\u5207\u5272\uff0cctrl+b \" \u53ef\u4ee5\u5feb\u901f\u7684\u4e0a\u4e0b\u8fdb\u884c\u5207\u5272\u3002</p> <p>\u5feb\u6377\u952e ctrl+b z ,\u5c06\u4f1a\u653e\u5927\u5f53\u524d\u64cd\u4f5c\u7684\u7a97\u683c\uff0c\u7ee7\u7eed\u89e6\u53d1\u8be5\u5feb\u6377\u952e\u5c06\u4f1a\u8fd8\u539f\u5f53\u524d\u7684\u7a97\u683c\u3002</p> <p>\u5feb\u6377\u952e ctrl+b t \u5c06\u4f1a\u628a\u5728\u5f53\u524d\u7684\u7a97\u683c\u5f53\u4e2d\u663e\u793a\u65f6\u949f\u3002</p> <p>\u5728vim\u6309\u952e\u6a21\u5f0f\u4e0b ctrl+b h/j/k/l \u7528\u6765\u5728\u4e0d\u540c\u7684\u7a97\u683c\u4e4b\u95f4\u5207\u6362\u3002</p> <p>ctrl+b [ \u5728\u5f53\u524d\u7a97\u683c\u4e2d\u8fdb\u884c\u6eda\u5c4f\u64cd\u4f5c</p> <p>\u70b9\u51fbshift\u5e76\u4f7f\u7528\u9f20\u6807\u64cd\u4f5c\u53ef\u6062\u590d\u7ec8\u7aef\u9ed8\u8ba4\u9f20\u6807\u529f\u80fd\uff0c\u590d\u5236\u7c98\u8d34\u4f1a\u65b9\u4fbf\u4e00\u4e9b\u3002</p> <p>ctrl+b q \u663e\u793a\u7a97\u683c\u7f16\u53f7\u3002</p> <p>ctrl+b alt+\u65b9\u5411\u952e\u8c03\u6574\u7a97\u683c\u957f\u5bbd\u3002</p>"},{"location":"tools/tmux/#_2","title":"\u7a97\u53e3\u64cd\u4f5c","text":"<p>\u521b\u5efa\u7a97\u53e3\u7684\u5feb\u6377\u952ectrl+b c, \u53ef\u4ee5\u901a\u8fc7\u5feb\u6377\u952e\u5feb\u901f\u7684\u521b\u5efa\u4e00\u4e2a\u7a97\u53e3\u51fa\u6765\u3002</p> <p>ctrl+b n \u5feb\u901f\u5207\u6362\u5230\u4e0b\u4e00\u4e2a\u7a97\u53e3\uff1bctrl+b p \u5feb\u901f\u5207\u6362\u5230\u4e0a\u4e00\u4e2a\u7a97\u53e3\u3002</p> <p>ctrl+b num \u5feb\u901f\u5207\u6362\u5230\u6307\u5b9a\u5e8f\u53f7\u7a97\u53e3\u3002</p> <p>ctrl+b , \u8be5\u5feb\u6377\u952e\u53ef\u4ee5\u91cd\u65b0\u547d\u540d\u7a97\u53e3</p>"},{"location":"tools/tmux/#_3","title":"\u914d\u7f6e\u6587\u4ef6","text":"<p>\u914d\u7f6e\u6587\u4ef6\u4e3a~/.tmux.conf\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u6613\u7684\u914d\u7f6e\u6587\u4ef6\u5b9e\u4f8b\uff1a</p> <pre><code># \u57fa\u7840\u8bbe\u7f6e\nset -g default-command \"/bin/bash\"\nset -g default-terminal \"screen-256color\"\nset -g display-time 3000\nset -g escape-time 0\nset -g history-limit 65535\nset -g base-index 1\nset -g pane-base-index 1\nset -g status-style bg=blue\n\n# \u9009\u4e2d\u7a97\u53e3\nbind-key k select-pane -U\nbind-key j select-pane -D\nbind-key h select-pane -L\nbind-key l select-pane -R\n\n# copy-mode \u5c06\u5feb\u6377\u952e\u8bbe\u7f6e\u4e3a vi \u6a21\u5f0f\nsetw -g mode-keys vi\n\n# \u542f\u7528\u9f20\u6807(Tmux v2.1)\nset -g mouse on\n</code></pre>"},{"location":"tools/editor/eclipse/","title":"eclipse","text":""},{"location":"tools/editor/eclipse/#launch-bar","title":"\u5173\u95edlaunch bar","text":"<p>\u65b0\u7248\u672c\u7684eclipse\u7684\u83dc\u5355\u680f\u4f1a\u6709\u4e00\u4e2a\u5f88\u5360\u7a7a\u95f4\u7684launch bar\uff0c\u5173\u95ed\u7684\u8def\u5f84\u5982\u4e0b\u3002</p> <pre><code>Window-&gt;Preferences-&gt;Run/Debug-&gt;Launching-&gt;Launch Bar\n</code></pre>"},{"location":"tools/editor/vim/","title":"vim","text":""},{"location":"tools/editor/vim/#_1","title":"\u5e38\u7528\u914d\u7f6e","text":"<p>\u914d\u7f6e\u6587\u4ef6\u4e3a<code>~/.vimrc</code>\uff0c\u4ee5\u4e0b\u662f\u4e00\u4efd\u7b80\u5355\u7684\u914d\u7f6e\u6587\u4ef6\u793a\u4f8b\uff1a</p> <pre><code>set nocompatible\nset nu!\nfiletype on\nset autoindent\nset cindent\nset smartindent\nset tags=./.tags;,.tags\nset ai!\nset showmatch\nset ruler\nset hlsearch\nset list\nset cul\nset tabstop=4\nset shiftwidth=4\nset backspace=indent,eol,start\nset ww=h,l\n\n\" set cc=81\nset cc=0\n\n\" set listchars=tab:\u2192\\ ,trail:\u00b7,space:\u00b7\nset listchars=tab:\u2192\\ ,trail:\u00b7\n\nlet mapleader = \",\"\nlet g:mapleader = \",\"\n\nsyntax enable\n\n\" plug\ncall plug#begin('~/.vim/plugged')\nPlug 'morhetz/gruvbox'\nPlug 'vim-airline/vim-airline'\nPlug 'scrooloose/nerdtree', { 'on': 'NERDTreeToggle' }\nPlug 'neoclide/coc.nvim', {'branch': 'release'}\ncall plug#end()\n\n\" colorscheme\nset background=dark\nlet g:gruvbox_contrast_dark='hard'\ncolorscheme gruvbox\nset laststatus=2\nlet g:airline_extensions = []\n\nnmap &lt;leader&gt;w :w!&lt;CR&gt;\nnmap &lt;leader&gt;l :set list!&lt;CR&gt;\nnmap &lt;leader&gt;d :NERDTreeToggle&lt;CR&gt;\nnmap &lt;leader&gt;s :set tabstop=4&lt;CR&gt;:set shiftwidth=4&lt;CR&gt;:set expandtab&lt;CR&gt;\nnmap &lt;leader&gt;S :set tabstop=8&lt;CR&gt;:set shiftwidth=8&lt;CR&gt;:set expandtab&lt;CR&gt;\nnmap &lt;leader&gt;t :set tabstop=4&lt;CR&gt;:set shiftwidth=4&lt;CR&gt;:set noexpandtab&lt;CR&gt;\nnmap &lt;leader&gt;T :set tabstop=8&lt;CR&gt;:set shiftwidth=8&lt;CR&gt;:set noexpandtab&lt;CR&gt;\nnmap &lt;leader&gt;c :CocStart&lt;CR&gt;\n\nnmap &lt;C-]&gt; g&lt;c-]&gt;\n\nautocmd bufenter * if (winnr(\"$\") == 1 &amp;&amp; exists(\"b:NERDTree\") &amp;&amp; b:NERDTree.isTabTree()) | q | endif\n\n\" stop CoC by default (but Coc is enabled)\nlet g:coc_start_at_startup=0\n\n\" Append other coc-nvim configs\n</code></pre>"},{"location":"tools/editor/vim/#lsp","title":"LSP\u914d\u7f6e","text":"<p>\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u4f7f\u7528\uff0ccoc-nvim\u7684\u4f7f\u7528\u4f53\u9a8c\u8fd8\u662f\u4e0d\u9519\u7684\uff0c\u914d\u5408clangd\uff0c\u5373\u4f7f\u5728\u5d4c\u5165\u5f0f\u5f00\u53d1\u4e2d\u4e5f\u53ef\u4ee5\u5f97\u5230\u5341\u5206\u8212\u670d\u7684\u81ea\u52a8\u8865\u5168\u4f53\u9a8c\u3002</p> <p>clangd\u3001coc-nvim\u4ee5\u53cacoc-clangd\u7684\u5b89\u88c5\u53ef\u4ee5\u67e5\u770b\u5b98\u65b9\u7f51\u7ad9\u7684\u63cf\u8ff0\uff0c\u6587\u6863\u5341\u5206\u8be6\u7ec6\uff0c\u57fa\u672c\u65e0\u8111\u6309\u7167\u6d41\u7a0b\u6765\u4fbf\u53ef\u4ee5\u4e86\u3002</p> <p>\u4f7f\u7528<code>:CocLocalConfig</code>\u53ef\u4ee5\u5728\u5de5\u7a0b\u76ee\u5f55\u6253\u5f00\u76f8\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u8fd9\u91cc\u5728\u914d\u7f6eclangd\u6307\u5b9a\u5de5\u5177\u94fe\u65f6\u8e29\u5230\u4e86\u4e00\u4e2a\u5751\uff0c\u4e00\u5f00\u59cb\u76f4\u63a5\u4f7f\u7528<code>--query-driver=/path/to/toolchain</code>\u8fd9\u6837\u7684\u53c2\u6570\u65f6\u59cb\u7ec8\u65e0\u6cd5\u8ba9clangd\u6b63\u5e38\u5de5\u4f5c\uff0c\u76f4\u5230\u5c06coc-clangd\u7684\u53c2\u6570\u6309\u7167\u5982\u4e0b\u5f62\u5f0f\u8fdb\u884c\u914d\u7f6e\u624d\u5f00\u59cb\u6b63\u5e38\u5de5\u4f5c\u3002</p> <pre><code>{\n\"clangd.disableDiagnostics\": true,\n\"inlayHint.enable\": false,\n\"clangd.arguments\": [\n\"--query-driver\",\n\"/path/to/toolchain/bin/xxx-gcc\",\n\"--compile-commands-dir\",\n\"build\",\n\"--header-insertion\",\n\"never\"\n]\n}\n</code></pre> <p>\u51fd\u6570\u81ea\u52a8\u8865\u5168\u65f6\u4f7f\u7528<code>CTRL+J</code>\u548c<code>CTRL+K</code>\u53ef\u4ee5\u5728\u51fd\u6570\u53c2\u6570\u95f4\u8fdb\u884c\u5207\u6362\uff1b<code>space+s</code>\u53ef\u4ee5\u5168\u5c40\u641c\u7d22\u7b26\u53f7\u3002</p>"},{"location":"tools/editor/vscode/","title":"vscode","text":""},{"location":"tools/editor/vscode/#_1","title":"\u5b57\u4f53","text":"<p>monospace\uff0c\u7b49\u5bbd\u5b57\u4f53</p>"},{"location":"tools/editor/vscode/#tab","title":"\u663e\u793aTAB","text":"<p>renderControlCharacters\u3002</p>"},{"location":"tools/editor/vscode/#_2","title":"\u663e\u793a\u7a7a\u683c","text":"<p>renderWhitespace\uff0c\u9009\u62e9all\u3002</p>"},{"location":"tools/editor/vscode/#ruler","title":"ruler","text":"<p>\"editor.rulers\": [80,120] \u5c31\u53ef\u4ee5\u4e86 \u60f3\u753b\u51e0\u6761\u7ebf\u90fd\u53ef\u4ee5\u3002</p>"},{"location":"tools/editor/vscode/#_3","title":"\u6269\u5c55","text":"<p>\u9605\u8bfb\u5185\u6838\u4ee3\u7801\u53ef\u4ee5\u4f7f\u7528GNU Global\u6269\u5c55\u3002</p>"},{"location":"tools/network/wireless/wpa_supplicant/","title":"wpa_supplicant","text":"<p>wpa_supplicant\u662f\u8de8\u5e73\u53f0\u7684\u65e0\u7ebf\u8bbf\u95ee\u5ba2\u6237\u7aef\uff0c\u53ef\u7528\u4e8ePC\u3001\u7b14\u8bb0\u672c\u4ee5\u53ca\u5d4c\u5165\u5f0f\u7b49\u4e0d\u540c\u573a\u5408\uff0c\u8be6\u7ec6\u6587\u6863\u53ef\u67e5\u770bman\u624b\u518c\u3002</p>"},{"location":"tools/network/wireless/wpa_supplicant/#wifi","title":"\u8fde\u63a5wifi","text":"<p>\u5728\u5d4c\u5165\u5f0f\u7cfb\u7edf\u4e2d\u53ef\u6309\u7167\u5982\u4e0b\u987a\u5e8f\u4f7f\u7528wpa_supplicant\u5de5\u5177\u6765\u8fde\u63a5wifi\u3002</p> <ul> <li>\u4f7f\u80fd<code>wlan0</code>\u63a5\u53e3</li> </ul> <pre><code>ifconfig wlan0 up\n</code></pre> <ul> <li>\u70ed\u70b9\u626b\u63cf\uff08\u53ef\u9009\uff09</li> </ul> <pre><code>iw dev wlan0 scan\n</code></pre> <ul> <li>\u4f7f\u7528<code>wpa_passphrase</code>\u751f\u6210\u914d\u7f6e\u6587\u4ef6</li> </ul> <pre><code>wpa_passphrase SSID Passwd &gt; /etc/wpa_supplicant.conf\n</code></pre> <ul> <li>\u5e94\u7528\u914d\u7f6e</li> </ul> <pre><code>wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant.conf\n</code></pre> <ul> <li>\u83b7\u53d6IP</li> </ul> <pre><code>udhcpc -i wlan0\n</code></pre>"},{"location":"tools/network/wireless/wpa_supplicant/#_1","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://whycan.com/t_5292.html</p>"}]}